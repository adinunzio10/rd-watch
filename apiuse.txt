/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/main.py:                or os.environ.get("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/main.py:                or os.environ.get("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/llms/anthropic/common_utils.py:                message="Missing Anthropic API Key - A call is being made to anthropic but no key is set either in the environment variables or via params. Please set `ANTHROPIC_API_KEY` in your environment vars",
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/llms/anthropic/common_utils.py:        return api_key or get_secret_str("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/llms/anthropic/common_utils.py:                "ANTHROPIC_API_BASE or ANTHROPIC_API_KEY is not set. Please set the environment variable, to query Anthropic's `/models` endpoint."
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/utils.py:        api_key = api_key or litellm.anthropic_key or get_secret("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/utils.py:            if "ANTHROPIC_API_KEY" in os.environ:
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/utils.py:                missing_keys.append("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/utils.py:            if "ANTHROPIC_API_KEY" in os.environ:
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/utils.py:                missing_keys.append("ANTHROPIC_API_KEY")
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/proxy_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/_new_secret_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/_experimental/out/_next/static/chunks/539-fadc69b2ec7728b1.js:Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let n=this._client._options.timeout;if(!e.stream&&null==n){let t=tj[e.model]??void 0;n=this._client.calculateNonstreamingTimeout(e.max_tokens,t)}return this._client.post("/v1/messages",{body:e,timeout:n??6e5,...t,stream:e.stream??!1})}stream(e,t){return tT.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}let tZ={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};tD.Batches=tA;class tL extends ts{retrieve(e,t={},n){let{betas:r}=t??{};return this._client.get(th`/v1/models/${e}`,{...n,headers:tf([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},n?.headers])})}list(e={},t){let{betas:n,...r}=e??{};return this._client.getAPIList("/v1/models",e2,{query:r,...t,headers:tf([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},t?.headers])})}}let tz=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class tB{constructor({baseURL:e=tz("ANTHROPIC_BASE_URL"),apiKey:t=tz("ANTHROPIC_API_KEY")??null,authToken:n=tz("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){Y.set(this,void 0);let o={apiKey:t,authToken:n,...r,baseURL:e||"https://api.anthropic.com"};if(!o.dangerouslyAllowBrowser&&eT())throw new ea("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n");this.baseURL=o.baseURL,this.timeout=o.timeout??tF.DEFAULT_TIMEOUT,this.logger=o.logger??console;let i="warn";this.logLevel=i,this.logLevel=eO(o.logLevel,"ClientOptions.logLevel",this)??eO(tz("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??i,this.fetchOptions=o.fetchOptions,this.maxRetries=o.maxRetries??2,this.fetch=o.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),et(this,Y,eq,"f"),this._options=o,this.apiKey=t,this.authToken=n}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(this.apiKey&&e.get("x-api-key")||t.has("x-api-key")||this.authToken&&e.get("authorization")||t.has("authorization")))throw Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){return tf([this.apiKeyAuth(e),this.bearerAuth(e)])}apiKeyAuth(e){if(null!=this.apiKey)return tf([{"X-Api-Key":this.apiKey}])}bearerAuth(e){if(null!=this.authToken)return tf([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new ea(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${eR}`}defaultIdempotencyKey(){return`stainless-node-retry-${er()}`}makeStatusError(e,t,n,r){return el.generate(e,t,n,r)}buildURL(e,t){let n=new URL(ex(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(r)&&(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new ea("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 6e5}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>({method:e,path:t,...n})))}request(e,t=null){return new eJ(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){let r=await e,o=r.maxRetries??this.maxRetries;null==t&&(t=o),await this.prepareOptions(r);let{req:i,url:a,timeout:l}=this.buildRequest(r,{retryCount:o-t});await this.prepareRequest(i,{url:a,options:r});let c="log_"+(16777216*Math.random()|0).toString(16).padStart(6,"0"),s=void 0===n?"":`, retryOf: ${n}`,u=Date.now();if(eN(this).debug(`[${c}] sending request`,eM({retryOfRequestLogID:n,method:r.method,url:a,options:r,headers:i.headers})),r.signal?.aborted)throw new ec;let d=new AbortController,f=await this.fetchWithTimeout(a,i,l,d).catch(ei),p=Date.now();if(f instanceof Error){let e=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new ec;let o=eo(f)||/timed? ?out/i.test(String(f)+("cause"in f?String(f.cause):""));if(t)return eN(this).info(`[${c}] connection ${o?"timed out":"failed"} - ${e}`),eN(this).debug(`[${c}] connection ${o?"timed out":"failed"} (${e})`,eM({retryOfRequestLogID:n,url:a,durationMs:p-u,message:f.message})),this.retryRequest(r,t,n??c);if(eN(this).info(`[${c}] connection ${o?"timed out":"failed"} - error; no more retries left`),eN(this).debug(`[${c}] connection ${o?"timed out":"failed"} (error; no more retries left)`,eM({retryOfRequestLogID:n,url:a,durationMs:p-u,message:f.message})),o)throw new eu;throw new es({cause:f})}let h=[...f.headers.entries()].filter(([e])=>"request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),m=`[${c}${s}${h}] ${i.method} ${a} ${f.ok?"succeeded":"failed"} with status ${f.status} in ${p-u}ms`;if(!f.ok){let e=this.shouldRetry(f);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await eH(f.body),eN(this).info(`${m} - ${e}`),eN(this).debug(`[${c}] response error (${e})`,eM({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,durationMs:p-u})),this.retryRequest(r,t,n??c,f.headers)}let o=e?"error; no more retries left":"error; not retryable";eN(this).info(`${m} - ${o}`);let i=await f.text().catch(e=>ei(e).message),a=ek(i),l=a?void 0:i;throw eN(this).debug(`[${c}] response error (${o})`,eM({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,message:l,durationMs:Date.now()-u})),this.makeStatusError(f.status,a,l,f.headers)}return eN(this).info(m),eN(this).debug(`[${c}] response start`,eM({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,durationMs:p-u})),{response:f,options:r,controller:d,requestLogID:c,retryOfRequestLogID:n,startTime:u}}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}requestAPIList(e,t){return new e1(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,n,r){let{signal:o,method:i,...a}=t||{};o&&o.addEventListener("abort",()=>r.abort());let l=setTimeout(()=>r.abort(),n),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"==typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,s={signal:r.signal,...c?{duplex:"half"}:{},method:"GET",...a};i&&(s.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,s)}finally{clearTimeout(l)}}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,n,r){let o;let i=r?.get("retry-after-ms");if(i){let e=parseFloat(i);Number.isNaN(e)||(o=e)}let a=r?.get("retry-after");if(a&&!o){let e=parseFloat(a);o=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(o&&0<=o&&o<6e4)){let n=e.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(t,n)}return await eE(o),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}calculateNonstreamingTimeout(e,t){if(36e5*e/128e3>6e5||null!=t&&e>t)throw new ea("Streaming is strongly recommended for operations that may token longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}buildRequest(e,{retryCount:t=0}={}){let n={...e},{method:r,path:o,query:i}=n,a=this.buildURL(o,i);"timeout"in n&&eS("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let{bodyHeaders:l,body:c}=this.buildBody({options:n}),s=this.buildHeaders({options:e,method:r,bodyHeaders:l,retryCount:t});return{req:{method:r,headers:s,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"},...c&&{body:c},...this.fetchOptions??{},...n.fetchOptions??{}},url:a,timeout:n.timeout}}buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:r}){let o={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);let i=tf([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...eL(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let n=tf([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&n.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:eB(e)}:en(this,Y,"f").call(this,{body:e,headers:n})}}Y=new WeakMap,tB.Anthropic=tB,tB.HUMAN_PROMPT="\n\nHuman:",tB.AI_PROMPT="\n\nAssistant:",tB.DEFAULT_TIMEOUT=6e5,tB.AnthropicError=ea,tB.APIError=el,tB.APIConnectionError=es,tB.APIConnectionTimeoutError=eu,tB.APIUserAbortError=ec,tB.NotFoundError=eh,tB.ConflictError=em,tB.RateLimitError=ev,tB.BadRequestError=ed,tB.AuthenticationError=ef,tB.InternalServerError=eb,tB.PermissionDeniedError=ep,tB.UnprocessableEntityError=eg,tB.toFile=tl;class tF extends tB{constructor(){super(...arguments),this.completions=new tN(this),this.messages=new tD(this),this.models=new tL(this),this.beta=new tI(this)}}tF.Completions=tN,tF.Messages=tD,tF.Models=tL,tF.Beta=tI;let{HUMAN_PROMPT:tH,AI_PROMPT:tq}=tF},21886:function(e,t,n){"use strict";let r,o;n.d(t,{p:function(){return P}});var i,a=n(2265),l=n(13323),c=n(17684),s=n(80004),u=n(93689),d=n(37863),f=n(47634),p=n(24536),h=n(40293),m=n(27847);let g=null!=(i=a.startTransition)?i:function(e){e()};var v=n(37388),b=((r=b||{})[r.Open=0]="Open",r[r.Closed=1]="Closed",r),y=((o=y||{})[o.ToggleDisclosure=0]="ToggleDisclosure",o[o.CloseDisclosure=1]="CloseDisclosure",o[o.SetButtonId=2]="SetButtonId",o[o.SetPanelId=3]="SetPanelId",o[o.LinkPanel=4]="LinkPanel",o[o.UnlinkPanel=5]="UnlinkPanel",o);let x={0:e=>({...e,disclosureState:(0,p.E)(e.disclosureState,{0:1,1:0})}),1:e=>1===e.disclosureState?e:{...e,disclosureState:1},4:e=>!0===e.linkedPanel?e:{...e,linkedPanel:!0},5:e=>!1===e.linkedPanel?e:{...e,linkedPanel:!1},2:(e,t)=>e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId},3:(e,t)=>e.panelId===t.panelId?e:{...e,panelId:t.panelId}},w=(0,a.createContext)(null);function S(e){let t=(0,a.useContext)(w);if(null===t){let t=Error("<".concat(e," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,S),t}return t}w.displayName="DisclosureContext";let k=(0,a.createContext)(null);k.displayName="DisclosureAPIContext";let E=(0,a.createContext)(null);function C(e,t){return(0,p.E)(t.type,x,e,t)}E.displayName="DisclosurePanelContext";let O=a.Fragment,j=m.AN.RenderStrategy|m.AN.Static,P=Object.assign((0,m.yV)(function(e,t){let{defaultOpen:n=!1,...r}=e,o=(0,a.useRef)(null),i=(0,u.T)(t,(0,u.h)(e=>{o.current=e},void 0===e.as||e.as===a.Fragment)),c=(0,a.useRef)(null),s=(0,a.useRef)(null),f=(0,a.useReducer)(C,{disclosureState:n?0:1,linkedPanel:!1,buttonRef:s,panelRef:c,buttonId:null,panelId:null}),[{disclosureState:g,buttonId:v},b]=f,y=(0,l.z)(e=>{b({type:1});let t=(0,h.r)(o);if(!t||!v)return;let n=e?e instanceof HTMLElement?e:e.current instanceof HTMLElement?e.current:t.getElementById(v):t.getElementById(v);null==n||n.focus()}),x=(0,a.useMemo)(()=>({close:y}),[y]),S=(0,a.useMemo)(()=>({open:0===g,close:y}),[g,y]);return a.createElement(w.Provider,{value:f},a.createElement(k.Provider,{value:x},a.createElement(d.up,{value:(0,p.E)(g,{0:d.ZM.Open,1:d.ZM.Closed})},(0,m.sY)({ourProps:{ref:i},theirProps:r,slot:S,defaultTag:O,name:"Disclosure"}))))}),{Button:(0,m.yV)(function(e,t){let n=(0,c.M)(),{id:r="headlessui-disclosure-button-".concat(n),...o}=e,[i,d]=S("Disclosure.Button"),p=(0,a.useContext)(E),h=null!==p&&p===i.panelId,g=(0,a.useRef)(null),b=(0,u.T)(g,t,h?null:i.buttonRef),y=(0,m.Y2)();(0,a.useEffect)(()=>{if(!h)return d({type:2,buttonId:r}),()=>{d({type:2,buttonId:null})}},[r,d,h]);let x=(0,l.z)(e=>{var t;if(h){if(1===i.disclosureState)return;switch(e.key){case v.R.Space:case v.R.Enter:e.preventDefault(),e.stopPropagation(),d({type:0}),null==(t=i.buttonRef.current)||t.focus()}}else switch(e.key){case v.R.Space:case v.R.Enter:e.preventDefault(),e.stopPropagation(),d({type:0})}}),w=(0,l.z)(e=>{e.key===v.R.Space&&e.preventDefault()}),k=(0,l.z)(t=>{var n;(0,f.P)(t.currentTarget)||e.disabled||(h?(d({type:0}),null==(n=i.buttonRef.current)||n.focus()):d({type:0}))}),C=(0,a.useMemo)(()=>({open:0===i.disclosureState}),[i]),O=(0,s.f)(e,g),j=h?{ref:b,type:O,onKeyDown:x,onClick:k}:{ref:b,id:r,type:O,"aria-expanded":0===i.disclosureState,"aria-controls":i.linkedPanel?i.panelId:void 0,onKeyDown:x,onKeyUp:w,onClick:k};return(0,m.sY)({mergeRefs:y,ourProps:j,theirProps:o,slot:C,defaultTag:"button",name:"Disclosure.Button"})}),Panel:(0,m.yV)(function(e,t){let n=(0,c.M)(),{id:r="headlessui-disclosure-panel-".concat(n),...o}=e,[i,l]=S("Disclosure.Panel"),{close:s}=function e(t){let n=(0,a.useContext)(k);if(null===n){let n=Error("<".concat(t," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(n,e),n}return n}("Disclosure.Panel"),f=(0,m.Y2)(),p=(0,u.T)(t,i.panelRef,e=>{g(()=>l({type:e?4:5}))});(0,a.useEffect)(()=>(l({type:3,panelId:r}),()=>{l({type:3,panelId:null})}),[r,l]);let h=(0,d.oJ)(),v=null!==h?(h&d.ZM.Open)===d.ZM.Open:0===i.disclosureState,b=(0,a.useMemo)(()=>({open:0===i.disclosureState,close:s}),[i,s]);return a.createElement(E.Provider,{value:i.panelId},(0,m.sY)({mergeRefs:f,ourProps:{ref:p,id:r},theirProps:o,slot:b,defaultTag:"div",features:j,visible:v,name:"Disclosure.Panel"}))})})},28517:function(e,t,n){"use strict";let r,o,i,a,l;n.d(t,{R:function(){return K}});var c=n(2265),s=n(64518),u=n(31948);function d(e,t){let[n,r]=(0,c.useState)(e),o=(0,u.E)(e);return(0,s.e)(()=>r(o.current),[o,r,...t]),n}var f=n(62963),p=n(90945),h=n(13323),m=n(17684),g=n(98505),v=n(80004),b=n(93689);let y=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function x(e){var t,n;let r=null!=(t=e.innerText)?t:"",o=e.cloneNode(!0);if(!(o instanceof HTMLElement))return r;let i=!1;for(let e of o.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))e.remove(),i=!0;let a=i?null!=(n=o.innerText)?n:"":r;return y.test(a)&&(a=a.replace(y,"")),a}function w(e){return[e.screenX,e.screenY]}var S=n(38198),k=n(37863),E=n(47634),C=((r=C||{})[r.First=0]="First",r[r.Previous=1]="Previous",r[r.Next=2]="Next",r[r.Last=3]="Last",r[r.Specific=4]="Specific",r[r.Nothing=5]="Nothing",r),O=n(16015),j=n(37105),P=n(56314),_=n(24536),I=n(40293),N=n(27847),M=n(37388),R=((o=R||{})[o.Open=0]="Open",o[o.Closed=1]="Closed",o),T=((i=T||{})[i.Single=0]="Single",i[i.Multi=1]="Multi",i),A=((a=A||{})[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a),D=((l=D||{})[l.OpenListbox=0]="OpenListbox",l[l.CloseListbox=1]="CloseListbox",l[l.GoToOption=2]="GoToOption",l[l.Search=3]="Search",l[l.ClearSearch=4]="ClearSearch",l[l.RegisterOption=5]="RegisterOption",l[l.UnregisterOption=6]="UnregisterOption",l[l.RegisterLabel=7]="RegisterLabel",l);function Z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,n=null!==e.activeOptionIndex?e.options[e.activeOptionIndex]:null,r=(0,j.z2)(t(e.options.slice()),e=>e.dataRef.current.domRef.current),o=n?r.indexOf(n):null;return -1===o&&(o=null),{options:r,activeOptionIndex:o}}let L={1:e=>e.dataRef.current.disabled||1===e.listboxState?e:{...e,activeOptionIndex:null,listboxState:1},0(e){if(e.dataRef.current.disabled||0===e.listboxState)return e;let t=e.activeOptionIndex,{isSelected:n}=e.dataRef.current,r=e.options.findIndex(e=>n(e.dataRef.current.value));return -1!==r&&(t=r),{...e,listboxState:0,activeOptionIndex:t}},2(e,t){var n;if(e.dataRef.current.disabled||1===e.listboxState)return e;let r=Z(e),o=function(e,t){let n=t.resolveItems();if(n.length<=0)return null;let r=t.resolveActiveIndex(),o=null!=r?r:-1;switch(e.focus){case 0:for(let e=0;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return r;case 1:for(let e=o-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return r;case 2:for(let e=o+1;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return r;case 3:for(let e=n.length-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return r;case 4:for(let r=0;r<n.length;++r)if(t.resolveId(n[r],r,n)===e.id)return r;return r;case 5:return null;default:!function(e){throw Error("Unexpected object: "+e)}(e)}}(t,{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});return{...e,...r,searchQuery:"",activeOptionIndex:o,activationTrigger:null!=(n=t.trigger)?n:1}},3:(e,t)=>{if(e.dataRef.current.disabled||1===e.listboxState)return e;let n=""!==e.searchQuery?0:1,r=e.searchQuery+t.value.toLowerCase(),o=(null!==e.activeOptionIndex?e.options.slice(e.activeOptionIndex+n).concat(e.options.slice(0,e.activeOptionIndex+n)):e.options).find(e=>{var t;return!e.dataRef.current.disabled&&(null==(t=e.dataRef.current.textValue)?void 0:t.startsWith(r))}),i=o?e.options.indexOf(o):-1;return -1===i||i===e.activeOptionIndex?{...e,searchQuery:r}:{...e,searchQuery:r,activeOptionIndex:i,activationTrigger:1}},4:e=>e.dataRef.current.disabled||1===e.listboxState||""===e.searchQuery?e:{...e,searchQuery:""},5:(e,t)=>{let n={id:t.id,dataRef:t.dataRef},r=Z(e,e=>[...e,n]);return null===e.activeOptionIndex&&e.dataRef.current.isSelected(t.dataRef.current.value)&&(r.activeOptionIndex=r.options.indexOf(n)),{...e,...r}},6:(e,t)=>{let n=Z(e,e=>{let n=e.findIndex(e=>e.id===t.id);return -1!==n&&e.splice(n,1),e});return{...e,...n,activationTrigger:1}},7:(e,t)=>({...e,labelId:t.id})},z=(0,c.createContext)(null);function B(e){let t=(0,c.useContext)(z);if(null===t){let t=Error("<".concat(e," /> is missing a parent <Listbox /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,B),t}return t}z.displayName="ListboxActionsContext";let F=(0,c.createContext)(null);function H(e){let t=(0,c.useContext)(F);if(null===t){let t=Error("<".concat(e," /> is missing a parent <Listbox /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,H),t}return t}function q(e,t){return(0,_.E)(t.type,L,e,t)}F.displayName="ListboxDataContext";let W=c.Fragment,U=N.AN.RenderStrategy|N.AN.Static,K=Object.assign((0,N.yV)(function(e,t){let{value:n,defaultValue:r,form:o,name:i,onChange:a,by:l=(e,t)=>e===t,disabled:u=!1,horizontal:d=!1,multiple:m=!1,...v}=e,y=d?"horizontal":"vertical",x=(0,b.T)(t),[w=m?[]:void 0,E]=(0,f.q)(n,a,r),[O,I]=(0,c.useReducer)(q,{dataRef:(0,c.createRef)(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),M=(0,c.useRef)({static:!1,hold:!1}),R=(0,c.useRef)(null),T=(0,c.useRef)(null),A=(0,c.useRef)(null),D=(0,h.z)("string"==typeof l?(e,t)=>(null==e?void 0:e[l])===(null==t?void 0:t[l]):l),Z=(0,c.useCallback)(e=>(0,_.E)(L.mode,{1:()=>w.some(t=>D(t,e)),0:()=>D(w,e)}),[w]),L=(0,c.useMemo)(()=>({...O,value:w,disabled:u,mode:m?1:0,orientation:y,compare:D,isSelected:Z,optionsPropsRef:M,labelRef:R,buttonRef:T,optionsRef:A}),[w,u,m,O]);(0,s.e)(()=>{O.dataRef.current=L},[L]),(0,g.O)([L.buttonRef,L.optionsRef],(e,t)=>{var n;I({type:1}),(0,j.sP)(t,j.tJ.Loose)||(e.preventDefault(),null==(n=L.buttonRef.current)||n.focus())},0===L.listboxState);let B=(0,c.useMemo)(()=>({open:0===L.listboxState,disabled:u,value:w}),[L,u,w]),H=(0,h.z)(e=>{let t=L.options.find(t=>t.id===e);t&&Y(t.dataRef.current.value)}),U=(0,h.z)(()=>{if(null!==L.activeOptionIndex){let{dataRef:e,id:t}=L.options[L.activeOptionIndex];Y(e.current.value),I({type:2,focus:C.Specific,id:t})}}),K=(0,h.z)(()=>I({type:0})),V=(0,h.z)(()=>I({type:1})),$=(0,h.z)((e,t,n)=>e===C.Specific?I({type:2,focus:C.Specific,id:t,trigger:n}):I({type:2,focus:e,trigger:n})),X=(0,h.z)((e,t)=>(I({type:5,id:e,dataRef:t}),()=>I({type:6,id:e}))),G=(0,h.z)(e=>(I({type:7,id:e}),()=>I({type:7,id:null}))),Y=(0,h.z)(e=>(0,_.E)(L.mode,{0:()=>null==E?void 0:E(e),1(){let t=L.value.slice(),n=t.findIndex(t=>D(t,e));return -1===n?t.push(e):t.splice(n,1),null==E?void 0:E(t)}})),Q=(0,h.z)(e=>I({type:3,value:e})),J=(0,h.z)(()=>I({type:4})),ee=(0,c.useMemo)(()=>({onChange:Y,registerOption:X,registerLabel:G,goToOption:$,closeListbox:V,openListbox:K,selectActiveOption:U,selectOption:H,search:Q,clearSearch:J}),[]),et=(0,c.useRef)(null),en=(0,p.G)();return(0,c.useEffect)(()=>{et.current&&void 0!==r&&en.addEventListener(et.current,"reset",()=>{null==E||E(r)})},[et,E]),c.createElement(z.Provider,{value:ee},c.createElement(F.Provider,{value:L},c.createElement(k.up,{value:(0,_.E)(L.listboxState,{0:k.ZM.Open,1:k.ZM.Closed})},null!=i&&null!=w&&(0,P.t)({[i]:w}).map((e,t)=>{let[n,r]=e;return c.createElement(S._,{features:S.A.Hidden,ref:0===t?e=>{var t;et.current=null!=(t=null==e?void 0:e.closest("form"))?t:null}:void 0,...(0,N.oA)({key:n,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:o,name:n,value:r})})}),(0,N.sY)({ourProps:{ref:x},theirProps:v,slot:B,defaultTag:W,name:"Listbox"}))))}),{Button:(0,N.yV)(function(e,t){var n;let r=(0,m.M)(),{id:o="headlessui-listbox-button-".concat(r),...i}=e,a=H("Listbox.Button"),l=B("Listbox.Button"),s=(0,b.T)(a.buttonRef,t),u=(0,p.G)(),f=(0,h.z)(e=>{switch(e.key){case M.R.Space:case M.R.Enter:case M.R.ArrowDown:e.preventDefault(),l.openListbox(),u.nextFrame(()=>{a.value||l.goToOption(C.First)});break;case M.R.ArrowUp:e.preventDefault(),l.openListbox(),u.nextFrame(()=>{a.value||l.goToOption(C.Last)})}}),g=(0,h.z)(e=>{e.key===M.R.Space&&e.preventDefault()}),y=(0,h.z)(e=>{if((0,E.P)(e.currentTarget))return e.preventDefault();0===a.listboxState?(l.closeListbox(),u.nextFrame(()=>{var e;return null==(e=a.buttonRef.current)?void 0:e.focus({preventScroll:!0})})):(e.preventDefault(),l.openListbox())}),x=d(()=>{if(a.labelId)return[a.labelId,o].join(" ")},[a.labelId,o]),w=(0,c.useMemo)(()=>({open:0===a.listboxState,disabled:a.disabled,value:a.value}),[a]),S={ref:s,id:o,type:(0,v.f)(e,a.buttonRef),"aria-haspopup":"listbox","aria-controls":null==(n=a.optionsRef.current)?void 0:n.id,"aria-expanded":0===a.listboxState,"aria-labelledby":x,disabled:a.disabled,onKeyDown:f,onKeyUp:g,onClick:y};return(0,N.sY)({ourProps:S,theirProps:i,slot:w,defaultTag:"button",name:"Listbox.Button"})}),Label:(0,N.yV)(function(e,t){let n=(0,m.M)(),{id:r="headlessui-listbox-label-".concat(n),...o}=e,i=H("Listbox.Label"),a=B("Listbox.Label"),l=(0,b.T)(i.labelRef,t);(0,s.e)(()=>a.registerLabel(r),[r]);let u=(0,h.z)(()=>{var e;return null==(e=i.buttonRef.current)?void 0:e.focus({preventScroll:!0})}),d=(0,c.useMemo)(()=>({open:0===i.listboxState,disabled:i.disabled}),[i]);return(0,N.sY)({ourProps:{ref:l,id:r,onClick:u},theirProps:o,slot:d,defaultTag:"label",name:"Listbox.Label"})}),Options:(0,N.yV)(function(e,t){var n;let r=(0,m.M)(),{id:o="headlessui-listbox-options-".concat(r),...i}=e,a=H("Listbox.Options"),l=B("Listbox.Options"),s=(0,b.T)(a.optionsRef,t),u=(0,p.G)(),f=(0,p.G)(),g=(0,k.oJ)(),v=null!==g?(g&k.ZM.Open)===k.ZM.Open:0===a.listboxState;(0,c.useEffect)(()=>{var e;let t=a.optionsRef.current;t&&0===a.listboxState&&t!==(null==(e=(0,I.r)(t))?void 0:e.activeElement)&&t.focus({preventScroll:!0})},[a.listboxState,a.optionsRef]);let y=(0,h.z)(e=>{switch(f.dispose(),e.key){case M.R.Space:if(""!==a.searchQuery)return e.preventDefault(),e.stopPropagation(),l.search(e.key);case M.R.Enter:if(e.preventDefault(),e.stopPropagation(),null!==a.activeOptionIndex){let{dataRef:e}=a.options[a.activeOptionIndex];l.onChange(e.current.value)}0===a.mode&&(l.closeListbox(),(0,O.k)().nextFrame(()=>{var e;return null==(e=a.buttonRef.current)?void 0:e.focus({preventScroll:!0})}));break;case(0,_.E)(a.orientation,{vertical:M.R.ArrowDown,horizontal:M.R.ArrowRight}):return e.preventDefault(),e.stopPropagation(),l.goToOption(C.Next);case(0,_.E)(a.orientation,{vertical:M.R.ArrowUp,horizontal:M.R.ArrowLeft}):return e.preventDefault(),e.stopPropagation(),l.goToOption(C.Previous);case M.R.Home:case M.R.PageUp:return e.preventDefault(),e.stopPropagation(),l.goToOption(C.First);case M.R.End:case M.R.PageDown:return e.preventDefault(),e.stopPropagation(),l.goToOption(C.Last);case M.R.Escape:return e.preventDefault(),e.stopPropagation(),l.closeListbox(),u.nextFrame(()=>{var e;return null==(e=a.buttonRef.current)?void 0:e.focus({preventScroll:!0})});case M.R.Tab:e.preventDefault(),e.stopPropagation();break;default:1===e.key.length&&(l.search(e.key),f.setTimeout(()=>l.clearSearch(),350))}}),x=d(()=>{var e;return null==(e=a.buttonRef.current)?void 0:e.id},[a.buttonRef.current]),w=(0,c.useMemo)(()=>({open:0===a.listboxState}),[a]),S={"aria-activedescendant":null===a.activeOptionIndex||null==(n=a.options[a.activeOptionIndex])?void 0:n.id,"aria-multiselectable":1===a.mode||void 0,"aria-labelledby":x,"aria-orientation":a.orientation,id:o,onKeyDown:y,role:"listbox",tabIndex:0,ref:s};return(0,N.sY)({ourProps:S,theirProps:i,slot:w,defaultTag:"ul",features:U,visible:v,name:"Listbox.Options"})}),Option:(0,N.yV)(function(e,t){let n,r,o;let i=(0,m.M)(),{id:a="headlessui-listbox-option-".concat(i),disabled:l=!1,value:d,...f}=e,p=H("Listbox.Option"),g=B("Listbox.Option"),v=null!==p.activeOptionIndex&&p.options[p.activeOptionIndex].id===a,y=p.isSelected(d),S=(0,c.useRef)(null),k=(n=(0,c.useRef)(""),r=(0,c.useRef)(""),(0,h.z)(()=>{let e=S.current;if(!e)return"";let t=e.innerText;if(n.current===t)return r.current;let o=(function(e){let t=e.getAttribute("aria-label");if("string"==typeof t)return t.trim();let n=e.getAttribute("aria-labelledby");if(n){let e=n.split(" ").map(e=>{let t=document.getElementById(e);if(t){let e=t.getAttribute("aria-label");return"string"==typeof e?e.trim():x(t).trim()}return null}).filter(Boolean);if(e.length>0)return e.join(", ")}return x(e).trim()})(e).trim().toLowerCase();return n.current=t,r.current=o,o})),E=(0,u.E)({disabled:l,value:d,domRef:S,get textValue(){return k()}}),j=(0,b.T)(t,S);(0,s.e)(()=>{if(0!==p.listboxState||!v||0===p.activationTrigger)return;let e=(0,O.k)();return e.requestAnimationFrame(()=>{var e,t;null==(t=null==(e=S.current)?void 0:e.scrollIntoView)||t.call(e,{block:"nearest"})}),e.dispose},[S,v,p.listboxState,p.activationTrigger,p.activeOptionIndex]),(0,s.e)(()=>g.registerOption(a,E),[E,a]);let P=(0,h.z)(e=>{if(l)return e.preventDefault();g.onChange(d),0===p.mode&&(g.closeListbox(),(0,O.k)().nextFrame(()=>{var e;return null==(e=p.buttonRef.current)?void 0:e.focus({preventScroll:!0})}))}),_=(0,h.z)(()=>{if(l)return g.goToOption(C.Nothing);g.goToOption(C.Specific,a)}),I=(o=(0,c.useRef)([-1,-1]),{wasMoved(e){let t=w(e);return(o.current[0]!==t[0]||o.current[1]!==t[1])&&(o.current=t,!0)},update(e){o.current=w(e)}}),M=(0,h.z)(e=>I.update(e)),R=(0,h.z)(e=>{I.wasMoved(e)&&(l||v||g.goToOption(C.Specific,a,0))}),T=(0,h.z)(e=>{I.wasMoved(e)&&(l||v&&g.goToOption(C.Nothing))}),A=(0,c.useMemo)(()=>({active:v,selected:y,disabled:l}),[v,y,l]);return(0,N.sY)({ourProps:{id:a,ref:j,role:"option",tabIndex:!0===l?void 0:-1,"aria-disabled":!0===l||void 0,"aria-selected":y,disabled:void 0,onClick:P,onFocus:_,onPointerEnter:M,onMouseEnter:M,onPointerMove:R,onMouseMove:R,onPointerLeave:T,onMouseLeave:T},theirProps:f,slot:A,defaultTag:"li",name:"Listbox.Option"})})})},33044:function(e,t,n){"use strict";let r;n.d(t,{u:function(){return M}});var o=n(2265),i=n(90945),a=n(13323),l=n(93394),c=n(64518),s=n(31948),u=n(72238),d=n(93689),f=n(16015),p=n(24536);function h(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e&&n.length>0&&e.classList.add(...n)}function m(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e&&n.length>0&&e.classList.remove(...n)}var g=n(37863),v=n(42120),b=n(27847);function y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(/\s+/).filter(e=>e.length>1)}let x=(0,o.createContext)(null);x.displayName="TransitionContext";var w=((r=w||{}).Visible="visible",r.Hidden="hidden",r);let S=(0,o.createContext)(null);function k(e){return"children"in e?k(e.children):e.current.filter(e=>{let{el:t}=e;return null!==t.current}).filter(e=>{let{state:t}=e;return"visible"===t}).length>0}function E(e,t){let n=(0,s.E)(e),r=(0,o.useRef)([]),c=(0,l.t)(),u=(0,i.G)(),d=(0,a.z)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.l4.Hidden,o=r.current.findIndex(t=>{let{el:n}=t;return n===e});-1!==o&&((0,p.E)(t,{[b.l4.Unmount](){r.current.splice(o,1)},[b.l4.Hidden](){r.current[o].state="hidden"}}),u.microTask(()=>{var e;!k(r)&&c.current&&(null==(e=n.current)||e.call(n))}))}),f=(0,a.z)(e=>{let t=r.current.find(t=>{let{el:n}=t;return n===e});return t?"visible"!==t.state&&(t.state="visible"):r.current.push({el:e,state:"visible"}),()=>d(e,b.l4.Unmount)}),h=(0,o.useRef)([]),m=(0,o.useRef)(Promise.resolve()),g=(0,o.useRef)({enter:[],leave:[],idle:[]}),v=(0,a.z)((e,n,r)=>{h.current.splice(0),t&&(t.chains.current[n]=t.chains.current[n].filter(t=>{let[n]=t;return n!==e})),null==t||t.chains.current[n].push([e,new Promise(e=>{h.current.push(e)})]),null==t||t.chains.current[n].push([e,new Promise(e=>{Promise.all(g.current[n].map(e=>{let[t,n]=e;return n})).then(()=>e())})]),"enter"===n?m.current=m.current.then(()=>null==t?void 0:t.wait.current).then(()=>r(n)):r(n)}),y=(0,a.z)((e,t,n)=>{Promise.all(g.current[t].splice(0).map(e=>{let[t,n]=e;return n})).then(()=>{var e;null==(e=h.current.shift())||e()}).then(()=>n(t))});return(0,o.useMemo)(()=>({children:r,register:f,unregister:d,onStart:v,onStop:y,wait:m,chains:g}),[f,d,r,v,y,g,m])}function C(){}S.displayName="NestingContext";let O=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function j(e){var t;let n={};for(let r of O)n[r]=null!=(t=e[r])?t:C;return n}let P=b.AN.RenderStrategy,_=(0,b.yV)(function(e,t){let{show:n,appear:r=!1,unmount:i=!0,...l}=e,s=(0,o.useRef)(null),f=(0,d.T)(s,t);(0,u.H)();let p=(0,g.oJ)();if(void 0===n&&null!==p&&(n=(p&g.ZM.Open)===g.ZM.Open),![!0,!1].includes(n))throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,m]=(0,o.useState)(n?"visible":"hidden"),v=E(()=>{m("hidden")}),[y,w]=(0,o.useState)(!0),C=(0,o.useRef)([n]);(0,c.e)(()=>{!1!==y&&C.current[C.current.length-1]!==n&&(C.current.push(n),w(!1))},[C,n]);let O=(0,o.useMemo)(()=>({show:n,appear:r,initial:y}),[n,r,y]);(0,o.useEffect)(()=>{if(n)m("visible");else if(k(v)){let e=s.current;if(!e)return;let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&m("hidden")}else m("hidden")},[n,v]);let j={unmount:i},_=(0,a.z)(()=>{var t;y&&w(!1),null==(t=e.beforeEnter)||t.call(e)}),N=(0,a.z)(()=>{var t;y&&w(!1),null==(t=e.beforeLeave)||t.call(e)});return o.createElement(S.Provider,{value:v},o.createElement(x.Provider,{value:O},(0,b.sY)({ourProps:{...j,as:o.Fragment,children:o.createElement(I,{ref:f,...j,...l,beforeEnter:_,beforeLeave:N})},theirProps:{},defaultTag:o.Fragment,features:P,visible:"visible"===h,name:"Transition"})))}),I=(0,b.yV)(function(e,t){var n,r,w;let C;let{beforeEnter:O,afterEnter:_,beforeLeave:I,afterLeave:N,enter:M,enterFrom:R,enterTo:T,entered:A,leave:D,leaveFrom:Z,leaveTo:L,...z}=e,B=(0,o.useRef)(null),F=(0,d.T)(B,t),H=null==(n=z.unmount)||n?b.l4.Unmount:b.l4.Hidden,{show:q,appear:W,initial:U}=function(){let e=(0,o.useContext)(x);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[K,V]=(0,o.useState)(q?"visible":"hidden"),$=function(){let e=(0,o.useContext)(S);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:X,unregister:G}=$;(0,o.useEffect)(()=>X(B),[X,B]),(0,o.useEffect)(()=>{if(H===b.l4.Hidden&&B.current){if(q&&"visible"!==K){V("visible");return}return(0,p.E)(K,{hidden:()=>G(B),visible:()=>X(B)})}},[K,B,X,G,q,H]);let Y=(0,s.E)({base:y(z.className),enter:y(M),enterFrom:y(R),enterTo:y(T),entered:y(A),leave:y(D),leaveFrom:y(Z),leaveTo:y(L)}),Q=(w={beforeEnter:O,afterEnter:_,beforeLeave:I,afterLeave:N},C=(0,o.useRef)(j(w)),(0,o.useEffect)(()=>{C.current=j(w)},[w]),C),J=(0,u.H)();(0,o.useEffect)(()=>{if(J&&"visible"===K&&null===B.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[B,K,J]);let ee=W&&q&&U,et=J&&(!U||W)?q?"enter":"leave":"idle",en=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t,n]=(0,o.useState)(e),r=(0,l.t)(),i=(0,o.useCallback)(e=>{r.current&&n(t=>t|e)},[t,r]),a=(0,o.useCallback)(e=>!!(t&e),[t]);return{flags:t,addFlag:i,hasFlag:a,removeFlag:(0,o.useCallback)(e=>{r.current&&n(t=>t&~e)},[n,r]),toggleFlag:(0,o.useCallback)(e=>{r.current&&n(t=>t^e)},[n])}}(0),er=(0,a.z)(e=>(0,p.E)(e,{enter:()=>{en.addFlag(g.ZM.Opening),Q.current.beforeEnter()},leave:()=>{en.addFlag(g.ZM.Closing),Q.current.beforeLeave()},idle:()=>{}})),eo=(0,a.z)(e=>(0,p.E)(e,{enter:()=>{en.removeFlag(g.ZM.Opening),Q.current.afterEnter()},leave:()=>{en.removeFlag(g.ZM.Closing),Q.current.afterLeave()},idle:()=>{}})),ei=E(()=>{V("hidden"),G(B)},$),ea=(0,o.useRef)(!1);!function(e){let{immediate:t,container:n,direction:r,classes:o,onStart:a,onStop:u}=e,d=(0,l.t)(),g=(0,i.G)(),v=(0,s.E)(r);(0,c.e)(()=>{t&&(v.current="enter")},[t]),(0,c.e)(()=>{let e=(0,f.k)();g.add(e.dispose);let t=n.current;if(t&&"idle"!==v.current&&d.current){var r,i,l;let n,c,s,d,g,b,y;return e.dispose(),a.current(v.current),e.add((r=o.current,i="enter"===v.current,l=()=>{e.dispose(),u.current(v.current)},c=i?"enter":"leave",s=(0,f.k)(),d=void 0!==l?(n={called:!1},function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!n.called)return n.called=!0,l(...t)}):()=>{},"enter"===c&&(t.removeAttribute("hidden"),t.style.display=""),g=(0,p.E)(c,{enter:()=>r.enter,leave:()=>r.leave}),b=(0,p.E)(c,{enter:()=>r.enterTo,leave:()=>r.leaveTo}),y=(0,p.E)(c,{enter:()=>r.enterFrom,leave:()=>r.leaveFrom}),m(t,...r.base,...r.enter,...r.enterTo,...r.enterFrom,...r.leave,...r.leaveFrom,...r.leaveTo,...r.entered),h(t,...r.base,...g,...y),s.nextFrame(()=>{m(t,...r.base,...g,...y),h(t,...r.base,...g,...b),function(e,t){let n=(0,f.k)();if(!e)return n.dispose;let{transitionDuration:r,transitionDelay:o}=getComputedStyle(e),[i,a]=[r,o].map(e=>{let[t=0]=e.split(",").filter(Boolean).map(e=>e.includes("ms")?parseFloat(e):1e3*parseFloat(e)).sort((e,t)=>t-e);return t}),l=i+a;if(0!==l){n.group(n=>{n.setTimeout(()=>{t(),n.dispose()},l),n.addEventListener(e,"transitionrun",e=>{e.target===e.currentTarget&&n.dispose()})});let r=n.addEventListener(e,"transitionend",e=>{e.target===e.currentTarget&&(t(),r())})}else t();n.add(()=>t()),n.dispose}(t,()=>(m(t,...r.base,...g),h(t,...r.base,...r.entered),d()))}),s.dispose)),e.dispose}},[r])}({immediate:ee,container:B,classes:Y,direction:et,onStart:(0,s.E)(e=>{ea.current=!0,ei.onStart(B,e,er)}),onStop:(0,s.E)(e=>{ea.current=!1,ei.onStop(B,e,eo),"leave"!==e||k(ei)||(V("hidden"),G(B))})});let el=z;return ee?el={...el,className:(0,v.A)(z.className,...Y.current.enter,...Y.current.enterFrom)}:ea.current&&(el.className=(0,v.A)(z.className,null==(r=B.current)?void 0:r.className),""===el.className&&delete el.className),o.createElement(S.Provider,{value:ei},o.createElement(g.up,{value:(0,p.E)(K,{visible:g.ZM.Open,hidden:g.ZM.Closed})|en.flags},(0,b.sY)({ourProps:{ref:F},theirProps:el,defaultTag:"div",features:P,visible:"visible"===K,name:"Transition.Child"})))}),N=(0,b.yV)(function(e,t){let n=null!==(0,o.useContext)(x),r=null!==(0,g.oJ)();return o.createElement(o.Fragment,null,!n&&r?o.createElement(_,{ref:t,...e}):o.createElement(I,{ref:t,...e}))}),M=Object.assign(_,{Child:N,Root:_})},62963:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var r=n(2265),o=n(13323);function i(e,t,n){let[i,a]=(0,r.useState)(n),l=void 0!==e,c=(0,r.useRef)(l),s=(0,r.useRef)(!1),u=(0,r.useRef)(!1);return!l||c.current||s.current?l||!c.current||u.current||(u.current=!0,c.current=l,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")):(s.current=!0,c.current=l,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")),[l?e:i,(0,o.z)(e=>(l||a(e),null==t?void 0:t(e)))]}},90945:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var r=n(2265),o=n(16015);function i(){let[e]=(0,r.useState)(o.k);return(0,r.useEffect)(()=>()=>e.dispose(),[e]),e}},98505:function(e,t,n){"use strict";n.d(t,{O:function(){return c}});var r=n(2265),o=n(37105),i=n(31948);function a(e,t,n){let o=(0,i.E)(t);(0,r.useEffect)(()=>{function t(e){o.current(e)}return document.addEventListener(e,t,n),()=>document.removeEventListener(e,t,n)},[e,n])}var l=n(3141);function c(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=(0,r.useRef)(!1);function c(n,r){if(!i.current||n.defaultPrevented)return;let a=r(n);if(null!==a&&a.getRootNode().contains(a)&&a.isConnected){for(let t of function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(e)){if(null===t)continue;let e=t instanceof HTMLElement?t:t.current;if(null!=e&&e.contains(a)||n.composed&&n.composedPath().includes(e))return}return(0,o.sP)(a,o.tJ.Loose)||-1===a.tabIndex||n.preventDefault(),t(n,a)}}(0,r.useEffect)(()=>{requestAnimationFrame(()=>{i.current=n})},[n]);let s=(0,r.useRef)(null);a("pointerdown",e=>{var t,n;i.current&&(s.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target)},!0),a("mousedown",e=>{var t,n;i.current&&(s.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target)},!0),a("click",e=>{/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0||/Android/gi.test(window.navigator.userAgent)||s.current&&(c(e,()=>s.current),s.current=null)},!0),a("touchend",e=>c(e,()=>e.target instanceof HTMLElement?e.target:null),!0),(0,l.s)("blur",e=>c(e,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}},3141:function(e,t,n){"use strict";n.d(t,{s:function(){return i}});var r=n(2265),o=n(31948);function i(e,t,n){let i=(0,o.E)(t);(0,r.useEffect)(()=>{function t(e){i.current(e)}return window.addEventListener(e,t,n),()=>window.removeEventListener(e,t,n)},[e,n])}},37863:function(e,t,n){"use strict";let r;n.d(t,{ZM:function(){return a},oJ:function(){return l},up:function(){return c}});var o=n(2265);let i=(0,o.createContext)(null);i.displayName="OpenClosedContext";var a=((r=a||{})[r.Open=1]="Open",r[r.Closed=2]="Closed",r[r.Closing=4]="Closing",r[r.Opening=8]="Opening",r);function l(){return(0,o.useContext)(i)}function c(e){let{value:t,children:n}=e;return o.createElement(i.Provider,{value:t},n)}},47634:function(e,t,n){"use strict";function r(e){let t=e.parentElement,n=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(n=t),t=t.parentElement;let r=(null==t?void 0:t.getAttribute("disabled"))==="";return!(r&&function(e){if(!e)return!1;let t=e.previousElementSibling;for(;null!==t;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}(n))&&r}n.d(t,{P:function(){return r}})},16015:function(e,t,n){"use strict";n.d(t,{k:function(){return function e(){let t=[],n={addEventListener:(e,t,r,o)=>(e.addEventListener(t,r,o),n.add(()=>e.removeEventListener(t,r,o))),requestAnimationFrame(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let o=requestAnimationFrame(...t);return n.add(()=>cancelAnimationFrame(o))},nextFrame(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.requestAnimationFrame(()=>n.requestAnimationFrame(...t))},setTimeout(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let o=setTimeout(...t);return n.add(()=>clearTimeout(o))},microTask(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];let i={current:!0};return(0,r.Y)(()=>{i.current&&t[0]()}),n.add(()=>{i.current=!1})},style(e,t,n){let r=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:n}),this.add(()=>{Object.assign(e.style,{[t]:r})})},group(t){let n=e();return t(n),this.add(()=>n.dispose())},add:e=>(t.push(e),()=>{let n=t.indexOf(e);if(n>=0)for(let e of t.splice(n,1))e()}),dispose(){for(let e of t.splice(0))e()}};return n}}});var r=n(96822)},56314:function(e,t,n){"use strict";function r(e,t){return e?e+"["+t+"]":t}function o(e){var t,n;let r=null!=(t=null==e?void 0:e.form)?t:e.closest("form");if(r){for(let t of r.elements)if(t!==e&&("INPUT"===t.tagName&&"submit"===t.type||"BUTTON"===t.tagName&&"submit"===t.type||"INPUT"===t.nodeName&&"image"===t.type)){t.click();return}null==(n=r.requestSubmit)||n.call(r)}}n.d(t,{g:function(){return o},t:function(){return function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let[i,a]of Object.entries(t))!function t(n,o,i){if(Array.isArray(i))for(let[e,a]of i.entries())t(n,r(o,e.toString()),a);else i instanceof Date?n.push([o,i.toISOString()]):"boolean"==typeof i?n.push([o,i?"1":"0"]):"string"==typeof i?n.push([o,i]):"number"==typeof i?n.push([o,"".concat(i)]):null==i?n.push([o,""]):e(i,o,n)}(o,r(n,i),a);return o}}})},10900:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"}))});t.Z=o},44643:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))});t.Z=o},86462:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"}))});t.Z=o},47686:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"}))});t.Z=o},44633:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"}))});t.Z=o},51853:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"}))});t.Z=o},79814:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"}))});t.Z=o},88532:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}))});t.Z=o},2356:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))});t.Z=o},15731:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});t.Z=o},45589:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"}))});t.Z=o},53410:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}))});t.Z=o},91126:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});t.Z=o},22452:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"}))});t.Z=o},23628:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"}))});t.Z=o},25327:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"}))});t.Z=o},49084:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"}))});t.Z=o},74998:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"}))});t.Z=o},71157:function(e,t,n){"use strict";var r=n(2265);let o=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))});t.Z=o},87045:function(e,t,n){"use strict";n.d(t,{j:function(){return i}});var r=n(24112),o=n(45345),i=new class extends r.l{#e;#t;#n;constructor(){super(),this.#n=e=>{if(!o.sk&&window.addEventListener){let t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){let e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#e?this.#e:globalThis.document?.visibilityState!=="hidden"}}},2894:function(e,t,n){"use strict";n.d(t,{R:function(){return l},m:function(){return a}});var r=n(18238),o=n(7989),i=n(11255),a=class extends o.F{#r;#o;#i;constructor(e){super(),this.mutationId=e.mutationId,this.#o=e.mutationCache,this.#r=[],this.state=e.state||l(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#r.includes(e)||(this.#r.push(e),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#r=this.#r.filter(t=>t!==e),this.scheduleGc(),this.#o.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#r.length||("pending"===this.state.status?this.scheduleGc():this.#o.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){this.#i=(0,i.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#a({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#o.canRun(this)});let t="pending"===this.state.status,n=!this.#i.canStart();try{if(!t){this.#a({type:"pending",variables:e,isPaused:n}),await this.#o.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#a({type:"pending",context:t,variables:e,isPaused:n})}let r=await this.#i.start();return await this.#o.config.onSuccess?.(r,e,this.state.context,this),await this.options.onSuccess?.(r,e,this.state.context),await this.#o.config.onSettled?.(r,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(r,null,e,this.state.context),this.#a({type:"success",data:r}),r}catch(t){try{throw await this.#o.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#o.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#a({type:"error",error:t})}}finally{this.#o.runNext(this)}}#a(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),r.V.batch(()=>{this.#r.forEach(t=>{t.onMutationUpdate(e)}),this.#o.notify({mutation:this,type:"updated",action:e})})}};function l(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},18238:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var r=function(){let e=[],t=0,n=e=>{e()},r=e=>{e()},o=e=>setTimeout(e,0),i=r=>{t?e.push(r):o(()=>{n(r)})},a=()=>{let t=e;e=[],t.length&&o(()=>{r(()=>{t.forEach(e=>{n(e)})})})};return{batch:e=>{let n;t++;try{n=e()}finally{--t||a()}return n},batchCalls:e=>(...t)=>{i(()=>{e(...t)})},schedule:i,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{r=e},setScheduler:e=>{o=e}}}()},57853:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var r=n(24112),o=n(45345),i=new class extends r.l{#l=!0;#t;#n;constructor(){super(),this.#n=e=>{if(!o.sk&&window.addEventListener){let t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#l!==e&&(this.#l=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#l}}},21733:function(e,t,n){"use strict";n.d(t,{A:function(){return l},z:function(){return c}});var r=n(45345),o=n(18238),i=n(11255),a=n(7989),l=class extends a.F{#c;#s;#u;#i;#d;#f;constructor(e){super(),this.#f=!1,this.#d=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#u=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#c=function(e){let t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,r=n?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=e.state??this.#c,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#i?.promise}setOptions(e){this.options={...this.#d,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#u.remove(this)}setData(e,t){let n=(0,r.oE)(this.state.data,e,this.options);return this.#a({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#a({type:"setState",state:e,setStateOptions:t})}cancel(e){let t=this.#i?.promise;return this.#i?.cancel(e),t?t.then(r.ZT).catch(r.ZT):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#c)}isActive(){return this.observers.some(e=>!1!==(0,r.Nc)(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===r.CN||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return!!this.state.isInvalidated||(this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data)}isStaleByTime(e=0){return this.state.isInvalidated||void 0===this.state.data||!(0,r.Kp)(this.state.dataUpdatedAt,e)}onFocus(){let e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#i?.continue()}onOnline(){let e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#i?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#u.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#i&&(this.#f?this.#i.cancel({revert:!0}):this.#i.cancelRetry()),this.scheduleGc()),this.#u.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus){if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#i)return this.#i.continueRetry(),this.#i.promise}if(e&&this.setOptions(e),!this.options.queryFn){let e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}let n=new AbortController,o=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#f=!0,n.signal)})},a={fetchOptions:t,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:()=>{let e=(0,r.cG)(this.options,t),n={queryKey:this.queryKey,meta:this.meta};return(o(n),this.#f=!1,this.options.persister)?this.options.persister(e,n,this):e(n)}};o(a),this.options.behavior?.onFetch(a,this),this.#s=this.state,("idle"===this.state.fetchStatus||this.state.fetchMeta!==a.fetchOptions?.meta)&&this.#a({type:"fetch",meta:a.fetchOptions?.meta});let l=e=>{(0,i.DV)(e)&&e.silent||this.#a({type:"error",error:e}),(0,i.DV)(e)||(this.#u.config.onError?.(e,this),this.#u.config.onSettled?.(this.state.data,e,this)),this.scheduleGc()};return this.#i=(0,i.Mz)({initialPromise:t?.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{if(void 0===e){l(Error(`${this.queryHash} data is undefined`));return}try{this.setData(e)}catch(e){l(e);return}this.#u.config.onSuccess?.(e,this),this.#u.config.onSettled?.(e,this.state.error,this),this.scheduleGc()},onError:l,onFail:(e,t)=>{this.#a({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}),this.#i.start()}#a(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...c(t.data,this.options),fetchMeta:e.meta??null};case"success":return{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":let n=e.error;if((0,i.DV)(n)&&n.revert&&this.#s)return{...this.#s,fetchStatus:"idle"};return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),o.V.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#u.notify({query:this,type:"updated",action:e})})}};function c(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:(0,i.Kw)(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}},21623:function(e,t,n){"use strict";n.d(t,{S:function(){return m}});var r=n(45345),o=n(21733),i=n(18238),a=n(24112),l=class extends a.l{constructor(e={}){super(),this.config=e,this.#p=new Map}#p;build(e,t,n){let i=t.queryKey,a=t.queryHash??(0,r.Rm)(i,t),l=this.get(a);return l||(l=new o.A({cache:this,queryKey:i,queryHash:a,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(l)),l}add(e){this.#p.has(e.queryHash)||(this.#p.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){let t=this.#p.get(e.queryHash);t&&(e.destroy(),t===e&&this.#p.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){i.V.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#p.get(e)}getAll(){return[...this.#p.values()]}find(e){let t={exact:!0,...e};return this.getAll().find(e=>(0,r._x)(t,e))}findAll(e={}){let t=this.getAll();return Object.keys(e).length>0?t.filter(t=>(0,r._x)(e,t)):t}notify(e){i.V.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){i.V.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){i.V.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},c=n(2894),s=class extends a.l{constructor(e={}){super(),this.config=e,this.#h=new Set,this.#m=new Map,this.#g=0}#h;#m;#g;build(e,t,n){let r=new c.m({mutationCache:this,mutationId:++this.#g,options:e.defaultMutationOptions(t),state:n});return this.add(r),r}add(e){this.#h.add(e);let t=u(e);if("string"==typeof t){let n=this.#m.get(t);n?n.push(e):this.#m.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#h.delete(e)){let t=u(e);if("string"==typeof t){let n=this.#m.get(t);if(n){if(n.length>1){let t=n.indexOf(e);-1!==t&&n.splice(t,1)}else n[0]===e&&this.#m.delete(t)}}}this.notify({type:"removed",mutation:e})}canRun(e){let t=u(e);if("string"!=typeof t)return!0;{let n=this.#m.get(t),r=n?.find(e=>"pending"===e.state.status);return!r||r===e}}runNext(e){let t=u(e);if("string"!=typeof t)return Promise.resolve();{let n=this.#m.get(t)?.find(t=>t!==e&&t.state.isPaused);return n?.continue()??Promise.resolve()}}clear(){i.V.batch(()=>{this.#h.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#h.clear(),this.#m.clear()})}getAll(){return Array.from(this.#h)}find(e){let t={exact:!0,...e};return this.getAll().find(e=>(0,r.X7)(t,e))}findAll(e={}){return this.getAll().filter(t=>(0,r.X7)(e,t))}notify(e){i.V.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){let e=this.getAll().filter(e=>e.state.isPaused);return i.V.batch(()=>Promise.all(e.map(e=>e.continue().catch(r.ZT))))}};function u(e){return e.options.scope?.id}var d=n(87045),f=n(57853);function p(e){return{onFetch:(t,n)=>{let o=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],l=t.state.data?.pageParams||[],c={pages:[],pageParams:[]},s=0,u=async()=>{let n=!1,u=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",()=>{n=!0}),t.signal)})},d=(0,r.cG)(t.options,t.fetchOptions),f=async(e,o,i)=>{if(n)return Promise.reject();if(null==o&&e.pages.length)return Promise.resolve(e);let a={queryKey:t.queryKey,pageParam:o,direction:i?"backward":"forward",meta:t.options.meta};u(a);let l=await d(a),{maxPages:c}=t.options,s=i?r.Ht:r.VX;return{pages:s(e.pages,l,c),pageParams:s(e.pageParams,o,c)}};if(i&&a.length){let e="backward"===i,t={pages:a,pageParams:l},n=(e?function(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}:h)(o,t);c=await f(t,n,e)}else{let t=e??a.length;do{let e=0===s?l[0]??o.initialPageParam:h(o,c);if(s>0&&null==e)break;c=await f(c,e),s++}while(s<t)}return c};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=u}}}function h(e,{pages:t,pageParams:n}){let r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}var m=class{#v;#o;#d;#b;#y;#x;#w;#S;constructor(e={}){this.#v=e.queryCache||new l,this.#o=e.mutationCache||new s,this.#d=e.defaultOptions||{},this.#b=new Map,this.#y=new Map,this.#x=0}mount(){this.#x++,1===this.#x&&(this.#w=d.j.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#v.onFocus())}),this.#S=f.N.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#v.onOnline())}))}unmount(){this.#x--,0===this.#x&&(this.#w?.(),this.#w=void 0,this.#S?.(),this.#S=void 0)}isFetching(e){return this.#v.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#o.findAll({...e,status:"pending"}).length}getQueryData(e){let t=this.defaultQueryOptions({queryKey:e});return this.#v.get(t.queryHash)?.state.data}ensureQueryData(e){let t=this.defaultQueryOptions(e),n=this.#v.build(this,t),o=n.state.data;return void 0===o?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime((0,r.KC)(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(o))}getQueriesData(e){return this.#v.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,n){let o=this.defaultQueryOptions({queryKey:e}),i=this.#v.get(o.queryHash),a=i?.state.data,l=(0,r.SE)(t,a);if(void 0!==l)return this.#v.build(this,o).setData(l,{...n,manual:!0})}setQueriesData(e,t,n){return i.V.batch(()=>this.#v.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,n)]))}getQueryState(e){let t=this.defaultQueryOptions({queryKey:e});return this.#v.get(t.queryHash)?.state}removeQueries(e){let t=this.#v;i.V.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){let n=this.#v,r={type:"active",...e};return i.V.batch(()=>(n.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries(r,t)))}cancelQueries(e,t={}){let n={revert:!0,...t};return Promise.all(i.V.batch(()=>this.#v.findAll(e).map(e=>e.cancel(n)))).then(r.ZT).catch(r.ZT)}invalidateQueries(e,t={}){return i.V.batch(()=>{if(this.#v.findAll(e).forEach(e=>{e.invalidate()}),e?.refetchType==="none")return Promise.resolve();let n={...e,type:e?.refetchType??e?.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e,t={}){let n={...t,cancelRefetch:t.cancelRefetch??!0};return Promise.all(i.V.batch(()=>this.#v.findAll(e).filter(e=>!e.isDisabled()).map(e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(r.ZT)),"paused"===e.state.fetchStatus?Promise.resolve():t}))).then(r.ZT)}fetchQuery(e){let t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);let n=this.#v.build(this,t);return n.isStaleByTime((0,r.KC)(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(r.ZT).catch(r.ZT)}fetchInfiniteQuery(e){return e.behavior=p(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(r.ZT).catch(r.ZT)}ensureInfiniteQueryData(e){return e.behavior=p(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return f.N.isOnline()?this.#o.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#v}getMutationCache(){return this.#o}getDefaultOptions(){return this.#d}setDefaultOptions(e){this.#d=e}setQueryDefaults(e,t){this.#b.set((0,r.Ym)(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){let t=[...this.#b.values()],n={};return t.forEach(t=>{(0,r.to)(e,t.queryKey)&&Object.assign(n,t.defaultOptions)}),n}setMutationDefaults(e,t){this.#y.set((0,r.Ym)(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){let t=[...this.#y.values()],n={};return t.forEach(t=>{(0,r.to)(e,t.mutationKey)&&(n={...n,...t.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;let t={...this.#d.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=(0,r.Rm)(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===r.CN&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#d.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#v.clear(),this.#o.clear()}}},7989:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(45345),o=class{#k;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,r.PN)(this.gcTime)&&(this.#k=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(r.sk?1/0:3e5))}clearGcTimeout(){this.#k&&(clearTimeout(this.#k),this.#k=void 0)}}},11255:function(e,t,n){"use strict";n.d(t,{DV:function(){return u},Kw:function(){return c},Mz:function(){return d}});var r=n(87045),o=n(57853),i=n(16803),a=n(45345);function l(e){return Math.min(1e3*2**e,3e4)}function c(e){return(e??"online")!=="online"||o.N.isOnline()}var s=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function u(e){return e instanceof s}function d(e){let t,n=!1,u=0,d=!1,f=(0,i.O)(),p=()=>r.j.isFocused()&&("always"===e.networkMode||o.N.isOnline())&&e.canRun(),h=()=>c(e.networkMode)&&e.canRun(),m=n=>{d||(d=!0,e.onSuccess?.(n),t?.(),f.resolve(n))},g=n=>{d||(d=!0,e.onError?.(n),t?.(),f.reject(n))},v=()=>new Promise(n=>{t=e=>{(d||p())&&n(e)},e.onPause?.()}).then(()=>{t=void 0,d||e.onContinue?.()}),b=()=>{let t;if(d)return;let r=0===u?e.initialPromise:void 0;try{t=r??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(m).catch(t=>{if(d)return;let r=e.retry??(a.sk?0:3),o=e.retryDelay??l,i="function"==typeof o?o(u,t):o,c=!0===r||"number"==typeof r&&u<r||"function"==typeof r&&r(u,t);if(n||!c){g(t);return}u++,e.onFail?.(u,t),(0,a._v)(i).then(()=>p()?void 0:v()).then(()=>{n?g(t):b()})})};return{promise:f,cancel:t=>{d||(g(new s(t)),e.abort?.())},continue:()=>(t?.(),f),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:h,start:()=>(h()?b():v().then(b),f)}}},24112:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var r=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}},16803:function(e,t,n){"use strict";function r(){let e,t;let n=new Promise((n,r)=>{e=n,t=r});function r(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=t=>{r({status:"fulfilled",value:t}),e(t)},n.reject=e=>{r({status:"rejected",reason:e}),t(e)},n}n.d(t,{O:function(){return r}})},45345:function(e,t,n){"use strict";n.d(t,{CN:function(){return k},Ht:function(){return S},KC:function(){return c},Kp:function(){return l},Nc:function(){return s},PN:function(){return a},Rm:function(){return f},SE:function(){return i},VS:function(){return m},VX:function(){return w},X7:function(){return d},Ym:function(){return p},ZT:function(){return o},_v:function(){return y},_x:function(){return u},cG:function(){return E},oE:function(){return x},sk:function(){return r},to:function(){return h}});var r="undefined"==typeof window||"Deno"in globalThis;function o(){}function i(e,t){return"function"==typeof e?e(t):e}function a(e){return"number"==typeof e&&e>=0&&e!==1/0}function l(e,t){return Math.max(e+(t||0)-Date.now(),0)}function c(e,t){return"function"==typeof e?e(t):e}function s(e,t){return"function"==typeof e?e(t):e}function u(e,t){let{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:l}=e;if(a){if(r){if(t.queryHash!==f(a,t.options))return!1}else if(!h(t.queryKey,a))return!1}if("all"!==n){let e=t.isActive();if("active"===n&&!e||"inactive"===n&&e)return!1}return("boolean"!=typeof l||t.isStale()===l)&&(!o||o===t.state.fetchStatus)&&(!i||!!i(t))}function d(e,t){let{exact:n,status:r,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(p(t.options.mutationKey)!==p(i))return!1}else if(!h(t.options.mutationKey,i))return!1}return(!r||t.state.status===r)&&(!o||!!o(t))}function f(e,t){return(t?.queryKeyHashFn||p)(e)}function p(e){return JSON.stringify(e,(e,t)=>v(t)?Object.keys(t).sort().reduce((e,n)=>(e[n]=t[n],e),{}):t)}function h(e,t){return e===t||typeof e==typeof t&&!!e&&!!t&&"object"==typeof e&&"object"==typeof t&&!Object.keys(t).some(n=>!h(e[n],t[n]))}function m(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(e[n]!==t[n])return!1;return!0}function g(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function v(e){if(!b(e))return!1;let t=e.constructor;if(void 0===t)return!0;let n=t.prototype;return!!(b(n)&&n.hasOwnProperty("isPrototypeOf"))&&Object.getPrototypeOf(e)===Object.prototype}function b(e){return"[object Object]"===Object.prototype.toString.call(e)}function y(e){return new Promise(t=>{setTimeout(t,e)})}function x(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?function e(t,n){if(t===n)return t;let r=g(t)&&g(n);if(r||v(t)&&v(n)){let o=r?t:Object.keys(t),i=o.length,a=r?n:Object.keys(n),l=a.length,c=r?[]:{},s=0;for(let i=0;i<l;i++){let l=r?i:a[i];(!r&&o.includes(l)||r)&&void 0===t[l]&&void 0===n[l]?(c[l]=void 0,s++):(c[l]=e(t[l],n[l]),c[l]===t[l]&&void 0!==t[l]&&s++)}return i===l&&s===i?t:c}return n}(e,t):t}function w(e,t,n=0){let r=[...e,t];return n&&r.length>n?r.slice(1):r}function S(e,t,n=0){let r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var k=Symbol();function E(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==k?e.queryFn:()=>Promise.reject(Error(`Missing queryFn: '${e.queryHash}'`))}},19616:function(e,t,n){"use strict";n.d(t,{G:function(){return a}});var r=n(2265);let o={enabled:!0,leading:!1,trailing:!0,wait:0,onExecute:()=>{}};class i{constructor(e,t){this.fn=e,this._canLeadingExecute=!0,this._isPending=!1,this._executionCount=0,this._options={...o,...t}}setOptions(e){return this._options={...this._options,...e},this._options.enabled||(this._isPending=!1),this._options}getOptions(){return this._options}maybeExecute(...e){this._options.leading&&this._canLeadingExecute&&(this.executeFunction(...e),this._canLeadingExecute=!1),(this._options.leading||this._options.trailing)&&(this._isPending=!0),this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this._canLeadingExecute=!0,this._isPending=!1,this._options.trailing&&this.executeFunction(...e)},this._options.wait)}executeFunction(...e){this._options.enabled&&(this.fn(...e),this._executionCount++,this._options.onExecute(this))}cancel(){this._timeoutId&&(clearTimeout(this._timeoutId),this._canLeadingExecute=!0,this._isPending=!1)}getExecutionCount(){return this._executionCount}getIsPending(){return this._options.enabled&&this._isPending}}function a(e,t){let[n,o]=(0,r.useState)(e),a=function(e,t){let[n]=(0,r.useState)(()=>{var n;return Object.getOwnPropertyNames(Object.getPrototypeOf(n=new i(e,t))).filter(e=>"function"==typeof n[e]).reduce((e,t)=>{let r=n[t];return"function"==typeof r&&(e[t]=r.bind(n)),e},{})});return n.setOptions(t),n}(o,t);return[n,a.maybeExecute,a]}},29827:function(e,t,n){"use strict";n.d(t,{NL:function(){return a},aH:function(){return l}});var r=n(2265),o=n(57437),i=r.createContext(void 0),a=e=>{let t=r.useContext(i);if(e)return e;if(!t)throw Error("No QueryClient set, use QueryClientProvider to set one");return t},l=e=>{let{client:t,children:n}=e;return r.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),(0,o.jsx)(i.Provider,{value:t,children:n})}},21770:function(e,t,n){"use strict";n.d(t,{D:function(){return d}});var r=n(2265),o=n(2894),i=n(18238),a=n(24112),l=n(45345),c=class extends a.l{#E;#C=void 0;#O;#j;constructor(e,t){super(),this.#E=e,this.setOptions(t),this.bindMethods(),this.#P()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#E.defaultMutationOptions(e),(0,l.VS)(this.options,t)||this.#E.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#O,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.Ym)(t.mutationKey)!==(0,l.Ym)(this.options.mutationKey)?this.reset():this.#O?.state.status==="pending"&&this.#O.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#O?.removeObserver(this)}onMutationUpdate(e){this.#P(),this.#_(e)}getCurrentResult(){return this.#C}reset(){this.#O?.removeObserver(this),this.#O=void 0,this.#P(),this.#_()}mutate(e,t){return this.#j=t,this.#O?.removeObserver(this),this.#O=this.#E.getMutationCache().build(this.#E,this.options),this.#O.addObserver(this),this.#O.execute(e)}#P(){let e=this.#O?.state??(0,o.R)();this.#C={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#_(e){i.V.batch(()=>{if(this.#j&&this.hasListeners()){let t=this.#C.variables,n=this.#C.context;e?.type==="success"?(this.#j.onSuccess?.(e.data,t,n),this.#j.onSettled?.(e.data,null,t,n)):e?.type==="error"&&(this.#j.onError?.(e.error,t,n),this.#j.onSettled?.(void 0,e.error,t,n))}this.listeners.forEach(e=>{e(this.#C)})})}},s=n(29827),u=n(51172);function d(e,t){let n=(0,s.NL)(t),[o]=r.useState(()=>new c(n,e));r.useEffect(()=>{o.setOptions(e)},[o,e]);let a=r.useSyncExternalStore(r.useCallback(e=>o.subscribe(i.V.batchCalls(e)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),l=r.useCallback((e,t)=>{o.mutate(e,t).catch(u.Z)},[o]);if(a.error&&(0,u.L)(o.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}},16593:function(e,t,n){"use strict";let r;n.d(t,{a:function(){return _}});var o=n(87045),i=n(18238),a=n(21733),l=n(24112),c=n(16803),s=n(45345),u=class extends l.l{constructor(e,t){super(),this.options=t,this.#E=e,this.#I=null,this.#N=(0,c.O)(),this.options.experimental_prefetchInRender||this.#N.reject(Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#E;#M=void 0;#R=void 0;#C=void 0;#T;#A;#N;#I;#D;#Z;#L;#z;#B;#F;#H=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#M.addObserver(this),d(this.#M,this.options)?this.#q():this.updateResult(),this.#W())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return f(this.#M,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return f(this.#M,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#U(),this.#K(),this.#M.removeObserver(this)}setOptions(e,t){let n=this.options,r=this.#M;if(this.options=this.#E.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,s.Nc)(this.options.enabled,this.#M))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#V(),this.#M.setOptions(this.options),n._defaulted&&!(0,s.VS)(this.options,n)&&this.#E.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#M,observer:this});let o=this.hasListeners();o&&p(this.#M,r,this.options,n)&&this.#q(),this.updateResult(t),o&&(this.#M!==r||(0,s.Nc)(this.options.enabled,this.#M)!==(0,s.Nc)(n.enabled,this.#M)||(0,s.KC)(this.options.staleTime,this.#M)!==(0,s.KC)(n.staleTime,this.#M))&&this.#$();let i=this.#X();o&&(this.#M!==r||(0,s.Nc)(this.options.enabled,this.#M)!==(0,s.Nc)(n.enabled,this.#M)||i!==this.#F)&&this.#G(i)}getOptimisticResult(e){let t=this.#E.getQueryCache().build(this.#E,e),n=this.createResult(t,e);return(0,s.VS)(this.getCurrentResult(),n)||(this.#C=n,this.#A=this.options,this.#T=this.#M.state),n}getCurrentResult(){return this.#C}trackResult(e,t){let n={};return Object.keys(e).forEach(r=>{Object.defineProperty(n,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),t?.(r),e[r])})}),n}trackProp(e){this.#H.add(e)}getCurrentQuery(){return this.#M}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#E.defaultQueryOptions(e),n=this.#E.getQueryCache().build(this.#E,t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return this.#q({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#C))}#q(e){this.#V();let t=this.#M.fetch(this.options,e);return e?.throwOnError||(t=t.catch(s.ZT)),t}#$(){this.#U();let e=(0,s.KC)(this.options.staleTime,this.#M);if(s.sk||this.#C.isStale||!(0,s.PN)(e))return;let t=(0,s.Kp)(this.#C.dataUpdatedAt,e);this.#z=setTimeout(()=>{this.#C.isStale||this.updateResult()},t+1)}#X(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#M):this.options.refetchInterval)??!1}#G(e){this.#K(),this.#F=e,!s.sk&&!1!==(0,s.Nc)(this.options.enabled,this.#M)&&(0,s.PN)(this.#F)&&0!==this.#F&&(this.#B=setInterval(()=>{(this.options.refetchIntervalInBackground||o.j.isFocused())&&this.#q()},this.#F))}#W(){this.#$(),this.#G(this.#X())}#U(){this.#z&&(clearTimeout(this.#z),this.#z=void 0)}#K(){this.#B&&(clearInterval(this.#B),this.#B=void 0)}createResult(e,t){let n;let r=this.#M,o=this.options,i=this.#C,l=this.#T,u=this.#A,f=e!==r?e.state:this.#R,{state:m}=e,g={...m},v=!1;if(t._optimisticResults){let n=this.hasListeners(),i=!n&&d(e,t),l=n&&p(e,r,t,o);(i||l)&&(g={...g,...(0,a.z)(m.data,e.options)}),"isRestoring"===t._optimisticResults&&(g.fetchStatus="idle")}let{error:b,errorUpdatedAt:y,status:x}=g;if(t.select&&void 0!==g.data){if(i&&g.data===l?.data&&t.select===this.#D)n=this.#Z;else try{this.#D=t.select,n=t.select(g.data),n=(0,s.oE)(i?.data,n,t),this.#Z=n,this.#I=null}catch(e){this.#I=e}}else n=g.data;if(void 0!==t.placeholderData&&void 0===n&&"pending"===x){let e;if(i?.isPlaceholderData&&t.placeholderData===u?.placeholderData)e=i.data;else if(e="function"==typeof t.placeholderData?t.placeholderData(this.#L?.state.data,this.#L):t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),this.#I=null}catch(e){this.#I=e}void 0!==e&&(x="success",n=(0,s.oE)(i?.data,e,t),v=!0)}this.#I&&(b=this.#I,n=this.#Z,y=Date.now(),x="error");let w="fetching"===g.fetchStatus,S="pending"===x,k="error"===x,E=S&&w,C=void 0!==n,O={status:x,fetchStatus:g.fetchStatus,isPending:S,isSuccess:"success"===x,isError:k,isInitialLoading:E,isLoading:E,data:n,dataUpdatedAt:g.dataUpdatedAt,error:b,errorUpdatedAt:y,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>f.dataUpdateCount||g.errorUpdateCount>f.errorUpdateCount,isFetching:w,isRefetching:w&&!S,isLoadingError:k&&!C,isPaused:"paused"===g.fetchStatus,isPlaceholderData:v,isRefetchError:k&&C,isStale:h(e,t),refetch:this.refetch,promise:this.#N};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===O.status?e.reject(O.error):void 0!==O.data&&e.resolve(O.data)},n=()=>{t(this.#N=O.promise=(0,c.O)())},o=this.#N;switch(o.status){case"pending":e.queryHash===r.queryHash&&t(o);break;case"fulfilled":("error"===O.status||O.data!==o.value)&&n();break;case"rejected":("error"!==O.status||O.error!==o.reason)&&n()}}return O}updateResult(e){let t=this.#C,n=this.createResult(this.#M,this.options);if(this.#T=this.#M.state,this.#A=this.options,void 0!==this.#T.data&&(this.#L=this.#M),(0,s.VS)(n,t))return;this.#C=n;let r={};e?.listeners!==!1&&(()=>{if(!t)return!0;let{notifyOnChangeProps:e}=this.options,n="function"==typeof e?e():e;if("all"===n||!n&&!this.#H.size)return!0;let r=new Set(n??this.#H);return this.options.throwOnError&&r.add("error"),Object.keys(this.#C).some(e=>this.#C[e]!==t[e]&&r.has(e))})()&&(r.listeners=!0),this.#_({...r,...e})}#V(){let e=this.#E.getQueryCache().build(this.#E,this.options);if(e===this.#M)return;let t=this.#M;this.#M=e,this.#R=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#W()}#_(e){i.V.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#C)}),this.#E.getQueryCache().notify({query:this.#M,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,s.Nc)(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)||void 0!==e.state.data&&f(e,t,t.refetchOnMount)}function f(e,t,n){if(!1!==(0,s.Nc)(t.enabled,e)){let r="function"==typeof n?n(e):n;return"always"===r||!1!==r&&h(e,t)}return!1}function p(e,t,n,r){return(e!==t||!1===(0,s.Nc)(r.enabled,e))&&(!n.suspense||"error"!==e.state.status)&&h(e,n)}function h(e,t){return!1!==(0,s.Nc)(t.enabled,e)&&e.isStaleByTime((0,s.KC)(t.staleTime,e))}var m=n(2265),g=n(29827);n(57437);var v=m.createContext((r=!1,{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r})),b=()=>m.useContext(v),y=n(51172),x=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&!t.isReset()&&(e.retryOnMount=!1)},w=e=>{m.useEffect(()=>{e.clearReset()},[e])},S=e=>{let{result:t,errorResetBoundary:n,throwOnError:r,query:o}=e;return t.isError&&!n.isReset()&&!t.isFetching&&o&&(0,y.L)(r,[t.error,o])},k=m.createContext(!1),E=()=>m.useContext(k);k.Provider;var C=e=>{let t=e.staleTime;e.suspense&&(e.staleTime="function"==typeof t?(...e)=>Math.max(t(...e),1e3):Math.max(t??1e3,1e3),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3)))},O=(e,t)=>e.isLoading&&e.isFetching&&!t,j=(e,t)=>e?.suspense&&t.isPending,P=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function _(e,t){return function(e,t,n){var r,o,a,l,c;let u=(0,g.NL)(n),d=E(),f=b(),p=u.defaultQueryOptions(e);null===(o=u.getDefaultOptions().queries)||void 0===o||null===(r=o._experimental_beforeQuery)||void 0===r||r.call(o,p),p._optimisticResults=d?"isRestoring":"optimistic",C(p),x(p,f),w(f);let h=!u.getQueryCache().get(p.queryHash),[v]=m.useState(()=>new t(u,p)),k=v.getOptimisticResult(p),_=!d&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback(e=>{let t=_?v.subscribe(i.V.batchCalls(e)):y.Z;return v.updateResult(),t},[v,_]),()=>v.getCurrentResult(),()=>v.getCurrentResult()),m.useEffect(()=>{v.setOptions(p,{listeners:!1})},[p,v]),j(p,k))throw P(p,v,f);if(S({result:k,errorResetBoundary:f,throwOnError:p.throwOnError,query:u.getQueryCache().get(p.queryHash)}))throw k.error;if(null===(l=u.getDefaultOptions().queries)||void 0===l||null===(a=l._experimental_afterQuery)||void 0===a||a.call(l,p,k),p.experimental_prefetchInRender&&!s.sk&&O(k,d)){let e=h?P(p,v,f):null===(c=u.getQueryCache().get(p.queryHash))||void 0===c?void 0:c.promise;null==e||e.catch(y.Z).finally(()=>{v.updateResult()})}return p.notifyOnChangeProps?k:v.trackResult(k)}(e,u,t)}},51172:function(e,t,n){"use strict";function r(e,t){return"function"==typeof e?e(...t):!!e}function o(){}n.d(t,{L:function(){return r},Z:function(){return o}})},71594:function(e,t,n){"use strict";n.d(t,{b7:function(){return a},ie:function(){return i}});var r=n(2265),o=n(24525);function i(e,t){return e?"function"==typeof e&&(()=>{let t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()||"function"==typeof e||"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)?r.createElement(e,t):e:null}function a(e){let t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[n]=r.useState(()=>({current:(0,o.W_)(t)})),[i,a]=r.useState(()=>n.current.initialState);return n.current.setOptions(t=>({...t,...e,state:{...i,...e.state},onStateChange:t=>{a(t),null==e.onStateChange||e.onStateChange(t)}})),n.current}},24525:function(e,t,n){"use strict";function r(e,t){return"function"==typeof e?e(t):e}function o(e,t){return n=>{t.setState(t=>({...t,[e]:r(n,t[e])}))}}function i(e){return e instanceof Function}function a(e,t,n){let r,o=[];return i=>{let a,l;n.key&&n.debug&&(a=Date.now());let c=e(i);if(!(c.length!==o.length||c.some((e,t)=>o[t]!==e)))return r;if(o=c,n.key&&n.debug&&(l=Date.now()),r=t(...c),null==n||null==n.onChange||n.onChange(r),n.key&&n.debug&&null!=n&&n.debug()){let e=Math.round((Date.now()-a)*100)/100,t=Math.round((Date.now()-l)*100)/100,r=t/16,o=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c ${o(t,5)} /${o(e,5)} ms`,`
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/oai_misc_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/pass_through_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/pass_through_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/pass_through_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/pass_through_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm/proxy/example_config_yaml/pass_through_config.yaml:      api_key: os.environ/ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/litellm-1.73.1.dist-info/METADATA:os.environ["ANTHROPIC_API_KEY"] = "your-anthropic-key"
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/main.py:        os.environ["ANTHROPIC_API_KEY"] = args.anthropic_api_key
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/models.py:            anthropic="ANTHROPIC_API_KEY",
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/models.py:            var = "ANTHROPIC_API_KEY"
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/onboarding.py:        ("ANTHROPIC_API_KEY", "sonnet"),
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/llms/anthropic.md:either in the `ANTHROPIC_API_KEY` environment variable or
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/llms/anthropic.md:export ANTHROPIC_API_KEY=<key> # Mac/Linux
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/llms/anthropic.md:setx   ANTHROPIC_API_KEY <key> # Windows, restart shell after setx
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/llms/other.md:- ANTHROPIC_API_KEY
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/config/options.md:Environment variable: `AIDER_ANTHROPIC_API_KEY`  
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/config/dotenv.md:#ANTHROPIC_API_KEY=
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/config/dotenv.md:#AIDER_ANTHROPIC_API_KEY=
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/website/docs/config/api-keys.md:ANTHROPIC_API_KEY=<key>
/usr/share/aider-chat/tool/aider-chat/lib/python3.12/site-packages/aider/args_formatter.py:#ANTHROPIC_API_KEY=
/usr/lib/node_modules/task-master-ai/src/utils/create-mcp-config.js:				ANTHROPIC_API_KEY: 'ANTHROPIC_API_KEY_HERE',
/usr/lib/node_modules/task-master-ai/scripts/modules/ai-services-unified.js:		anthropic: 'ANTHROPIC_API_KEY',
/usr/lib/node_modules/task-master-ai/scripts/modules/task-manager/update-subtask-by-id.js:			if (error.message?.includes('ANTHROPIC_API_KEY')) {
/usr/lib/node_modules/task-master-ai/scripts/modules/task-manager/update-subtask-by-id.js:				console.log('  export ANTHROPIC_API_KEY=your_api_key_here');
/usr/lib/node_modules/task-master-ai/scripts/modules/config-manager.js:		anthropic: 'ANTHROPIC_API_KEY',
/usr/lib/node_modules/task-master-ai/scripts/modules/config-manager.js:				apiKeyToCheck = mcpEnv.ANTHROPIC_API_KEY;
/usr/lib/node_modules/task-master-ai/scripts/modules/config-manager.js:				placeholderValue = 'YOUR_ANTHROPIC_API_KEY_HERE';
/usr/lib/node_modules/task-master-ai/scripts/modules/ui.js:			`${chalk.white('API keys for AI providers (ANTHROPIC_API_KEY, etc.)')}${chalk.reset('')}`,
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.mjs.map:{"version":3,"sources":["../src/anthropic-provider.ts","../src/anthropic-messages-language-model.ts","../src/anthropic-error.ts","../src/anthropic-prepare-tools.ts","../src/convert-to-anthropic-messages-prompt.ts","../src/map-anthropic-stop-reason.ts","../src/anthropic-tools.ts"],"sourcesContent":["import {\n  LanguageModelV1,\n  NoSuchModelError,\n  ProviderV1,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  loadApiKey,\n  withoutTrailingSlash,\n} from '@ai-sdk/provider-utils';\nimport { AnthropicMessagesLanguageModel } from './anthropic-messages-language-model';\nimport {\n  AnthropicMessagesModelId,\n  AnthropicMessagesSettings,\n} from './anthropic-messages-settings';\nimport { anthropicTools } from './anthropic-tools';\n\nexport interface AnthropicProvider extends ProviderV1 {\n  /**\nCreates a model for text generation.\n*/\n  (\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates a model for text generation.\n*/\n  languageModel(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\n@deprecated Use `.languageModel()` instead.\n*/\n  chat(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\n@deprecated Use `.languageModel()` instead.\n   */\n  messages(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\nAnthropic-specific computer use tool.\n   */\n  tools: typeof anthropicTools;\n}\n\nexport interface AnthropicProviderSettings {\n  /**\nUse a different URL prefix for API calls, e.g. to use proxy servers.\nThe default prefix is `https://api.anthropic.com/v1`.\n   */\n  baseURL?: string;\n\n  /**\nAPI key that is being send using the `x-api-key` header.\nIt defaults to the `ANTHROPIC_API_KEY` environment variable.\n   */\n  apiKey?: string;\n\n  /**\nCustom headers to include in the requests.\n     */\n  headers?: Record<string, string>;\n\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n    */\n  fetch?: FetchFunction;\n\n  generateId?: () => string;\n}\n\n/**\nCreate an Anthropic provider instance.\n */\nexport function createAnthropic(\n  options: AnthropicProviderSettings = {},\n): AnthropicProvider {\n  const baseURL =\n    withoutTrailingSlash(options.baseURL) ?? 'https://api.anthropic.com/v1';\n\n  const getHeaders = () => ({\n    'anthropic-version': '2023-06-01',\n    'x-api-key': loadApiKey({\n      apiKey: options.apiKey,\n      environmentVariableName: 'ANTHROPIC_API_KEY',\n      description: 'Anthropic',\n    }),\n    ...options.headers,\n  });\n\n  const createChatModel = (\n    modelId: AnthropicMessagesModelId,\n    settings: AnthropicMessagesSettings = {},\n  ) =>\n    new AnthropicMessagesLanguageModel(modelId, settings, {\n      provider: 'anthropic.messages',\n      baseURL,\n      headers: getHeaders,\n      fetch: options.fetch,\n      supportsImageUrls: true,\n    });\n\n  const provider = function (\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ) {\n    if (new.target) {\n      throw new Error(\n        'The Anthropic model function cannot be called with the new keyword.',\n      );\n    }\n\n    return createChatModel(modelId, settings);\n  };\n\n  provider.languageModel = createChatModel;\n  provider.chat = createChatModel;\n  provider.messages = createChatModel;\n  provider.textEmbeddingModel = (modelId: string) => {\n    throw new NoSuchModelError({ modelId, modelType: 'textEmbeddingModel' });\n  };\n\n  provider.tools = anthropicTools;\n\n  return provider;\n}\n\n/**\nDefault Anthropic provider instance.\n */\nexport const anthropic = createAnthropic();\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1FunctionToolCall,\n  LanguageModelV1ProviderMetadata,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  Resolvable,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  parseProviderOptions,\n  postJsonToApi,\n  resolve,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { anthropicFailedResponseHandler } from './anthropic-error';\nimport {\n  AnthropicMessagesModelId,\n  AnthropicMessagesSettings,\n} from './anthropic-messages-settings';\nimport { prepareTools } from './anthropic-prepare-tools';\nimport { convertToAnthropicMessagesPrompt } from './convert-to-anthropic-messages-prompt';\nimport { mapAnthropicStopReason } from './map-anthropic-stop-reason';\n\ntype AnthropicMessagesConfig = {\n  provider: string;\n  baseURL: string;\n  headers: Resolvable<Record<string, string | undefined>>;\n  supportsImageUrls: boolean;\n  fetch?: FetchFunction;\n  buildRequestUrl?: (baseURL: string, isStreaming: boolean) => string;\n  transformRequestBody?: (args: Record<string, any>) => Record<string, any>;\n};\n\nexport class AnthropicMessagesLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n  readonly defaultObjectGenerationMode = 'tool';\n\n  readonly modelId: AnthropicMessagesModelId;\n  readonly settings: AnthropicMessagesSettings;\n\n  private readonly config: AnthropicMessagesConfig;\n\n  constructor(\n    modelId: AnthropicMessagesModelId,\n    settings: AnthropicMessagesSettings,\n    config: AnthropicMessagesConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  supportsUrl(url: URL): boolean {\n    return url.protocol === 'https:';\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get supportsImageUrls(): boolean {\n    return this.config.supportsImageUrls;\n  }\n\n  private async getArgs({\n    mode,\n    prompt,\n    maxTokens = 4096, // 4096: max model output tokens TODO update default in v5\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    providerMetadata: providerOptions,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (frequencyPenalty != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'frequencyPenalty',\n      });\n    }\n\n    if (presencePenalty != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'presencePenalty',\n      });\n    }\n\n    if (seed != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'seed',\n      });\n    }\n\n    if (responseFormat != null && responseFormat.type !== 'text') {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details: 'JSON response format is not supported.',\n      });\n    }\n\n    const { prompt: messagesPrompt, betas: messagesBetas } =\n      convertToAnthropicMessagesPrompt({\n        prompt,\n        sendReasoning: this.settings.sendReasoning ?? true,\n        warnings,\n      });\n\n    const anthropicOptions = parseProviderOptions({\n      provider: 'anthropic',\n      providerOptions,\n      schema: anthropicProviderOptionsSchema,\n    });\n\n    const isThinking = anthropicOptions?.thinking?.type === 'enabled';\n    const thinkingBudget = anthropicOptions?.thinking?.budgetTokens;\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_k: topK,\n      top_p: topP,\n      stop_sequences: stopSequences,\n\n      // provider specific settings:\n      ...(isThinking && {\n        thinking: { type: 'enabled', budget_tokens: thinkingBudget },\n      }),\n\n      // prompt:\n      system: messagesPrompt.system,\n      messages: messagesPrompt.messages,\n    };\n\n    if (isThinking) {\n      if (thinkingBudget == null) {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'thinking requires a budget',\n        });\n      }\n\n      if (baseArgs.temperature != null) {\n        baseArgs.temperature = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'temperature',\n          details: 'temperature is not supported when thinking is enabled',\n        });\n      }\n\n      if (topK != null) {\n        baseArgs.top_k = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'topK',\n          details: 'topK is not supported when thinking is enabled',\n        });\n      }\n\n      if (topP != null) {\n        baseArgs.top_p = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'topP',\n          details: 'topP is not supported when thinking is enabled',\n        });\n      }\n\n      // adjust max tokens to account for thinking:\n      baseArgs.max_tokens = maxTokens + thinkingBudget;\n    }\n\n    switch (type) {\n      case 'regular': {\n        const {\n          tools,\n          tool_choice,\n          toolWarnings,\n          betas: toolsBetas,\n        } = prepareTools(mode);\n\n        return {\n          args: { ...baseArgs, tools, tool_choice },\n          warnings: [...warnings, ...toolWarnings],\n          betas: new Set([...messagesBetas, ...toolsBetas]),\n        };\n      }\n\n      case 'object-json': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'json-mode object generation',\n        });\n      }\n\n      case 'object-tool': {\n        const { name, description, parameters } = mode.tool;\n\n        return {\n          args: {\n            ...baseArgs,\n            tools: [{ name, description, input_schema: parameters }],\n            tool_choice: { type: 'tool', name },\n          },\n          warnings,\n          betas: messagesBetas,\n        };\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  private async getHeaders({\n    betas,\n    headers,\n  }: {\n    betas: Set<string>;\n    headers: Record<string, string | undefined> | undefined;\n  }) {\n    return combineHeaders(\n      await resolve(this.config.headers),\n      betas.size > 0 ? { 'anthropic-beta': Array.from(betas).join(',') } : {},\n      headers,\n    );\n  }\n\n  private buildRequestUrl(isStreaming: boolean): string {\n    return (\n      this.config.buildRequestUrl?.(this.config.baseURL, isStreaming) ??\n      `${this.config.baseURL}/messages`\n    );\n  }\n\n  private transformRequestBody(args: Record<string, any>): Record<string, any> {\n    return this.config.transformRequestBody?.(args) ?? args;\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args, warnings, betas } = await this.getArgs(options);\n\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse,\n    } = await postJsonToApi({\n      url: this.buildRequestUrl(false),\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(args),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        anthropicMessagesResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    // extract text\n    let text = '';\n    for (const content of response.content) {\n      if (content.type === 'text') {\n        text += content.text;\n      }\n    }\n\n    // extract tool calls\n    let toolCalls: LanguageModelV1FunctionToolCall[] | undefined = undefined;\n    if (response.content.some(content => content.type === 'tool_use')) {\n      toolCalls = [];\n      for (const content of response.content) {\n        if (content.type === 'tool_use') {\n          toolCalls.push({\n            toolCallType: 'function',\n            toolCallId: content.id,\n            toolName: content.name,\n            args: JSON.stringify(content.input),\n          });\n        }\n      }\n    }\n\n    const reasoning = response.content\n      .filter(\n        content =>\n          content.type === 'redacted_thinking' || content.type === 'thinking',\n      )\n      .map(content =>\n        content.type === 'thinking'\n          ? {\n              type: 'text' as const,\n              text: content.thinking,\n              signature: content.signature,\n            }\n          : {\n              type: 'redacted' as const,\n              data: content.data,\n            },\n      );\n\n    return {\n      text,\n      reasoning: reasoning.length > 0 ? reasoning : undefined,\n      toolCalls,\n      finishReason: mapAnthropicStopReason(response.stop_reason),\n      usage: {\n        promptTokens: response.usage.input_tokens,\n        completionTokens: response.usage.output_tokens,\n      },\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: {\n        headers: responseHeaders,\n        body: rawResponse,\n      },\n      response: {\n        id: response.id ?? undefined,\n        modelId: response.model ?? undefined,\n      },\n      warnings,\n      providerMetadata: {\n        anthropic: {\n          cacheCreationInputTokens:\n            response.usage.cache_creation_input_tokens ?? null,\n          cacheReadInputTokens: response.usage.cache_read_input_tokens ?? null,\n        },\n      },\n      request: { body: JSON.stringify(args) },\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings, betas } = await this.getArgs(options);\n    const body = { ...args, stream: true };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.buildRequestUrl(true),\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(body),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        anthropicMessagesChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    const usage: { promptTokens: number; completionTokens: number } = {\n      promptTokens: Number.NaN,\n      completionTokens: Number.NaN,\n    };\n\n    const toolCallContentBlocks: Record<\n      number,\n      {\n        toolCallId: string;\n        toolName: string;\n        jsonText: string;\n      }\n    > = {};\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined =\n      undefined;\n\n    let blockType:\n      | 'text'\n      | 'thinking'\n      | 'tool_use'\n      | 'redacted_thinking'\n      | undefined = undefined;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof anthropicMessagesChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            if (!chunk.success) {\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            switch (value.type) {\n              case 'ping': {\n                return; // ignored\n              }\n\n              case 'content_block_start': {\n                const contentBlockType = value.content_block.type;\n\n                blockType = contentBlockType;\n\n                switch (contentBlockType) {\n                  case 'text':\n                  case 'thinking': {\n                    return; // ignored\n                  }\n\n                  case 'redacted_thinking': {\n                    controller.enqueue({\n                      type: 'redacted-reasoning',\n                      data: value.content_block.data,\n                    });\n                    return;\n                  }\n\n                  case 'tool_use': {\n                    toolCallContentBlocks[value.index] = {\n                      toolCallId: value.content_block.id,\n                      toolName: value.content_block.name,\n                      jsonText: '',\n                    };\n                    return;\n                  }\n\n                  default: {\n                    const _exhaustiveCheck: never = contentBlockType;\n                    throw new Error(\n                      `Unsupported content block type: ${_exhaustiveCheck}`,\n                    );\n                  }\n                }\n              }\n\n              case 'content_block_stop': {\n                // when finishing a tool call block, send the full tool call:\n                if (toolCallContentBlocks[value.index] != null) {\n                  const contentBlock = toolCallContentBlocks[value.index];\n\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallType: 'function',\n                    toolCallId: contentBlock.toolCallId,\n                    toolName: contentBlock.toolName,\n                    args: contentBlock.jsonText,\n                  });\n\n                  delete toolCallContentBlocks[value.index];\n                }\n\n                blockType = undefined; // reset block type\n\n                return;\n              }\n\n              case 'content_block_delta': {\n                const deltaType = value.delta.type;\n                switch (deltaType) {\n                  case 'text_delta': {\n                    controller.enqueue({\n                      type: 'text-delta',\n                      textDelta: value.delta.text,\n                    });\n\n                    return;\n                  }\n\n                  case 'thinking_delta': {\n                    controller.enqueue({\n                      type: 'reasoning',\n                      textDelta: value.delta.thinking,\n                    });\n\n                    return;\n                  }\n\n                  case 'signature_delta': {\n                    // signature are only supported on thinking blocks:\n                    if (blockType === 'thinking') {\n                      controller.enqueue({\n                        type: 'reasoning-signature',\n                        signature: value.delta.signature,\n                      });\n                    }\n\n                    return;\n                  }\n\n                  case 'input_json_delta': {\n                    const contentBlock = toolCallContentBlocks[value.index];\n\n                    controller.enqueue({\n                      type: 'tool-call-delta',\n                      toolCallType: 'function',\n                      toolCallId: contentBlock.toolCallId,\n                      toolName: contentBlock.toolName,\n                      argsTextDelta: value.delta.partial_json,\n                    });\n\n                    contentBlock.jsonText += value.delta.partial_json;\n\n                    return;\n                  }\n\n                  default: {\n                    const _exhaustiveCheck: never = deltaType;\n                    throw new Error(\n                      `Unsupported delta type: ${_exhaustiveCheck}`,\n                    );\n                  }\n                }\n              }\n\n              case 'message_start': {\n                usage.promptTokens = value.message.usage.input_tokens;\n                usage.completionTokens = value.message.usage.output_tokens;\n\n                providerMetadata = {\n                  anthropic: {\n                    cacheCreationInputTokens:\n                      value.message.usage.cache_creation_input_tokens ?? null,\n                    cacheReadInputTokens:\n                      value.message.usage.cache_read_input_tokens ?? null,\n                  },\n                };\n\n                controller.enqueue({\n                  type: 'response-metadata',\n                  id: value.message.id ?? undefined,\n                  modelId: value.message.model ?? undefined,\n                });\n\n                return;\n              }\n\n              case 'message_delta': {\n                usage.completionTokens = value.usage.output_tokens;\n                finishReason = mapAnthropicStopReason(value.delta.stop_reason);\n                return;\n              }\n\n              case 'message_stop': {\n                controller.enqueue({\n                  type: 'finish',\n                  finishReason,\n                  usage,\n                  providerMetadata,\n                });\n                return;\n              }\n\n              case 'error': {\n                controller.enqueue({ type: 'error', error: value.error });\n                return;\n              }\n\n              default: {\n                const _exhaustiveCheck: never = value;\n                throw new Error(`Unsupported chunk type: ${_exhaustiveCheck}`);\n              }\n            }\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      warnings,\n      request: { body: JSON.stringify(body) },\n    };\n  }\n}\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst anthropicMessagesResponseSchema = z.object({\n  type: z.literal('message'),\n  id: z.string().nullish(),\n  model: z.string().nullish(),\n  content: z.array(\n    z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('text'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking'),\n        thinking: z.string(),\n        signature: z.string(),\n      }),\n      z.object({\n        type: z.literal('redacted_thinking'),\n        data: z.string(),\n      }),\n      z.object({\n        type: z.literal('tool_use'),\n        id: z.string(),\n        name: z.string(),\n        input: z.unknown(),\n      }),\n    ]),\n  ),\n  stop_reason: z.string().nullish(),\n  usage: z.object({\n    input_tokens: z.number(),\n    output_tokens: z.number(),\n    cache_creation_input_tokens: z.number().nullish(),\n    cache_read_input_tokens: z.number().nullish(),\n  }),\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst anthropicMessagesChunkSchema = z.discriminatedUnion('type', [\n  z.object({\n    type: z.literal('message_start'),\n    message: z.object({\n      id: z.string().nullish(),\n      model: z.string().nullish(),\n      usage: z.object({\n        input_tokens: z.number(),\n        output_tokens: z.number(),\n        cache_creation_input_tokens: z.number().nullish(),\n        cache_read_input_tokens: z.number().nullish(),\n      }),\n    }),\n  }),\n  z.object({\n    type: z.literal('content_block_start'),\n    index: z.number(),\n    content_block: z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('text'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking'),\n        thinking: z.string(),\n      }),\n      z.object({\n        type: z.literal('tool_use'),\n        id: z.string(),\n        name: z.string(),\n      }),\n      z.object({\n        type: z.literal('redacted_thinking'),\n        data: z.string(),\n      }),\n    ]),\n  }),\n  z.object({\n    type: z.literal('content_block_delta'),\n    index: z.number(),\n    delta: z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('input_json_delta'),\n        partial_json: z.string(),\n      }),\n      z.object({\n        type: z.literal('text_delta'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking_delta'),\n        thinking: z.string(),\n      }),\n      z.object({\n        type: z.literal('signature_delta'),\n        signature: z.string(),\n      }),\n    ]),\n  }),\n  z.object({\n    type: z.literal('content_block_stop'),\n    index: z.number(),\n  }),\n  z.object({\n    type: z.literal('error'),\n    error: z.object({\n      type: z.string(),\n      message: z.string(),\n    }),\n  }),\n  z.object({\n    type: z.literal('message_delta'),\n    delta: z.object({ stop_reason: z.string().nullish() }),\n    usage: z.object({ output_tokens: z.number() }),\n  }),\n  z.object({\n    type: z.literal('message_stop'),\n  }),\n  z.object({\n    type: z.literal('ping'),\n  }),\n]);\n\nconst anthropicProviderOptionsSchema = z.object({\n  thinking: z\n    .object({\n      type: z.union([z.literal('enabled'), z.literal('disabled')]),\n      budgetTokens: z.number().optional(),\n    })\n    .optional(),\n});\n\nexport type AnthropicProviderOptions = z.infer<\n  typeof anthropicProviderOptionsSchema\n>;\n","import { createJsonErrorResponseHandler } from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\n\nconst anthropicErrorDataSchema = z.object({\n  type: z.literal('error'),\n  error: z.object({\n    type: z.string(),\n    message: z.string(),\n  }),\n});\n\nexport type AnthropicErrorData = z.infer<typeof anthropicErrorDataSchema>;\n\nexport const anthropicFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: anthropicErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { AnthropicTool, AnthropicToolChoice } from './anthropic-api-types';\n\nexport function prepareTools(\n  mode: Parameters<LanguageModelV1['doGenerate']>[0]['mode'] & {\n    type: 'regular';\n  },\n): {\n  tools: Array<AnthropicTool> | undefined;\n  tool_choice: AnthropicToolChoice | undefined;\n  toolWarnings: LanguageModelV1CallWarning[];\n  betas: Set<string>;\n} {\n  // when the tools array is empty, change it to undefined to prevent errors:\n  const tools = mode.tools?.length ? mode.tools : undefined;\n\n  const toolWarnings: LanguageModelV1CallWarning[] = [];\n  const betas = new Set<string>();\n\n  if (tools == null) {\n    return { tools: undefined, tool_choice: undefined, toolWarnings, betas };\n  }\n\n  const anthropicTools: AnthropicTool[] = [];\n\n  for (const tool of tools) {\n    switch (tool.type) {\n      case 'function':\n        anthropicTools.push({\n          name: tool.name,\n          description: tool.description,\n          input_schema: tool.parameters,\n        });\n        break;\n      case 'provider-defined':\n        switch (tool.id) {\n          case 'anthropic.computer_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'computer_20250124',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n            });\n            break;\n          case 'anthropic.computer_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'computer_20241022',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n            });\n            break;\n          case 'anthropic.text_editor_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'text_editor_20250124',\n            });\n            break;\n          case 'anthropic.text_editor_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'text_editor_20241022',\n            });\n            break;\n          case 'anthropic.bash_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'bash_20250124',\n            });\n            break;\n          case 'anthropic.bash_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'bash_20241022',\n            });\n            break;\n          default:\n            toolWarnings.push({ type: 'unsupported-tool', tool });\n            break;\n        }\n        break;\n      default:\n        toolWarnings.push({ type: 'unsupported-tool', tool });\n        break;\n    }\n  }\n\n  const toolChoice = mode.toolChoice;\n\n  if (toolChoice == null) {\n    return {\n      tools: anthropicTools,\n      tool_choice: undefined,\n      toolWarnings,\n      betas,\n    };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'auto' },\n        toolWarnings,\n        betas,\n      };\n    case 'required':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'any' },\n        toolWarnings,\n        betas,\n      };\n    case 'none':\n      // Anthropic does not support 'none' tool choice, so we remove the tools:\n      return { tools: undefined, tool_choice: undefined, toolWarnings, betas };\n    case 'tool':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'tool', name: toolChoice.toolName },\n        toolWarnings,\n        betas,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `Unsupported tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  LanguageModelV1CallWarning,\n  LanguageModelV1Message,\n  LanguageModelV1Prompt,\n  LanguageModelV1ProviderMetadata,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { convertUint8ArrayToBase64 } from '@ai-sdk/provider-utils';\nimport {\n  AnthropicAssistantMessage,\n  AnthropicCacheControl,\n  AnthropicMessagesPrompt,\n  AnthropicUserMessage,\n} from './anthropic-api-types';\n\nexport function convertToAnthropicMessagesPrompt({\n  prompt,\n  sendReasoning,\n  warnings,\n}: {\n  prompt: LanguageModelV1Prompt;\n  sendReasoning: boolean;\n  warnings: LanguageModelV1CallWarning[];\n}): {\n  prompt: AnthropicMessagesPrompt;\n  betas: Set<string>;\n} {\n  const betas = new Set<string>();\n  const blocks = groupIntoBlocks(prompt);\n\n  let system: AnthropicMessagesPrompt['system'] = undefined;\n  const messages: AnthropicMessagesPrompt['messages'] = [];\n\n  function getCacheControl(\n    providerMetadata: LanguageModelV1ProviderMetadata | undefined,\n  ): AnthropicCacheControl | undefined {\n    const anthropic = providerMetadata?.anthropic;\n\n    // allow both cacheControl and cache_control:\n    const cacheControlValue =\n      anthropic?.cacheControl ?? anthropic?.cache_control;\n\n    // Pass through value assuming it is of the correct type.\n    // The Anthropic API will validate the value.\n    return cacheControlValue as AnthropicCacheControl | undefined;\n  }\n\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    const isLastBlock = i === blocks.length - 1;\n    const type = block.type;\n\n    switch (type) {\n      case 'system': {\n        if (system != null) {\n          throw new UnsupportedFunctionalityError({\n            functionality:\n              'Multiple system messages that are separated by user/assistant messages',\n          });\n        }\n\n        system = block.messages.map(({ content, providerMetadata }) => ({\n          type: 'text',\n          text: content,\n          cache_control: getCacheControl(providerMetadata),\n        }));\n\n        break;\n      }\n\n      case 'user': {\n        // combines all user and tool messages in this block into a single message:\n        const anthropicContent: AnthropicUserMessage['content'] = [];\n\n        for (const message of block.messages) {\n          const { role, content } = message;\n          switch (role) {\n            case 'user': {\n              for (let j = 0; j < content.length; j++) {\n                const part = content[j];\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = j === content.length - 1;\n\n                const cacheControl =\n                  getCacheControl(part.providerMetadata) ??\n                  (isLastPart\n                    ? getCacheControl(message.providerMetadata)\n                    : undefined);\n\n                switch (part.type) {\n                  case 'text': {\n                    anthropicContent.push({\n                      type: 'text',\n                      text: part.text,\n                      cache_control: cacheControl,\n                    });\n                    break;\n                  }\n\n                  case 'image': {\n                    anthropicContent.push({\n                      type: 'image',\n                      source:\n                        part.image instanceof URL\n                          ? {\n                              type: 'url',\n                              url: part.image.toString(),\n                            }\n                          : {\n                              type: 'base64',\n                              media_type: part.mimeType ?? 'image/jpeg',\n                              data: convertUint8ArrayToBase64(part.image),\n                            },\n                      cache_control: cacheControl,\n                    });\n\n                    break;\n                  }\n\n                  case 'file': {\n                    if (part.mimeType !== 'application/pdf') {\n                      throw new UnsupportedFunctionalityError({\n                        functionality: 'Non-PDF files in user messages',\n                      });\n                    }\n\n                    betas.add('pdfs-2024-09-25');\n\n                    anthropicContent.push({\n                      type: 'document',\n                      source:\n                        part.data instanceof URL\n                          ? {\n                              type: 'url',\n                              url: part.data.toString(),\n                            }\n                          : {\n                              type: 'base64',\n                              media_type: 'application/pdf',\n                              data: part.data,\n                            },\n                      cache_control: cacheControl,\n                    });\n\n                    break;\n                  }\n                }\n              }\n\n              break;\n            }\n            case 'tool': {\n              for (let i = 0; i < content.length; i++) {\n                const part = content[i];\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = i === content.length - 1;\n\n                const cacheControl =\n                  getCacheControl(part.providerMetadata) ??\n                  (isLastPart\n                    ? getCacheControl(message.providerMetadata)\n                    : undefined);\n\n                const toolResultContent =\n                  part.content != null\n                    ? part.content.map(part => {\n                        switch (part.type) {\n                          case 'text':\n                            return {\n                              type: 'text' as const,\n                              text: part.text,\n                              cache_control: undefined,\n                            };\n                          case 'image':\n                            return {\n                              type: 'image' as const,\n                              source: {\n                                type: 'base64' as const,\n                                media_type: part.mimeType ?? 'image/jpeg',\n                                data: part.data,\n                              },\n                              cache_control: undefined,\n                            };\n                        }\n                      })\n                    : JSON.stringify(part.result);\n\n                anthropicContent.push({\n                  type: 'tool_result',\n                  tool_use_id: part.toolCallId,\n                  content: toolResultContent,\n                  is_error: part.isError,\n                  cache_control: cacheControl,\n                });\n              }\n\n              break;\n            }\n            default: {\n              const _exhaustiveCheck: never = role;\n              throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n            }\n          }\n        }\n\n        messages.push({ role: 'user', content: anthropicContent });\n\n        break;\n      }\n\n      case 'assistant': {\n        // combines multiple assistant messages in this block into a single message:\n        const anthropicContent: AnthropicAssistantMessage['content'] = [];\n\n        for (let j = 0; j < block.messages.length; j++) {\n          const message = block.messages[j];\n          const isLastMessage = j === block.messages.length - 1;\n          const { content } = message;\n\n          for (let k = 0; k < content.length; k++) {\n            const part = content[k];\n            const isLastContentPart = k === content.length - 1;\n\n            // cache control: first add cache control from part.\n            // for the last part of a message,\n            // check also if the message has cache control.\n            const cacheControl =\n              getCacheControl(part.providerMetadata) ??\n              (isLastContentPart\n                ? getCacheControl(message.providerMetadata)\n                : undefined);\n\n            switch (part.type) {\n              case 'text': {\n                anthropicContent.push({\n                  type: 'text',\n                  text:\n                    // trim the last text part if it's the last message in the block\n                    // because Anthropic does not allow trailing whitespace\n                    // in pre-filled assistant responses\n                    isLastBlock && isLastMessage && isLastContentPart\n                      ? part.text.trim()\n                      : part.text,\n\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'reasoning': {\n                if (sendReasoning) {\n                  anthropicContent.push({\n                    type: 'thinking',\n                    thinking: part.text,\n                    signature: part.signature!,\n                    cache_control: cacheControl,\n                  });\n                } else {\n                  warnings.push({\n                    type: 'other',\n                    message:\n                      'sending reasoning content is disabled for this model',\n                  });\n                }\n                break;\n              }\n\n              case 'redacted-reasoning': {\n                anthropicContent.push({\n                  type: 'redacted_thinking',\n                  data: part.data,\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'tool-call': {\n                anthropicContent.push({\n                  type: 'tool_use',\n                  id: part.toolCallId,\n                  name: part.toolName,\n                  input: part.args,\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n            }\n          }\n        }\n\n        messages.push({ role: 'assistant', content: anthropicContent });\n\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return {\n    prompt: { system, messages },\n    betas,\n  };\n}\n\ntype SystemBlock = {\n  type: 'system';\n  messages: Array<LanguageModelV1Message & { role: 'system' }>;\n};\ntype AssistantBlock = {\n  type: 'assistant';\n  messages: Array<LanguageModelV1Message & { role: 'assistant' }>;\n};\ntype UserBlock = {\n  type: 'user';\n  messages: Array<LanguageModelV1Message & { role: 'user' | 'tool' }>;\n};\n\nfunction groupIntoBlocks(\n  prompt: LanguageModelV1Prompt,\n): Array<SystemBlock | AssistantBlock | UserBlock> {\n  const blocks: Array<SystemBlock | AssistantBlock | UserBlock> = [];\n  let currentBlock: SystemBlock | AssistantBlock | UserBlock | undefined =\n    undefined;\n\n  for (const message of prompt) {\n    const { role } = message;\n    switch (role) {\n      case 'system': {\n        if (currentBlock?.type !== 'system') {\n          currentBlock = { type: 'system', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'assistant': {\n        if (currentBlock?.type !== 'assistant') {\n          currentBlock = { type: 'assistant', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'user': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'tool': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return blocks;\n}\n","import { LanguageModelV1FinishReason } from '@ai-sdk/provider';\n\nexport function mapAnthropicStopReason(\n  finishReason: string | null | undefined,\n): LanguageModelV1FinishReason {\n  switch (finishReason) {\n    case 'end_turn':\n    case 'stop_sequence':\n      return 'stop';\n    case 'tool_use':\n      return 'tool-calls';\n    case 'max_tokens':\n      return 'length';\n    default:\n      return 'unknown';\n  }\n}\n","import { z } from 'zod';\n\n// Copied from ai package\ntype ExecuteFunction<PARAMETERS, RESULT> =\n  | undefined\n  | ((\n      args: PARAMETERS,\n      options: { abortSignal?: AbortSignal },\n    ) => Promise<RESULT>);\n\n// Copied from ai package\nexport type ToolResultContent = Array<\n  | {\n      type: 'text';\n      text: string;\n    }\n  | {\n      type: 'image';\n      data: string; // base64 encoded png image, e.g. screenshot\n      mimeType?: string; // e.g. 'image/png';\n    }\n>;\n\nconst Bash20241022Parameters = z.object({\n  command: z.string(),\n  restart: z.boolean().optional(),\n});\n\n/**\n * Creates a tool for running a bash command. Must have name \"bash\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction bashTool_20241022<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The bash command to run. Required unless the tool is being restarted.\n         */\n        command: string;\n\n        /**\n         * Specifying true will restart this tool. Otherwise, leave this unspecified.\n         */\n        restart?: boolean;\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.bash_20241022';\n  args: {};\n  parameters: typeof Bash20241022Parameters;\n  execute: ExecuteFunction<z.infer<typeof Bash20241022Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.bash_20241022',\n    args: {},\n    parameters: Bash20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Bash20250124Parameters = z.object({\n  command: z.string(),\n  restart: z.boolean().optional(),\n});\n\n/**\n * Creates a tool for running a bash command. Must have name \"bash\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction bashTool_20250124<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The bash command to run. Required unless the tool is being restarted.\n         */\n        command: string;\n\n        /**\n         * Specifying true will restart this tool. Otherwise, leave this unspecified.\n         */\n        restart?: boolean;\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.bash_20250124';\n  args: {};\n  parameters: typeof Bash20250124Parameters;\n  execute: ExecuteFunction<z.infer<typeof Bash20250124Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.bash_20250124',\n    args: {},\n    parameters: Bash20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst TextEditor20241022Parameters = z.object({\n  command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n  path: z.string(),\n  file_text: z.string().optional(),\n  insert_line: z.number().int().optional(),\n  new_str: z.string().optional(),\n  old_str: z.string().optional(),\n  view_range: z.array(z.number().int()).optional(),\n});\n\n/**\n * Creates a tool for editing text. Must have name \"str_replace_editor\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction textEditorTool_20241022<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n         */\n        command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n        /**\n         * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n         */\n        path: string;\n\n        /**\n         * Required parameter of `create` command, with the content of the file to be created.\n         */\n        file_text?: string;\n\n        /**\n         * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n         */\n        insert_line?: number;\n\n        /**\n         * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n         */\n        new_str?: string;\n\n        /**\n         * Required parameter of `str_replace` command containing the string in `path` to replace.\n         */\n        old_str?: string;\n\n        /**\n         * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n         */\n        view_range?: number[];\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.text_editor_20241022';\n  args: {};\n  parameters: typeof TextEditor20241022Parameters;\n  execute: ExecuteFunction<\n    z.infer<typeof TextEditor20241022Parameters>,\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.text_editor_20241022',\n    args: {},\n    parameters: TextEditor20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst TextEditor20250124Parameters = z.object({\n  command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n  path: z.string(),\n  file_text: z.string().optional(),\n  insert_line: z.number().int().optional(),\n  new_str: z.string().optional(),\n  old_str: z.string().optional(),\n  view_range: z.array(z.number().int()).optional(),\n});\n\n/**\n * Creates a tool for editing text. Must have name \"str_replace_editor\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction textEditorTool_20250124<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n         */\n        command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n        /**\n         * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n         */\n        path: string;\n\n        /**\n         * Required parameter of `create` command, with the content of the file to be created.\n         */\n        file_text?: string;\n\n        /**\n         * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n         */\n        insert_line?: number;\n\n        /**\n         * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n         */\n        new_str?: string;\n\n        /**\n         * Required parameter of `str_replace` command containing the string in `path` to replace.\n         */\n        old_str?: string;\n\n        /**\n         * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n         */\n        view_range?: number[];\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.text_editor_20250124';\n  args: {};\n  parameters: typeof TextEditor20250124Parameters;\n  execute: ExecuteFunction<\n    z.infer<typeof TextEditor20250124Parameters>,\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.text_editor_20250124',\n    args: {},\n    parameters: TextEditor20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Computer20241022Parameters = z.object({\n  action: z.enum([\n    'key',\n    'type',\n    'mouse_move',\n    'left_click',\n    'left_click_drag',\n    'right_click',\n    'middle_click',\n    'double_click',\n    'screenshot',\n    'cursor_position',\n  ]),\n  coordinate: z.array(z.number().int()).optional(),\n  text: z.string().optional(),\n});\n\n/**\n * Creates a tool for executing actions on a computer. Must have name \"computer\".\n *\n * Image results are supported.\n *\n * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n * @param execute - The function to execute the tool. Optional.\n */\nfunction computerTool_20241022<RESULT>(options: {\n  displayWidthPx: number;\n  displayHeightPx: number;\n  displayNumber?: number;\n  execute?: ExecuteFunction<\n    {\n      /**\n       * The action to perform. The available actions are:\n       * - `key`: Press a key or key-combination on the keyboard.\n       *   - This supports xdotool's `key` syntax.\n       *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n       * - `type`: Type a string of text on the keyboard.\n       * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n       * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `left_click`: Click the left mouse button.\n       * - `left_click_drag`: Click and drag the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `right_click`: Click the right mouse button.\n       * - `middle_click`: Click the middle mouse button.\n       * - `double_click`: Double-click the left mouse button.\n       * - `screenshot`: Take a screenshot of the screen.\n       */\n      action:\n        | 'key'\n        | 'type'\n        | 'mouse_move'\n        | 'left_click'\n        | 'left_click_drag'\n        | 'right_click'\n        | 'middle_click'\n        | 'double_click'\n        | 'screenshot'\n        | 'cursor_position';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n       */\n      coordinate?: number[];\n\n      /**\n       * Required only by `action=type` and `action=key`.\n       */\n      text?: string;\n    },\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n}): {\n  type: 'provider-defined';\n  id: 'anthropic.computer_20241022';\n  args: {};\n  parameters: typeof Computer20241022Parameters;\n  execute: ExecuteFunction<z.infer<typeof Computer20241022Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.computer_20241022',\n    args: {\n      displayWidthPx: options.displayWidthPx,\n      displayHeightPx: options.displayHeightPx,\n      displayNumber: options.displayNumber,\n    },\n    parameters: Computer20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Computer20250124Parameters = z.object({\n  action: z.enum([\n    'key',\n    'hold_key',\n    'type',\n    'cursor_position',\n    'mouse_move',\n    'left_mouse_down',\n    'left_mouse_up',\n    'left_click',\n    'left_click_drag',\n    'right_click',\n    'middle_click',\n    'double_click',\n    'triple_click',\n    'scroll',\n    'wait',\n    'screenshot',\n  ]),\n  coordinate: z.tuple([z.number().int(), z.number().int()]).optional(),\n  duration: z.number().optional(),\n  scroll_amount: z.number().optional(),\n  scroll_direction: z.enum(['up', 'down', 'left', 'right']).optional(),\n  start_coordinate: z.tuple([z.number().int(), z.number().int()]).optional(),\n  text: z.string().optional(),\n});\n\n/**\n * Creates a tool for executing actions on a computer. Must have name \"computer\".\n *\n * Image results are supported.\n *\n * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n * @param execute - The function to execute the tool. Optional.\n */\nfunction computerTool_20250124<RESULT>(options: {\n  displayWidthPx: number;\n  displayHeightPx: number;\n  displayNumber?: number;\n  execute?: ExecuteFunction<\n    {\n      /**\n       * - `key`: Press a key or key-combination on the keyboard.\n       *   - This supports xdotool's `key` syntax.\n       *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n       * - `hold_key`: Hold down a key or multiple keys for a specified duration (in seconds). Supports the same syntax as `key`.\n       * - `type`: Type a string of text on the keyboard.\n       * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n       * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `left_mouse_down`: Press the left mouse button.\n       * - `left_mouse_up`: Release the left mouse button.\n       * - `left_click`: Click the left mouse button at the specified (x, y) pixel coordinate on the screen. You can also include a key combination to hold down while clicking using the `text` parameter.\n       * - `left_click_drag`: Click and drag the cursor from `start_coordinate` to a specified (x, y) pixel coordinate on the screen.\n       * - `right_click`: Click the right mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `middle_click`: Click the middle mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `double_click`: Double-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `triple_click`: Triple-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `scroll`: Scroll the screen in a specified direction by a specified amount of clicks of the scroll wheel, at the specified (x, y) pixel coordinate. DO NOT use PageUp/PageDown to scroll.\n       * - `wait`: Wait for a specified duration (in seconds).\n       * - `screenshot`: Take a screenshot of the screen.\n       */\n      action:\n        | 'key'\n        | 'hold_key'\n        | 'type'\n        | 'cursor_position'\n        | 'mouse_move'\n        | 'left_mouse_down'\n        | 'left_mouse_up'\n        | 'left_click'\n        | 'left_click_drag'\n        | 'right_click'\n        | 'middle_click'\n        | 'double_click'\n        | 'triple_click'\n        | 'scroll'\n        | 'wait'\n        | 'screenshot';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n       */\n      coordinate?: [number, number];\n\n      /**\n       * The duration to hold the key down for. Required only by `action=hold_key` and `action=wait`.\n       */\n      duration?: number;\n\n      /**\n       * The number of 'clicks' to scroll. Required only by `action=scroll`.\n       */\n      scroll_amount?: number;\n\n      /**\n       * The direction to scroll the screen. Required only by `action=scroll`.\n       */\n      scroll_direction?: 'up' | 'down' | 'left' | 'right';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to start the drag from. Required only by `action=left_click_drag`.\n       */\n      start_coordinate?: [number, number];\n\n      /**\n       * Required only by `action=type`, `action=key`, and `action=hold_key`. Can also be used by click or scroll actions to hold down keys while clicking or scrolling.\n       */\n      text?: string;\n    },\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n}): {\n  type: 'provider-defined';\n  id: 'anthropic.computer_20250124';\n  args: {};\n  parameters: typeof Computer20250124Parameters;\n  execute: ExecuteFunction<z.infer<typeof Computer20250124Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.computer_20250124',\n    args: {\n      displayWidthPx: options.displayWidthPx,\n      displayHeightPx: options.displayHeightPx,\n      displayNumber: options.displayNumber,\n    },\n    parameters: Computer20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nexport const anthropicTools = {\n  bash_20241022: bashTool_20241022,\n  bash_20250124: bashTool_20250124,\n  textEditor_20241022: textEditorTool_20241022,\n  textEditor_20250124: textEditorTool_20250124,\n  computer_20241022: computerTool_20241022,\n  computer_20250124: computerTool_20250124,\n};\n"],"mappings":";AAAA;AAAA,EAEE;AAAA,OAEK;AACP;AAAA,EAEE;AAAA,EACA;AAAA,OACK;;;ACTP;AAAA,EAOE,iCAAAA;AAAA,OACK;AACP;AAAA,EAIE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACK;AACP,SAAS,KAAAC,UAAS;;;ACpBlB,SAAS,sCAAsC;AAC/C,SAAS,SAAS;AAElB,IAAM,2BAA2B,EAAE,OAAO;AAAA,EACxC,MAAM,EAAE,QAAQ,OAAO;AAAA,EACvB,OAAO,EAAE,OAAO;AAAA,IACd,MAAM,EAAE,OAAO;AAAA,IACf,SAAS,EAAE,OAAO;AAAA,EACpB,CAAC;AACH,CAAC;AAIM,IAAM,iCAAiC,+BAA+B;AAAA,EAC3E,aAAa;AAAA,EACb,gBAAgB,UAAQ,KAAK,MAAM;AACrC,CAAC;;;AChBD;AAAA,EAGE;AAAA,OACK;AAGA,SAAS,aACd,MAQA;AAhBF;AAkBE,QAAM,UAAQ,UAAK,UAAL,mBAAY,UAAS,KAAK,QAAQ;AAEhD,QAAM,eAA6C,CAAC;AACpD,QAAM,QAAQ,oBAAI,IAAY;AAE9B,MAAI,SAAS,MAAM;AACjB,WAAO,EAAE,OAAO,QAAW,aAAa,QAAW,cAAc,MAAM;AAAA,EACzE;AAEA,QAAMC,kBAAkC,CAAC;AAEzC,aAAW,QAAQ,OAAO;AACxB,YAAQ,KAAK,MAAM;AAAA,MACjB,KAAK;AACH,QAAAA,gBAAe,KAAK;AAAA,UAClB,MAAM,KAAK;AAAA,UACX,aAAa,KAAK;AAAA,UAClB,cAAc,KAAK;AAAA,QACrB,CAAC;AACD;AAAA,MACF,KAAK;AACH,gBAAQ,KAAK,IAAI;AAAA,UACf,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,cACN,kBAAkB,KAAK,KAAK;AAAA,cAC5B,mBAAmB,KAAK,KAAK;AAAA,cAC7B,gBAAgB,KAAK,KAAK;AAAA,YAC5B,CAAC;AACD;AAAA,UACF,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,cACN,kBAAkB,KAAK,KAAK;AAAA,cAC5B,mBAAmB,KAAK,KAAK;AAAA,cAC7B,gBAAgB,KAAK,KAAK;AAAA,YAC5B,CAAC;AACD;AAAA,UACF,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,YACR,CAAC;AACD;AAAA,UACF,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,YACR,CAAC;AACD;AAAA,UACF,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,YACR,CAAC;AACD;AAAA,UACF,KAAK;AACH,kBAAM,IAAI,yBAAyB;AACnC,YAAAA,gBAAe,KAAK;AAAA,cAClB,MAAM,KAAK;AAAA,cACX,MAAM;AAAA,YACR,CAAC;AACD;AAAA,UACF;AACE,yBAAa,KAAK,EAAE,MAAM,oBAAoB,KAAK,CAAC;AACpD;AAAA,QACJ;AACA;AAAA,MACF;AACE,qBAAa,KAAK,EAAE,MAAM,oBAAoB,KAAK,CAAC;AACpD;AAAA,IACJ;AAAA,EACF;AAEA,QAAM,aAAa,KAAK;AAExB,MAAI,cAAc,MAAM;AACtB,WAAO;AAAA,MACL,OAAOA;AAAA,MACP,aAAa;AAAA,MACb;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAEA,QAAM,OAAO,WAAW;AAExB,UAAQ,MAAM;AAAA,IACZ,KAAK;AACH,aAAO;AAAA,QACL,OAAOA;AAAA,QACP,aAAa,EAAE,MAAM,OAAO;AAAA,QAC5B;AAAA,QACA;AAAA,MACF;AAAA,IACF,KAAK;AACH,aAAO;AAAA,QACL,OAAOA;AAAA,QACP,aAAa,EAAE,MAAM,MAAM;AAAA,QAC3B;AAAA,QACA;AAAA,MACF;AAAA,IACF,KAAK;AAEH,aAAO,EAAE,OAAO,QAAW,aAAa,QAAW,cAAc,MAAM;AAAA,IACzE,KAAK;AACH,aAAO;AAAA,QACL,OAAOA;AAAA,QACP,aAAa,EAAE,MAAM,QAAQ,MAAM,WAAW,SAAS;AAAA,QACvD;AAAA,QACA;AAAA,MACF;AAAA,IACF,SAAS;AACP,YAAM,mBAA0B;AAChC,YAAM,IAAI,8BAA8B;AAAA,QACtC,eAAe,iCAAiC,gBAAgB;AAAA,MAClE,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;AChJA;AAAA,EAKE,iCAAAC;AAAA,OACK;AACP,SAAS,iCAAiC;AAQnC,SAAS,iCAAiC;AAAA,EAC/C;AAAA,EACA;AAAA,EACA;AACF,GAOE;AA1BF;AA2BE,QAAM,QAAQ,oBAAI,IAAY;AAC9B,QAAM,SAAS,gBAAgB,MAAM;AAErC,MAAI,SAA4C;AAChD,QAAM,WAAgD,CAAC;AAEvD,WAAS,gBACP,kBACmC;AAnCvC,QAAAC;AAoCI,UAAMC,aAAY,qDAAkB;AAGpC,UAAM,qBACJD,MAAAC,cAAA,gBAAAA,WAAW,iBAAX,OAAAD,MAA2BC,cAAA,gBAAAA,WAAW;AAIxC,WAAO;AAAA,EACT;AAEA,WAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,UAAM,QAAQ,OAAO,CAAC;AACtB,UAAM,cAAc,MAAM,OAAO,SAAS;AAC1C,UAAM,OAAO,MAAM;AAEnB,YAAQ,MAAM;AAAA,MACZ,KAAK,UAAU;AACb,YAAI,UAAU,MAAM;AAClB,gBAAM,IAAIF,+BAA8B;AAAA,YACtC,eACE;AAAA,UACJ,CAAC;AAAA,QACH;AAEA,iBAAS,MAAM,SAAS,IAAI,CAAC,EAAE,SAAS,iBAAiB,OAAO;AAAA,UAC9D,MAAM;AAAA,UACN,MAAM;AAAA,UACN,eAAe,gBAAgB,gBAAgB;AAAA,QACjD,EAAE;AAEF;AAAA,MACF;AAAA,MAEA,KAAK,QAAQ;AAEX,cAAM,mBAAoD,CAAC;AAE3D,mBAAW,WAAW,MAAM,UAAU;AACpC,gBAAM,EAAE,MAAM,QAAQ,IAAI;AAC1B,kBAAQ,MAAM;AAAA,YACZ,KAAK,QAAQ;AACX,uBAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACvC,sBAAM,OAAO,QAAQ,CAAC;AAKtB,sBAAM,aAAa,MAAM,QAAQ,SAAS;AAE1C,sBAAM,gBACJ,qBAAgB,KAAK,gBAAgB,MAArC,YACC,aACG,gBAAgB,QAAQ,gBAAgB,IACxC;AAEN,wBAAQ,KAAK,MAAM;AAAA,kBACjB,KAAK,QAAQ;AACX,qCAAiB,KAAK;AAAA,sBACpB,MAAM;AAAA,sBACN,MAAM,KAAK;AAAA,sBACX,eAAe;AAAA,oBACjB,CAAC;AACD;AAAA,kBACF;AAAA,kBAEA,KAAK,SAAS;AACZ,qCAAiB,KAAK;AAAA,sBACpB,MAAM;AAAA,sBACN,QACE,KAAK,iBAAiB,MAClB;AAAA,wBACE,MAAM;AAAA,wBACN,KAAK,KAAK,MAAM,SAAS;AAAA,sBAC3B,IACA;AAAA,wBACE,MAAM;AAAA,wBACN,aAAY,UAAK,aAAL,YAAiB;AAAA,wBAC7B,MAAM,0BAA0B,KAAK,KAAK;AAAA,sBAC5C;AAAA,sBACN,eAAe;AAAA,oBACjB,CAAC;AAED;AAAA,kBACF;AAAA,kBAEA,KAAK,QAAQ;AACX,wBAAI,KAAK,aAAa,mBAAmB;AACvC,4BAAM,IAAIA,+BAA8B;AAAA,wBACtC,eAAe;AAAA,sBACjB,CAAC;AAAA,oBACH;AAEA,0BAAM,IAAI,iBAAiB;AAE3B,qCAAiB,KAAK;AAAA,sBACpB,MAAM;AAAA,sBACN,QACE,KAAK,gBAAgB,MACjB;AAAA,wBACE,MAAM;AAAA,wBACN,KAAK,KAAK,KAAK,SAAS;AAAA,sBAC1B,IACA;AAAA,wBACE,MAAM;AAAA,wBACN,YAAY;AAAA,wBACZ,MAAM,KAAK;AAAA,sBACb;AAAA,sBACN,eAAe;AAAA,oBACjB,CAAC;AAED;AAAA,kBACF;AAAA,gBACF;AAAA,cACF;AAEA;AAAA,YACF;AAAA,YACA,KAAK,QAAQ;AACX,uBAASG,KAAI,GAAGA,KAAI,QAAQ,QAAQA,MAAK;AACvC,sBAAM,OAAO,QAAQA,EAAC;AAKtB,sBAAM,aAAaA,OAAM,QAAQ,SAAS;AAE1C,sBAAM,gBACJ,qBAAgB,KAAK,gBAAgB,MAArC,YACC,aACG,gBAAgB,QAAQ,gBAAgB,IACxC;AAEN,sBAAM,oBACJ,KAAK,WAAW,OACZ,KAAK,QAAQ,IAAI,CAAAC,UAAQ;AA3K/C,sBAAAH;AA4KwB,0BAAQG,MAAK,MAAM;AAAA,oBACjB,KAAK;AACH,6BAAO;AAAA,wBACL,MAAM;AAAA,wBACN,MAAMA,MAAK;AAAA,wBACX,eAAe;AAAA,sBACjB;AAAA,oBACF,KAAK;AACH,6BAAO;AAAA,wBACL,MAAM;AAAA,wBACN,QAAQ;AAAA,0BACN,MAAM;AAAA,0BACN,aAAYH,MAAAG,MAAK,aAAL,OAAAH,MAAiB;AAAA,0BAC7B,MAAMG,MAAK;AAAA,wBACb;AAAA,wBACA,eAAe;AAAA,sBACjB;AAAA,kBACJ;AAAA,gBACF,CAAC,IACD,KAAK,UAAU,KAAK,MAAM;AAEhC,iCAAiB,KAAK;AAAA,kBACpB,MAAM;AAAA,kBACN,aAAa,KAAK;AAAA,kBAClB,SAAS;AAAA,kBACT,UAAU,KAAK;AAAA,kBACf,eAAe;AAAA,gBACjB,CAAC;AAAA,cACH;AAEA;AAAA,YACF;AAAA,YACA,SAAS;AACP,oBAAM,mBAA0B;AAChC,oBAAM,IAAI,MAAM,qBAAqB,gBAAgB,EAAE;AAAA,YACzD;AAAA,UACF;AAAA,QACF;AAEA,iBAAS,KAAK,EAAE,MAAM,QAAQ,SAAS,iBAAiB,CAAC;AAEzD;AAAA,MACF;AAAA,MAEA,KAAK,aAAa;AAEhB,cAAM,mBAAyD,CAAC;AAEhE,iBAAS,IAAI,GAAG,IAAI,MAAM,SAAS,QAAQ,KAAK;AAC9C,gBAAM,UAAU,MAAM,SAAS,CAAC;AAChC,gBAAM,gBAAgB,MAAM,MAAM,SAAS,SAAS;AACpD,gBAAM,EAAE,QAAQ,IAAI;AAEpB,mBAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACvC,kBAAM,OAAO,QAAQ,CAAC;AACtB,kBAAM,oBAAoB,MAAM,QAAQ,SAAS;AAKjD,kBAAM,gBACJ,qBAAgB,KAAK,gBAAgB,MAArC,YACC,oBACG,gBAAgB,QAAQ,gBAAgB,IACxC;AAEN,oBAAQ,KAAK,MAAM;AAAA,cACjB,KAAK,QAAQ;AACX,iCAAiB,KAAK;AAAA,kBACpB,MAAM;AAAA,kBACN;AAAA;AAAA;AAAA;AAAA,oBAIE,eAAe,iBAAiB,oBAC5B,KAAK,KAAK,KAAK,IACf,KAAK;AAAA;AAAA,kBAEX,eAAe;AAAA,gBACjB,CAAC;AACD;AAAA,cACF;AAAA,cAEA,KAAK,aAAa;AAChB,oBAAI,eAAe;AACjB,mCAAiB,KAAK;AAAA,oBACpB,MAAM;AAAA,oBACN,UAAU,KAAK;AAAA,oBACf,WAAW,KAAK;AAAA,oBAChB,eAAe;AAAA,kBACjB,CAAC;AAAA,gBACH,OAAO;AACL,2BAAS,KAAK;AAAA,oBACZ,MAAM;AAAA,oBACN,SACE;AAAA,kBACJ,CAAC;AAAA,gBACH;AACA;AAAA,cACF;AAAA,cAEA,KAAK,sBAAsB;AACzB,iCAAiB,KAAK;AAAA,kBACpB,MAAM;AAAA,kBACN,MAAM,KAAK;AAAA,kBACX,eAAe;AAAA,gBACjB,CAAC;AACD;AAAA,cACF;AAAA,cAEA,KAAK,aAAa;AAChB,iCAAiB,KAAK;AAAA,kBACpB,MAAM;AAAA,kBACN,IAAI,KAAK;AAAA,kBACT,MAAM,KAAK;AAAA,kBACX,OAAO,KAAK;AAAA,kBACZ,eAAe;AAAA,gBACjB,CAAC;AACD;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAEA,iBAAS,KAAK,EAAE,MAAM,aAAa,SAAS,iBAAiB,CAAC;AAE9D;AAAA,MACF;AAAA,MAEA,SAAS;AACP,cAAM,mBAA0B;AAChC,cAAM,IAAI,MAAM,qBAAqB,gBAAgB,EAAE;AAAA,MACzD;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AAAA,IACL,QAAQ,EAAE,QAAQ,SAAS;AAAA,IAC3B;AAAA,EACF;AACF;AAeA,SAAS,gBACP,QACiD;AACjD,QAAM,SAA0D,CAAC;AACjE,MAAI,eACF;AAEF,aAAW,WAAW,QAAQ;AAC5B,UAAM,EAAE,KAAK,IAAI;AACjB,YAAQ,MAAM;AAAA,MACZ,KAAK,UAAU;AACb,aAAI,6CAAc,UAAS,UAAU;AACnC,yBAAe,EAAE,MAAM,UAAU,UAAU,CAAC,EAAE;AAC9C,iBAAO,KAAK,YAAY;AAAA,QAC1B;AAEA,qBAAa,SAAS,KAAK,OAAO;AAClC;AAAA,MACF;AAAA,MACA,KAAK,aAAa;AAChB,aAAI,6CAAc,UAAS,aAAa;AACtC,yBAAe,EAAE,MAAM,aAAa,UAAU,CAAC,EAAE;AACjD,iBAAO,KAAK,YAAY;AAAA,QAC1B;AAEA,qBAAa,SAAS,KAAK,OAAO;AAClC;AAAA,MACF;AAAA,MACA,KAAK,QAAQ;AACX,aAAI,6CAAc,UAAS,QAAQ;AACjC,yBAAe,EAAE,MAAM,QAAQ,UAAU,CAAC,EAAE;AAC5C,iBAAO,KAAK,YAAY;AAAA,QAC1B;AAEA,qBAAa,SAAS,KAAK,OAAO;AAClC;AAAA,MACF;AAAA,MACA,KAAK,QAAQ;AACX,aAAI,6CAAc,UAAS,QAAQ;AACjC,yBAAe,EAAE,MAAM,QAAQ,UAAU,CAAC,EAAE;AAC5C,iBAAO,KAAK,YAAY;AAAA,QAC1B;AAEA,qBAAa,SAAS,KAAK,OAAO;AAClC;AAAA,MACF;AAAA,MACA,SAAS;AACP,cAAM,mBAA0B;AAChC,cAAM,IAAI,MAAM,qBAAqB,gBAAgB,EAAE;AAAA,MACzD;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AACT;;;AC3XO,SAAS,uBACd,cAC6B;AAC7B,UAAQ,cAAc;AAAA,IACpB,KAAK;AAAA,IACL,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT;AACE,aAAO;AAAA,EACX;AACF;;;AJwBO,IAAM,iCAAN,MAAgE;AAAA,EASrE,YACE,SACA,UACA,QACA;AAZF,SAAS,uBAAuB;AAChC,SAAS,8BAA8B;AAYrC,SAAK,UAAU;AACf,SAAK,WAAW;AAChB,SAAK,SAAS;AAAA,EAChB;AAAA,EAEA,YAAY,KAAmB;AAC7B,WAAO,IAAI,aAAa;AAAA,EAC1B;AAAA,EAEA,IAAI,WAAmB;AACrB,WAAO,KAAK,OAAO;AAAA,EACrB;AAAA,EAEA,IAAI,oBAA6B;AAC/B,WAAO,KAAK,OAAO;AAAA,EACrB;AAAA,EAEA,MAAc,QAAQ;AAAA,IACpB;AAAA,IACA;AAAA,IACA,YAAY;AAAA;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,kBAAkB;AAAA,EACpB,GAAiD;AApFnD;AAqFI,UAAM,OAAO,KAAK;AAElB,UAAM,WAAyC,CAAC;AAEhD,QAAI,oBAAoB,MAAM;AAC5B,eAAS,KAAK;AAAA,QACZ,MAAM;AAAA,QACN,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAEA,QAAI,mBAAmB,MAAM;AAC3B,eAAS,KAAK;AAAA,QACZ,MAAM;AAAA,QACN,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAEA,QAAI,QAAQ,MAAM;AAChB,eAAS,KAAK;AAAA,QACZ,MAAM;AAAA,QACN,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAEA,QAAI,kBAAkB,QAAQ,eAAe,SAAS,QAAQ;AAC5D,eAAS,KAAK;AAAA,QACZ,MAAM;AAAA,QACN,SAAS;AAAA,QACT,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAEA,UAAM,EAAE,QAAQ,gBAAgB,OAAO,cAAc,IACnD,iCAAiC;AAAA,MAC/B;AAAA,MACA,gBAAe,UAAK,SAAS,kBAAd,YAA+B;AAAA,MAC9C;AAAA,IACF,CAAC;AAEH,UAAM,mBAAmB,qBAAqB;AAAA,MAC5C,UAAU;AAAA,MACV;AAAA,MACA,QAAQ;AAAA,IACV,CAAC;AAED,UAAM,eAAa,0DAAkB,aAAlB,mBAA4B,UAAS;AACxD,UAAM,kBAAiB,0DAAkB,aAAlB,mBAA4B;AAEnD,UAAM,WAAW;AAAA;AAAA,MAEf,OAAO,KAAK;AAAA;AAAA,MAGZ,YAAY;AAAA,MACZ;AAAA,MACA,OAAO;AAAA,MACP,OAAO;AAAA,MACP,gBAAgB;AAAA;AAAA,MAGhB,GAAI,cAAc;AAAA,QAChB,UAAU,EAAE,MAAM,WAAW,eAAe,eAAe;AAAA,MAC7D;AAAA;AAAA,MAGA,QAAQ,eAAe;AAAA,MACvB,UAAU,eAAe;AAAA,IAC3B;AAEA,QAAI,YAAY;AACd,UAAI,kBAAkB,MAAM;AAC1B,cAAM,IAAIC,+BAA8B;AAAA,UACtC,eAAe;AAAA,QACjB,CAAC;AAAA,MACH;AAEA,UAAI,SAAS,eAAe,MAAM;AAChC,iBAAS,cAAc;AACvB,iBAAS,KAAK;AAAA,UACZ,MAAM;AAAA,UACN,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH;AAEA,UAAI,QAAQ,MAAM;AAChB,iBAAS,QAAQ;AACjB,iBAAS,KAAK;AAAA,UACZ,MAAM;AAAA,UACN,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH;AAEA,UAAI,QAAQ,MAAM;AAChB,iBAAS,QAAQ;AACjB,iBAAS,KAAK;AAAA,UACZ,MAAM;AAAA,UACN,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH;AAGA,eAAS,aAAa,YAAY;AAAA,IACpC;AAEA,YAAQ,MAAM;AAAA,MACZ,KAAK,WAAW;AACd,cAAM;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,UACA,OAAO;AAAA,QACT,IAAI,aAAa,IAAI;AAErB,eAAO;AAAA,UACL,MAAM,EAAE,GAAG,UAAU,OAAO,YAAY;AAAA,UACxC,UAAU,CAAC,GAAG,UAAU,GAAG,YAAY;AAAA,UACvC,OAAO,oBAAI,IAAI,CAAC,GAAG,eAAe,GAAG,UAAU,CAAC;AAAA,QAClD;AAAA,MACF;AAAA,MAEA,KAAK,eAAe;AAClB,cAAM,IAAIA,+BAA8B;AAAA,UACtC,eAAe;AAAA,QACjB,CAAC;AAAA,MACH;AAAA,MAEA,KAAK,eAAe;AAClB,cAAM,EAAE,MAAM,aAAa,WAAW,IAAI,KAAK;AAE/C,eAAO;AAAA,UACL,MAAM;AAAA,YACJ,GAAG;AAAA,YACH,OAAO,CAAC,EAAE,MAAM,aAAa,cAAc,WAAW,CAAC;AAAA,YACvD,aAAa,EAAE,MAAM,QAAQ,KAAK;AAAA,UACpC;AAAA,UACA;AAAA,UACA,OAAO;AAAA,QACT;AAAA,MACF;AAAA,MAEA,SAAS;AACP,cAAM,mBAA0B;AAChC,cAAM,IAAI,MAAM,qBAAqB,gBAAgB,EAAE;AAAA,MACzD;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,WAAW;AAAA,IACvB;AAAA,IACA;AAAA,EACF,GAGG;AACD,WAAO;AAAA,MACL,MAAM,QAAQ,KAAK,OAAO,OAAO;AAAA,MACjC,MAAM,OAAO,IAAI,EAAE,kBAAkB,MAAM,KAAK,KAAK,EAAE,KAAK,GAAG,EAAE,IAAI,CAAC;AAAA,MACtE;AAAA,IACF;AAAA,EACF;AAAA,EAEQ,gBAAgB,aAA8B;AA1PxD;AA2PI,YACE,sBAAK,QAAO,oBAAZ,4BAA8B,KAAK,OAAO,SAAS,iBAAnD,YACA,GAAG,KAAK,OAAO,OAAO;AAAA,EAE1B;AAAA,EAEQ,qBAAqB,MAAgD;AAjQ/E;AAkQI,YAAO,sBAAK,QAAO,yBAAZ,4BAAmC,UAAnC,YAA4C;AAAA,EACrD;AAAA,EAEA,MAAM,WACJ,SAC6D;AAvQjE;AAwQI,UAAM,EAAE,MAAM,UAAU,MAAM,IAAI,MAAM,KAAK,QAAQ,OAAO;AAE5D,UAAM;AAAA,MACJ;AAAA,MACA,OAAO;AAAA,MACP,UAAU;AAAA,IACZ,IAAI,MAAM,cAAc;AAAA,MACtB,KAAK,KAAK,gBAAgB,KAAK;AAAA,MAC/B,SAAS,MAAM,KAAK,WAAW,EAAE,OAAO,SAAS,QAAQ,QAAQ,CAAC;AAAA,MAClE,MAAM,KAAK,qBAAqB,IAAI;AAAA,MACpC,uBAAuB;AAAA,MACvB,2BAA2B;AAAA,QACzB;AAAA,MACF;AAAA,MACA,aAAa,QAAQ;AAAA,MACrB,OAAO,KAAK,OAAO;AAAA,IACrB,CAAC;AAED,UAAM,EAAE,UAAU,WAAW,GAAG,YAAY,IAAI;AAGhD,QAAI,OAAO;AACX,eAAW,WAAW,SAAS,SAAS;AACtC,UAAI,QAAQ,SAAS,QAAQ;AAC3B,gBAAQ,QAAQ;AAAA,MAClB;AAAA,IACF;AAGA,QAAI,YAA2D;AAC/D,QAAI,SAAS,QAAQ,KAAK,aAAW,QAAQ,SAAS,UAAU,GAAG;AACjE,kBAAY,CAAC;AACb,iBAAW,WAAW,SAAS,SAAS;AACtC,YAAI,QAAQ,SAAS,YAAY;AAC/B,oBAAU,KAAK;AAAA,YACb,cAAc;AAAA,YACd,YAAY,QAAQ;AAAA,YACpB,UAAU,QAAQ;AAAA,YAClB,MAAM,KAAK,UAAU,QAAQ,KAAK;AAAA,UACpC,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAEA,UAAM,YAAY,SAAS,QACxB;AAAA,MACC,aACE,QAAQ,SAAS,uBAAuB,QAAQ,SAAS;AAAA,IAC7D,EACC;AAAA,MAAI,aACH,QAAQ,SAAS,aACb;AAAA,QACE,MAAM;AAAA,QACN,MAAM,QAAQ;AAAA,QACd,WAAW,QAAQ;AAAA,MACrB,IACA;AAAA,QACE,MAAM;AAAA,QACN,MAAM,QAAQ;AAAA,MAChB;AAAA,IACN;AAEF,WAAO;AAAA,MACL;AAAA,MACA,WAAW,UAAU,SAAS,IAAI,YAAY;AAAA,MAC9C;AAAA,MACA,cAAc,uBAAuB,SAAS,WAAW;AAAA,MACzD,OAAO;AAAA,QACL,cAAc,SAAS,MAAM;AAAA,QAC7B,kBAAkB,SAAS,MAAM;AAAA,MACnC;AAAA,MACA,SAAS,EAAE,WAAW,YAAY;AAAA,MAClC,aAAa;AAAA,QACX,SAAS;AAAA,QACT,MAAM;AAAA,MACR;AAAA,MACA,UAAU;AAAA,QACR,KAAI,cAAS,OAAT,YAAe;AAAA,QACnB,UAAS,cAAS,UAAT,YAAkB;AAAA,MAC7B;AAAA,MACA;AAAA,MACA,kBAAkB;AAAA,QAChB,WAAW;AAAA,UACT,2BACE,cAAS,MAAM,gCAAf,YAA8C;AAAA,UAChD,uBAAsB,cAAS,MAAM,4BAAf,YAA0C;AAAA,QAClE;AAAA,MACF;AAAA,MACA,SAAS,EAAE,MAAM,KAAK,UAAU,IAAI,EAAE;AAAA,IACxC;AAAA,EACF;AAAA,EAEA,MAAM,SACJ,SAC2D;AAC3D,UAAM,EAAE,MAAM,UAAU,MAAM,IAAI,MAAM,KAAK,QAAQ,OAAO;AAC5D,UAAM,OAAO,EAAE,GAAG,MAAM,QAAQ,KAAK;AAErC,UAAM,EAAE,iBAAiB,OAAO,SAAS,IAAI,MAAM,cAAc;AAAA,MAC/D,KAAK,KAAK,gBAAgB,IAAI;AAAA,MAC9B,SAAS,MAAM,KAAK,WAAW,EAAE,OAAO,SAAS,QAAQ,QAAQ,CAAC;AAAA,MAClE,MAAM,KAAK,qBAAqB,IAAI;AAAA,MACpC,uBAAuB;AAAA,MACvB,2BAA2B;AAAA,QACzB;AAAA,MACF;AAAA,MACA,aAAa,QAAQ;AAAA,MACrB,OAAO,KAAK,OAAO;AAAA,IACrB,CAAC;AAED,UAAM,EAAE,UAAU,WAAW,GAAG,YAAY,IAAI;AAEhD,QAAI,eAA4C;AAChD,UAAM,QAA4D;AAAA,MAChE,cAAc,OAAO;AAAA,MACrB,kBAAkB,OAAO;AAAA,IAC3B;AAEA,UAAM,wBAOF,CAAC;AAEL,QAAI,mBACF;AAEF,QAAI,YAKY;AAEhB,WAAO;AAAA,MACL,QAAQ,SAAS;AAAA,QACf,IAAI,gBAGF;AAAA,UACA,UAAU,OAAO,YAAY;AAvZvC;AAwZY,gBAAI,CAAC,MAAM,SAAS;AAClB,yBAAW,QAAQ,EAAE,MAAM,SAAS,OAAO,MAAM,MAAM,CAAC;AACxD;AAAA,YACF;AAEA,kBAAM,QAAQ,MAAM;AAEpB,oBAAQ,MAAM,MAAM;AAAA,cAClB,KAAK,QAAQ;AACX;AAAA,cACF;AAAA,cAEA,KAAK,uBAAuB;AAC1B,sBAAM,mBAAmB,MAAM,cAAc;AAE7C,4BAAY;AAEZ,wBAAQ,kBAAkB;AAAA,kBACxB,KAAK;AAAA,kBACL,KAAK,YAAY;AACf;AAAA,kBACF;AAAA,kBAEA,KAAK,qBAAqB;AACxB,+BAAW,QAAQ;AAAA,sBACjB,MAAM;AAAA,sBACN,MAAM,MAAM,cAAc;AAAA,oBAC5B,CAAC;AACD;AAAA,kBACF;AAAA,kBAEA,KAAK,YAAY;AACf,0CAAsB,MAAM,KAAK,IAAI;AAAA,sBACnC,YAAY,MAAM,cAAc;AAAA,sBAChC,UAAU,MAAM,cAAc;AAAA,sBAC9B,UAAU;AAAA,oBACZ;AACA;AAAA,kBACF;AAAA,kBAEA,SAAS;AACP,0BAAM,mBAA0B;AAChC,0BAAM,IAAI;AAAA,sBACR,mCAAmC,gBAAgB;AAAA,oBACrD;AAAA,kBACF;AAAA,gBACF;AAAA,cACF;AAAA,cAEA,KAAK,sBAAsB;AAEzB,oBAAI,sBAAsB,MAAM,KAAK,KAAK,MAAM;AAC9C,wBAAM,eAAe,sBAAsB,MAAM,KAAK;AAEtD,6BAAW,QAAQ;AAAA,oBACjB,MAAM;AAAA,oBACN,cAAc;AAAA,oBACd,YAAY,aAAa;AAAA,oBACzB,UAAU,aAAa;AAAA,oBACvB,MAAM,aAAa;AAAA,kBACrB,CAAC;AAED,yBAAO,sBAAsB,MAAM,KAAK;AAAA,gBAC1C;AAEA,4BAAY;AAEZ;AAAA,cACF;AAAA,cAEA,KAAK,uBAAuB;AAC1B,sBAAM,YAAY,MAAM,MAAM;AAC9B,wBAAQ,WAAW;AAAA,kBACjB,KAAK,cAAc;AACjB,+BAAW,QAAQ;AAAA,sBACjB,MAAM;AAAA,sBACN,WAAW,MAAM,MAAM;AAAA,oBACzB,CAAC;AAED;AAAA,kBACF;AAAA,kBAEA,KAAK,kBAAkB;AACrB,+BAAW,QAAQ;AAAA,sBACjB,MAAM;AAAA,sBACN,WAAW,MAAM,MAAM;AAAA,oBACzB,CAAC;AAED;AAAA,kBACF;AAAA,kBAEA,KAAK,mBAAmB;AAEtB,wBAAI,cAAc,YAAY;AAC5B,iCAAW,QAAQ;AAAA,wBACjB,MAAM;AAAA,wBACN,WAAW,MAAM,MAAM;AAAA,sBACzB,CAAC;AAAA,oBACH;AAEA;AAAA,kBACF;AAAA,kBAEA,KAAK,oBAAoB;AACvB,0BAAM,eAAe,sBAAsB,MAAM,KAAK;AAEtD,+BAAW,QAAQ;AAAA,sBACjB,MAAM;AAAA,sBACN,cAAc;AAAA,sBACd,YAAY,aAAa;AAAA,sBACzB,UAAU,aAAa;AAAA,sBACvB,eAAe,MAAM,MAAM;AAAA,oBAC7B,CAAC;AAED,iCAAa,YAAY,MAAM,MAAM;AAErC;AAAA,kBACF;AAAA,kBAEA,SAAS;AACP,0BAAM,mBAA0B;AAChC,0BAAM,IAAI;AAAA,sBACR,2BAA2B,gBAAgB;AAAA,oBAC7C;AAAA,kBACF;AAAA,gBACF;AAAA,cACF;AAAA,cAEA,KAAK,iBAAiB;AACpB,sBAAM,eAAe,MAAM,QAAQ,MAAM;AACzC,sBAAM,mBAAmB,MAAM,QAAQ,MAAM;AAE7C,mCAAmB;AAAA,kBACjB,WAAW;AAAA,oBACT,2BACE,WAAM,QAAQ,MAAM,gCAApB,YAAmD;AAAA,oBACrD,uBACE,WAAM,QAAQ,MAAM,4BAApB,YAA+C;AAAA,kBACnD;AAAA,gBACF;AAEA,2BAAW,QAAQ;AAAA,kBACjB,MAAM;AAAA,kBACN,KAAI,WAAM,QAAQ,OAAd,YAAoB;AAAA,kBACxB,UAAS,WAAM,QAAQ,UAAd,YAAuB;AAAA,gBAClC,CAAC;AAED;AAAA,cACF;AAAA,cAEA,KAAK,iBAAiB;AACpB,sBAAM,mBAAmB,MAAM,MAAM;AACrC,+BAAe,uBAAuB,MAAM,MAAM,WAAW;AAC7D;AAAA,cACF;AAAA,cAEA,KAAK,gBAAgB;AACnB,2BAAW,QAAQ;AAAA,kBACjB,MAAM;AAAA,kBACN;AAAA,kBACA;AAAA,kBACA;AAAA,gBACF,CAAC;AACD;AAAA,cACF;AAAA,cAEA,KAAK,SAAS;AACZ,2BAAW,QAAQ,EAAE,MAAM,SAAS,OAAO,MAAM,MAAM,CAAC;AACxD;AAAA,cACF;AAAA,cAEA,SAAS;AACP,sBAAM,mBAA0B;AAChC,sBAAM,IAAI,MAAM,2BAA2B,gBAAgB,EAAE;AAAA,cAC/D;AAAA,YACF;AAAA,UACF;AAAA,QACF,CAAC;AAAA,MACH;AAAA,MACA,SAAS,EAAE,WAAW,YAAY;AAAA,MAClC,aAAa,EAAE,SAAS,gBAAgB;AAAA,MACxC;AAAA,MACA,SAAS,EAAE,MAAM,KAAK,UAAU,IAAI,EAAE;AAAA,IACxC;AAAA,EACF;AACF;AAIA,IAAM,kCAAkCC,GAAE,OAAO;AAAA,EAC/C,MAAMA,GAAE,QAAQ,SAAS;AAAA,EACzB,IAAIA,GAAE,OAAO,EAAE,QAAQ;AAAA,EACvB,OAAOA,GAAE,OAAO,EAAE,QAAQ;AAAA,EAC1B,SAASA,GAAE;AAAA,IACTA,GAAE,mBAAmB,QAAQ;AAAA,MAC3BA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,MAAM;AAAA,QACtB,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,UAAU;AAAA,QAC1B,UAAUA,GAAE,OAAO;AAAA,QACnB,WAAWA,GAAE,OAAO;AAAA,MACtB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,mBAAmB;AAAA,QACnC,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,UAAU;AAAA,QAC1B,IAAIA,GAAE,OAAO;AAAA,QACb,MAAMA,GAAE,OAAO;AAAA,QACf,OAAOA,GAAE,QAAQ;AAAA,MACnB,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAAA,EACA,aAAaA,GAAE,OAAO,EAAE,QAAQ;AAAA,EAChC,OAAOA,GAAE,OAAO;AAAA,IACd,cAAcA,GAAE,OAAO;AAAA,IACvB,eAAeA,GAAE,OAAO;AAAA,IACxB,6BAA6BA,GAAE,OAAO,EAAE,QAAQ;AAAA,IAChD,yBAAyBA,GAAE,OAAO,EAAE,QAAQ;AAAA,EAC9C,CAAC;AACH,CAAC;AAID,IAAM,+BAA+BA,GAAE,mBAAmB,QAAQ;AAAA,EAChEA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,eAAe;AAAA,IAC/B,SAASA,GAAE,OAAO;AAAA,MAChB,IAAIA,GAAE,OAAO,EAAE,QAAQ;AAAA,MACvB,OAAOA,GAAE,OAAO,EAAE,QAAQ;AAAA,MAC1B,OAAOA,GAAE,OAAO;AAAA,QACd,cAAcA,GAAE,OAAO;AAAA,QACvB,eAAeA,GAAE,OAAO;AAAA,QACxB,6BAA6BA,GAAE,OAAO,EAAE,QAAQ;AAAA,QAChD,yBAAyBA,GAAE,OAAO,EAAE,QAAQ;AAAA,MAC9C,CAAC;AAAA,IACH,CAAC;AAAA,EACH,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,qBAAqB;AAAA,IACrC,OAAOA,GAAE,OAAO;AAAA,IAChB,eAAeA,GAAE,mBAAmB,QAAQ;AAAA,MAC1CA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,MAAM;AAAA,QACtB,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,UAAU;AAAA,QAC1B,UAAUA,GAAE,OAAO;AAAA,MACrB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,UAAU;AAAA,QAC1B,IAAIA,GAAE,OAAO;AAAA,QACb,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,mBAAmB;AAAA,QACnC,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,IACH,CAAC;AAAA,EACH,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,qBAAqB;AAAA,IACrC,OAAOA,GAAE,OAAO;AAAA,IAChB,OAAOA,GAAE,mBAAmB,QAAQ;AAAA,MAClCA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,kBAAkB;AAAA,QAClC,cAAcA,GAAE,OAAO;AAAA,MACzB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,YAAY;AAAA,QAC5B,MAAMA,GAAE,OAAO;AAAA,MACjB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,gBAAgB;AAAA,QAChC,UAAUA,GAAE,OAAO;AAAA,MACrB,CAAC;AAAA,MACDA,GAAE,OAAO;AAAA,QACP,MAAMA,GAAE,QAAQ,iBAAiB;AAAA,QACjC,WAAWA,GAAE,OAAO;AAAA,MACtB,CAAC;AAAA,IACH,CAAC;AAAA,EACH,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,oBAAoB;AAAA,IACpC,OAAOA,GAAE,OAAO;AAAA,EAClB,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,OAAO;AAAA,IACvB,OAAOA,GAAE,OAAO;AAAA,MACd,MAAMA,GAAE,OAAO;AAAA,MACf,SAASA,GAAE,OAAO;AAAA,IACpB,CAAC;AAAA,EACH,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,eAAe;AAAA,IAC/B,OAAOA,GAAE,OAAO,EAAE,aAAaA,GAAE,OAAO,EAAE,QAAQ,EAAE,CAAC;AAAA,IACrD,OAAOA,GAAE,OAAO,EAAE,eAAeA,GAAE,OAAO,EAAE,CAAC;AAAA,EAC/C,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,cAAc;AAAA,EAChC,CAAC;AAAA,EACDA,GAAE,OAAO;AAAA,IACP,MAAMA,GAAE,QAAQ,MAAM;AAAA,EACxB,CAAC;AACH,CAAC;AAED,IAAM,iCAAiCA,GAAE,OAAO;AAAA,EAC9C,UAAUA,GACP,OAAO;AAAA,IACN,MAAMA,GAAE,MAAM,CAACA,GAAE,QAAQ,SAAS,GAAGA,GAAE,QAAQ,UAAU,CAAC,CAAC;AAAA,IAC3D,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,CAAC,EACA,SAAS;AACd,CAAC;;;AKrtBD,SAAS,KAAAC,UAAS;AAuBlB,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EACtC,SAASA,GAAE,OAAO;AAAA,EAClB,SAASA,GAAE,QAAQ,EAAE,SAAS;AAChC,CAAC;AASD,SAAS,kBACP,UAgBI,CAAC,GAQL;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,IACP,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEA,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EACtC,SAASA,GAAE,OAAO;AAAA,EAClB,SAASA,GAAE,QAAQ,EAAE,SAAS;AAChC,CAAC;AASD,SAAS,kBACP,UAgBI,CAAC,GAQL;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,IACP,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEA,IAAM,+BAA+BA,GAAE,OAAO;AAAA,EAC5C,SAASA,GAAE,KAAK,CAAC,QAAQ,UAAU,eAAe,UAAU,WAAW,CAAC;AAAA,EACxE,MAAMA,GAAE,OAAO;AAAA,EACf,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,aAAaA,GAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EACvC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,YAAYA,GAAE,MAAMA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,SAAS;AACjD,CAAC;AASD,SAAS,wBACP,UAyCI,CAAC,GAWL;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,IACP,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEA,IAAM,+BAA+BA,GAAE,OAAO;AAAA,EAC5C,SAASA,GAAE,KAAK,CAAC,QAAQ,UAAU,eAAe,UAAU,WAAW,CAAC;AAAA,EACxE,MAAMA,GAAE,OAAO;AAAA,EACf,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,aAAaA,GAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EACvC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,YAAYA,GAAE,MAAMA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,SAAS;AACjD,CAAC;AASD,SAAS,wBACP,UAyCI,CAAC,GAWL;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM,CAAC;AAAA,IACP,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEA,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EAC1C,QAAQA,GAAE,KAAK;AAAA,IACb;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAAA,EACD,YAAYA,GAAE,MAAMA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,SAAS;AAAA,EAC/C,MAAMA,GAAE,OAAO,EAAE,SAAS;AAC5B,CAAC;AAYD,SAAS,sBAA8B,SAqDrC;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM;AAAA,MACJ,gBAAgB,QAAQ;AAAA,MACxB,iBAAiB,QAAQ;AAAA,MACzB,eAAe,QAAQ;AAAA,IACzB;AAAA,IACA,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEA,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EAC1C,QAAQA,GAAE,KAAK;AAAA,IACb;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAAA,EACD,YAAYA,GAAE,MAAM,CAACA,GAAE,OAAO,EAAE,IAAI,GAAGA,GAAE,OAAO,EAAE,IAAI,CAAC,CAAC,EAAE,SAAS;AAAA,EACnE,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,kBAAkBA,GAAE,KAAK,CAAC,MAAM,QAAQ,QAAQ,OAAO,CAAC,EAAE,SAAS;AAAA,EACnE,kBAAkBA,GAAE,MAAM,CAACA,GAAE,OAAO,EAAE,IAAI,GAAGA,GAAE,OAAO,EAAE,IAAI,CAAC,CAAC,EAAE,SAAS;AAAA,EACzE,MAAMA,GAAE,OAAO,EAAE,SAAS;AAC5B,CAAC;AAYD,SAAS,sBAA8B,SAoFrC;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,IAAI;AAAA,IACJ,MAAM;AAAA,MACJ,gBAAgB,QAAQ;AAAA,MACxB,iBAAiB,QAAQ;AAAA,MACzB,eAAe,QAAQ;AAAA,IACzB;AAAA,IACA,YAAY;AAAA,IACZ,SAAS,QAAQ;AAAA,IACjB,kCAAkC,QAAQ;AAAA,EAC5C;AACF;AAEO,IAAM,iBAAiB;AAAA,EAC5B,eAAe;AAAA,EACf,eAAe;AAAA,EACf,qBAAqB;AAAA,EACrB,qBAAqB;AAAA,EACrB,mBAAmB;AAAA,EACnB,mBAAmB;AACrB;;;ANjbO,SAAS,gBACd,UAAqC,CAAC,GACnB;AAxFrB;AAyFE,QAAM,WACJ,0BAAqB,QAAQ,OAAO,MAApC,YAAyC;AAE3C,QAAM,aAAa,OAAO;AAAA,IACxB,qBAAqB;AAAA,IACrB,aAAa,WAAW;AAAA,MACtB,QAAQ,QAAQ;AAAA,MAChB,yBAAyB;AAAA,MACzB,aAAa;AAAA,IACf,CAAC;AAAA,IACD,GAAG,QAAQ;AAAA,EACb;AAEA,QAAM,kBAAkB,CACtB,SACA,WAAsC,CAAC,MAEvC,IAAI,+BAA+B,SAAS,UAAU;AAAA,IACpD,UAAU;AAAA,IACV;AAAA,IACA,SAAS;AAAA,IACT,OAAO,QAAQ;AAAA,IACf,mBAAmB;AAAA,EACrB,CAAC;AAEH,QAAM,WAAW,SACf,SACA,UACA;AACA,QAAI,YAAY;AACd,YAAM,IAAI;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAEA,WAAO,gBAAgB,SAAS,QAAQ;AAAA,EAC1C;AAEA,WAAS,gBAAgB;AACzB,WAAS,OAAO;AAChB,WAAS,WAAW;AACpB,WAAS,qBAAqB,CAAC,YAAoB;AACjD,UAAM,IAAI,iBAAiB,EAAE,SAAS,WAAW,qBAAqB,CAAC;AAAA,EACzE;AAEA,WAAS,QAAQ;AAEjB,SAAO;AACT;AAKO,IAAM,YAAY,gBAAgB;","names":["UnsupportedFunctionalityError","z","anthropicTools","UnsupportedFunctionalityError","_a","anthropic","i","part","UnsupportedFunctionalityError","z","z"]}
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.d.mts:  It defaults to the `ANTHROPIC_API_KEY` environment variable.
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.d.ts:  It defaults to the `ANTHROPIC_API_KEY` environment variable.
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.js:      environmentVariableName: "ANTHROPIC_API_KEY",
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.js.map:{"version":3,"sources":["../src/index.ts","../src/anthropic-provider.ts","../src/anthropic-messages-language-model.ts","../src/anthropic-error.ts","../src/anthropic-prepare-tools.ts","../src/convert-to-anthropic-messages-prompt.ts","../src/map-anthropic-stop-reason.ts","../src/anthropic-tools.ts"],"sourcesContent":["export type { AnthropicProviderOptions } from './anthropic-messages-language-model';\nexport { anthropic, createAnthropic } from './anthropic-provider';\nexport type {\n  AnthropicProvider,\n  AnthropicProviderSettings,\n} from './anthropic-provider';\n","import {\n  LanguageModelV1,\n  NoSuchModelError,\n  ProviderV1,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  loadApiKey,\n  withoutTrailingSlash,\n} from '@ai-sdk/provider-utils';\nimport { AnthropicMessagesLanguageModel } from './anthropic-messages-language-model';\nimport {\n  AnthropicMessagesModelId,\n  AnthropicMessagesSettings,\n} from './anthropic-messages-settings';\nimport { anthropicTools } from './anthropic-tools';\n\nexport interface AnthropicProvider extends ProviderV1 {\n  /**\nCreates a model for text generation.\n*/\n  (\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates a model for text generation.\n*/\n  languageModel(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\n@deprecated Use `.languageModel()` instead.\n*/\n  chat(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\n@deprecated Use `.languageModel()` instead.\n   */\n  messages(\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ): LanguageModelV1;\n\n  /**\nAnthropic-specific computer use tool.\n   */\n  tools: typeof anthropicTools;\n}\n\nexport interface AnthropicProviderSettings {\n  /**\nUse a different URL prefix for API calls, e.g. to use proxy servers.\nThe default prefix is `https://api.anthropic.com/v1`.\n   */\n  baseURL?: string;\n\n  /**\nAPI key that is being send using the `x-api-key` header.\nIt defaults to the `ANTHROPIC_API_KEY` environment variable.\n   */\n  apiKey?: string;\n\n  /**\nCustom headers to include in the requests.\n     */\n  headers?: Record<string, string>;\n\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n    */\n  fetch?: FetchFunction;\n\n  generateId?: () => string;\n}\n\n/**\nCreate an Anthropic provider instance.\n */\nexport function createAnthropic(\n  options: AnthropicProviderSettings = {},\n): AnthropicProvider {\n  const baseURL =\n    withoutTrailingSlash(options.baseURL) ?? 'https://api.anthropic.com/v1';\n\n  const getHeaders = () => ({\n    'anthropic-version': '2023-06-01',\n    'x-api-key': loadApiKey({\n      apiKey: options.apiKey,\n      environmentVariableName: 'ANTHROPIC_API_KEY',\n      description: 'Anthropic',\n    }),\n    ...options.headers,\n  });\n\n  const createChatModel = (\n    modelId: AnthropicMessagesModelId,\n    settings: AnthropicMessagesSettings = {},\n  ) =>\n    new AnthropicMessagesLanguageModel(modelId, settings, {\n      provider: 'anthropic.messages',\n      baseURL,\n      headers: getHeaders,\n      fetch: options.fetch,\n      supportsImageUrls: true,\n    });\n\n  const provider = function (\n    modelId: AnthropicMessagesModelId,\n    settings?: AnthropicMessagesSettings,\n  ) {\n    if (new.target) {\n      throw new Error(\n        'The Anthropic model function cannot be called with the new keyword.',\n      );\n    }\n\n    return createChatModel(modelId, settings);\n  };\n\n  provider.languageModel = createChatModel;\n  provider.chat = createChatModel;\n  provider.messages = createChatModel;\n  provider.textEmbeddingModel = (modelId: string) => {\n    throw new NoSuchModelError({ modelId, modelType: 'textEmbeddingModel' });\n  };\n\n  provider.tools = anthropicTools;\n\n  return provider;\n}\n\n/**\nDefault Anthropic provider instance.\n */\nexport const anthropic = createAnthropic();\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1FunctionToolCall,\n  LanguageModelV1ProviderMetadata,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  Resolvable,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  parseProviderOptions,\n  postJsonToApi,\n  resolve,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { anthropicFailedResponseHandler } from './anthropic-error';\nimport {\n  AnthropicMessagesModelId,\n  AnthropicMessagesSettings,\n} from './anthropic-messages-settings';\nimport { prepareTools } from './anthropic-prepare-tools';\nimport { convertToAnthropicMessagesPrompt } from './convert-to-anthropic-messages-prompt';\nimport { mapAnthropicStopReason } from './map-anthropic-stop-reason';\n\ntype AnthropicMessagesConfig = {\n  provider: string;\n  baseURL: string;\n  headers: Resolvable<Record<string, string | undefined>>;\n  supportsImageUrls: boolean;\n  fetch?: FetchFunction;\n  buildRequestUrl?: (baseURL: string, isStreaming: boolean) => string;\n  transformRequestBody?: (args: Record<string, any>) => Record<string, any>;\n};\n\nexport class AnthropicMessagesLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n  readonly defaultObjectGenerationMode = 'tool';\n\n  readonly modelId: AnthropicMessagesModelId;\n  readonly settings: AnthropicMessagesSettings;\n\n  private readonly config: AnthropicMessagesConfig;\n\n  constructor(\n    modelId: AnthropicMessagesModelId,\n    settings: AnthropicMessagesSettings,\n    config: AnthropicMessagesConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  supportsUrl(url: URL): boolean {\n    return url.protocol === 'https:';\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get supportsImageUrls(): boolean {\n    return this.config.supportsImageUrls;\n  }\n\n  private async getArgs({\n    mode,\n    prompt,\n    maxTokens = 4096, // 4096: max model output tokens TODO update default in v5\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    providerMetadata: providerOptions,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (frequencyPenalty != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'frequencyPenalty',\n      });\n    }\n\n    if (presencePenalty != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'presencePenalty',\n      });\n    }\n\n    if (seed != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'seed',\n      });\n    }\n\n    if (responseFormat != null && responseFormat.type !== 'text') {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details: 'JSON response format is not supported.',\n      });\n    }\n\n    const { prompt: messagesPrompt, betas: messagesBetas } =\n      convertToAnthropicMessagesPrompt({\n        prompt,\n        sendReasoning: this.settings.sendReasoning ?? true,\n        warnings,\n      });\n\n    const anthropicOptions = parseProviderOptions({\n      provider: 'anthropic',\n      providerOptions,\n      schema: anthropicProviderOptionsSchema,\n    });\n\n    const isThinking = anthropicOptions?.thinking?.type === 'enabled';\n    const thinkingBudget = anthropicOptions?.thinking?.budgetTokens;\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_k: topK,\n      top_p: topP,\n      stop_sequences: stopSequences,\n\n      // provider specific settings:\n      ...(isThinking && {\n        thinking: { type: 'enabled', budget_tokens: thinkingBudget },\n      }),\n\n      // prompt:\n      system: messagesPrompt.system,\n      messages: messagesPrompt.messages,\n    };\n\n    if (isThinking) {\n      if (thinkingBudget == null) {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'thinking requires a budget',\n        });\n      }\n\n      if (baseArgs.temperature != null) {\n        baseArgs.temperature = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'temperature',\n          details: 'temperature is not supported when thinking is enabled',\n        });\n      }\n\n      if (topK != null) {\n        baseArgs.top_k = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'topK',\n          details: 'topK is not supported when thinking is enabled',\n        });\n      }\n\n      if (topP != null) {\n        baseArgs.top_p = undefined;\n        warnings.push({\n          type: 'unsupported-setting',\n          setting: 'topP',\n          details: 'topP is not supported when thinking is enabled',\n        });\n      }\n\n      // adjust max tokens to account for thinking:\n      baseArgs.max_tokens = maxTokens + thinkingBudget;\n    }\n\n    switch (type) {\n      case 'regular': {\n        const {\n          tools,\n          tool_choice,\n          toolWarnings,\n          betas: toolsBetas,\n        } = prepareTools(mode);\n\n        return {\n          args: { ...baseArgs, tools, tool_choice },\n          warnings: [...warnings, ...toolWarnings],\n          betas: new Set([...messagesBetas, ...toolsBetas]),\n        };\n      }\n\n      case 'object-json': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'json-mode object generation',\n        });\n      }\n\n      case 'object-tool': {\n        const { name, description, parameters } = mode.tool;\n\n        return {\n          args: {\n            ...baseArgs,\n            tools: [{ name, description, input_schema: parameters }],\n            tool_choice: { type: 'tool', name },\n          },\n          warnings,\n          betas: messagesBetas,\n        };\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  private async getHeaders({\n    betas,\n    headers,\n  }: {\n    betas: Set<string>;\n    headers: Record<string, string | undefined> | undefined;\n  }) {\n    return combineHeaders(\n      await resolve(this.config.headers),\n      betas.size > 0 ? { 'anthropic-beta': Array.from(betas).join(',') } : {},\n      headers,\n    );\n  }\n\n  private buildRequestUrl(isStreaming: boolean): string {\n    return (\n      this.config.buildRequestUrl?.(this.config.baseURL, isStreaming) ??\n      `${this.config.baseURL}/messages`\n    );\n  }\n\n  private transformRequestBody(args: Record<string, any>): Record<string, any> {\n    return this.config.transformRequestBody?.(args) ?? args;\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args, warnings, betas } = await this.getArgs(options);\n\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse,\n    } = await postJsonToApi({\n      url: this.buildRequestUrl(false),\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(args),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        anthropicMessagesResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    // extract text\n    let text = '';\n    for (const content of response.content) {\n      if (content.type === 'text') {\n        text += content.text;\n      }\n    }\n\n    // extract tool calls\n    let toolCalls: LanguageModelV1FunctionToolCall[] | undefined = undefined;\n    if (response.content.some(content => content.type === 'tool_use')) {\n      toolCalls = [];\n      for (const content of response.content) {\n        if (content.type === 'tool_use') {\n          toolCalls.push({\n            toolCallType: 'function',\n            toolCallId: content.id,\n            toolName: content.name,\n            args: JSON.stringify(content.input),\n          });\n        }\n      }\n    }\n\n    const reasoning = response.content\n      .filter(\n        content =>\n          content.type === 'redacted_thinking' || content.type === 'thinking',\n      )\n      .map(content =>\n        content.type === 'thinking'\n          ? {\n              type: 'text' as const,\n              text: content.thinking,\n              signature: content.signature,\n            }\n          : {\n              type: 'redacted' as const,\n              data: content.data,\n            },\n      );\n\n    return {\n      text,\n      reasoning: reasoning.length > 0 ? reasoning : undefined,\n      toolCalls,\n      finishReason: mapAnthropicStopReason(response.stop_reason),\n      usage: {\n        promptTokens: response.usage.input_tokens,\n        completionTokens: response.usage.output_tokens,\n      },\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: {\n        headers: responseHeaders,\n        body: rawResponse,\n      },\n      response: {\n        id: response.id ?? undefined,\n        modelId: response.model ?? undefined,\n      },\n      warnings,\n      providerMetadata: {\n        anthropic: {\n          cacheCreationInputTokens:\n            response.usage.cache_creation_input_tokens ?? null,\n          cacheReadInputTokens: response.usage.cache_read_input_tokens ?? null,\n        },\n      },\n      request: { body: JSON.stringify(args) },\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings, betas } = await this.getArgs(options);\n    const body = { ...args, stream: true };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.buildRequestUrl(true),\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(body),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        anthropicMessagesChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    const usage: { promptTokens: number; completionTokens: number } = {\n      promptTokens: Number.NaN,\n      completionTokens: Number.NaN,\n    };\n\n    const toolCallContentBlocks: Record<\n      number,\n      {\n        toolCallId: string;\n        toolName: string;\n        jsonText: string;\n      }\n    > = {};\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined =\n      undefined;\n\n    let blockType:\n      | 'text'\n      | 'thinking'\n      | 'tool_use'\n      | 'redacted_thinking'\n      | undefined = undefined;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof anthropicMessagesChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            if (!chunk.success) {\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            switch (value.type) {\n              case 'ping': {\n                return; // ignored\n              }\n\n              case 'content_block_start': {\n                const contentBlockType = value.content_block.type;\n\n                blockType = contentBlockType;\n\n                switch (contentBlockType) {\n                  case 'text':\n                  case 'thinking': {\n                    return; // ignored\n                  }\n\n                  case 'redacted_thinking': {\n                    controller.enqueue({\n                      type: 'redacted-reasoning',\n                      data: value.content_block.data,\n                    });\n                    return;\n                  }\n\n                  case 'tool_use': {\n                    toolCallContentBlocks[value.index] = {\n                      toolCallId: value.content_block.id,\n                      toolName: value.content_block.name,\n                      jsonText: '',\n                    };\n                    return;\n                  }\n\n                  default: {\n                    const _exhaustiveCheck: never = contentBlockType;\n                    throw new Error(\n                      `Unsupported content block type: ${_exhaustiveCheck}`,\n                    );\n                  }\n                }\n              }\n\n              case 'content_block_stop': {\n                // when finishing a tool call block, send the full tool call:\n                if (toolCallContentBlocks[value.index] != null) {\n                  const contentBlock = toolCallContentBlocks[value.index];\n\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallType: 'function',\n                    toolCallId: contentBlock.toolCallId,\n                    toolName: contentBlock.toolName,\n                    args: contentBlock.jsonText,\n                  });\n\n                  delete toolCallContentBlocks[value.index];\n                }\n\n                blockType = undefined; // reset block type\n\n                return;\n              }\n\n              case 'content_block_delta': {\n                const deltaType = value.delta.type;\n                switch (deltaType) {\n                  case 'text_delta': {\n                    controller.enqueue({\n                      type: 'text-delta',\n                      textDelta: value.delta.text,\n                    });\n\n                    return;\n                  }\n\n                  case 'thinking_delta': {\n                    controller.enqueue({\n                      type: 'reasoning',\n                      textDelta: value.delta.thinking,\n                    });\n\n                    return;\n                  }\n\n                  case 'signature_delta': {\n                    // signature are only supported on thinking blocks:\n                    if (blockType === 'thinking') {\n                      controller.enqueue({\n                        type: 'reasoning-signature',\n                        signature: value.delta.signature,\n                      });\n                    }\n\n                    return;\n                  }\n\n                  case 'input_json_delta': {\n                    const contentBlock = toolCallContentBlocks[value.index];\n\n                    controller.enqueue({\n                      type: 'tool-call-delta',\n                      toolCallType: 'function',\n                      toolCallId: contentBlock.toolCallId,\n                      toolName: contentBlock.toolName,\n                      argsTextDelta: value.delta.partial_json,\n                    });\n\n                    contentBlock.jsonText += value.delta.partial_json;\n\n                    return;\n                  }\n\n                  default: {\n                    const _exhaustiveCheck: never = deltaType;\n                    throw new Error(\n                      `Unsupported delta type: ${_exhaustiveCheck}`,\n                    );\n                  }\n                }\n              }\n\n              case 'message_start': {\n                usage.promptTokens = value.message.usage.input_tokens;\n                usage.completionTokens = value.message.usage.output_tokens;\n\n                providerMetadata = {\n                  anthropic: {\n                    cacheCreationInputTokens:\n                      value.message.usage.cache_creation_input_tokens ?? null,\n                    cacheReadInputTokens:\n                      value.message.usage.cache_read_input_tokens ?? null,\n                  },\n                };\n\n                controller.enqueue({\n                  type: 'response-metadata',\n                  id: value.message.id ?? undefined,\n                  modelId: value.message.model ?? undefined,\n                });\n\n                return;\n              }\n\n              case 'message_delta': {\n                usage.completionTokens = value.usage.output_tokens;\n                finishReason = mapAnthropicStopReason(value.delta.stop_reason);\n                return;\n              }\n\n              case 'message_stop': {\n                controller.enqueue({\n                  type: 'finish',\n                  finishReason,\n                  usage,\n                  providerMetadata,\n                });\n                return;\n              }\n\n              case 'error': {\n                controller.enqueue({ type: 'error', error: value.error });\n                return;\n              }\n\n              default: {\n                const _exhaustiveCheck: never = value;\n                throw new Error(`Unsupported chunk type: ${_exhaustiveCheck}`);\n              }\n            }\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      warnings,\n      request: { body: JSON.stringify(body) },\n    };\n  }\n}\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst anthropicMessagesResponseSchema = z.object({\n  type: z.literal('message'),\n  id: z.string().nullish(),\n  model: z.string().nullish(),\n  content: z.array(\n    z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('text'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking'),\n        thinking: z.string(),\n        signature: z.string(),\n      }),\n      z.object({\n        type: z.literal('redacted_thinking'),\n        data: z.string(),\n      }),\n      z.object({\n        type: z.literal('tool_use'),\n        id: z.string(),\n        name: z.string(),\n        input: z.unknown(),\n      }),\n    ]),\n  ),\n  stop_reason: z.string().nullish(),\n  usage: z.object({\n    input_tokens: z.number(),\n    output_tokens: z.number(),\n    cache_creation_input_tokens: z.number().nullish(),\n    cache_read_input_tokens: z.number().nullish(),\n  }),\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst anthropicMessagesChunkSchema = z.discriminatedUnion('type', [\n  z.object({\n    type: z.literal('message_start'),\n    message: z.object({\n      id: z.string().nullish(),\n      model: z.string().nullish(),\n      usage: z.object({\n        input_tokens: z.number(),\n        output_tokens: z.number(),\n        cache_creation_input_tokens: z.number().nullish(),\n        cache_read_input_tokens: z.number().nullish(),\n      }),\n    }),\n  }),\n  z.object({\n    type: z.literal('content_block_start'),\n    index: z.number(),\n    content_block: z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('text'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking'),\n        thinking: z.string(),\n      }),\n      z.object({\n        type: z.literal('tool_use'),\n        id: z.string(),\n        name: z.string(),\n      }),\n      z.object({\n        type: z.literal('redacted_thinking'),\n        data: z.string(),\n      }),\n    ]),\n  }),\n  z.object({\n    type: z.literal('content_block_delta'),\n    index: z.number(),\n    delta: z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('input_json_delta'),\n        partial_json: z.string(),\n      }),\n      z.object({\n        type: z.literal('text_delta'),\n        text: z.string(),\n      }),\n      z.object({\n        type: z.literal('thinking_delta'),\n        thinking: z.string(),\n      }),\n      z.object({\n        type: z.literal('signature_delta'),\n        signature: z.string(),\n      }),\n    ]),\n  }),\n  z.object({\n    type: z.literal('content_block_stop'),\n    index: z.number(),\n  }),\n  z.object({\n    type: z.literal('error'),\n    error: z.object({\n      type: z.string(),\n      message: z.string(),\n    }),\n  }),\n  z.object({\n    type: z.literal('message_delta'),\n    delta: z.object({ stop_reason: z.string().nullish() }),\n    usage: z.object({ output_tokens: z.number() }),\n  }),\n  z.object({\n    type: z.literal('message_stop'),\n  }),\n  z.object({\n    type: z.literal('ping'),\n  }),\n]);\n\nconst anthropicProviderOptionsSchema = z.object({\n  thinking: z\n    .object({\n      type: z.union([z.literal('enabled'), z.literal('disabled')]),\n      budgetTokens: z.number().optional(),\n    })\n    .optional(),\n});\n\nexport type AnthropicProviderOptions = z.infer<\n  typeof anthropicProviderOptionsSchema\n>;\n","import { createJsonErrorResponseHandler } from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\n\nconst anthropicErrorDataSchema = z.object({\n  type: z.literal('error'),\n  error: z.object({\n    type: z.string(),\n    message: z.string(),\n  }),\n});\n\nexport type AnthropicErrorData = z.infer<typeof anthropicErrorDataSchema>;\n\nexport const anthropicFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: anthropicErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { AnthropicTool, AnthropicToolChoice } from './anthropic-api-types';\n\nexport function prepareTools(\n  mode: Parameters<LanguageModelV1['doGenerate']>[0]['mode'] & {\n    type: 'regular';\n  },\n): {\n  tools: Array<AnthropicTool> | undefined;\n  tool_choice: AnthropicToolChoice | undefined;\n  toolWarnings: LanguageModelV1CallWarning[];\n  betas: Set<string>;\n} {\n  // when the tools array is empty, change it to undefined to prevent errors:\n  const tools = mode.tools?.length ? mode.tools : undefined;\n\n  const toolWarnings: LanguageModelV1CallWarning[] = [];\n  const betas = new Set<string>();\n\n  if (tools == null) {\n    return { tools: undefined, tool_choice: undefined, toolWarnings, betas };\n  }\n\n  const anthropicTools: AnthropicTool[] = [];\n\n  for (const tool of tools) {\n    switch (tool.type) {\n      case 'function':\n        anthropicTools.push({\n          name: tool.name,\n          description: tool.description,\n          input_schema: tool.parameters,\n        });\n        break;\n      case 'provider-defined':\n        switch (tool.id) {\n          case 'anthropic.computer_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'computer_20250124',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n            });\n            break;\n          case 'anthropic.computer_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'computer_20241022',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n            });\n            break;\n          case 'anthropic.text_editor_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'text_editor_20250124',\n            });\n            break;\n          case 'anthropic.text_editor_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'text_editor_20241022',\n            });\n            break;\n          case 'anthropic.bash_20250124':\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'bash_20250124',\n            });\n            break;\n          case 'anthropic.bash_20241022':\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: tool.name,\n              type: 'bash_20241022',\n            });\n            break;\n          default:\n            toolWarnings.push({ type: 'unsupported-tool', tool });\n            break;\n        }\n        break;\n      default:\n        toolWarnings.push({ type: 'unsupported-tool', tool });\n        break;\n    }\n  }\n\n  const toolChoice = mode.toolChoice;\n\n  if (toolChoice == null) {\n    return {\n      tools: anthropicTools,\n      tool_choice: undefined,\n      toolWarnings,\n      betas,\n    };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'auto' },\n        toolWarnings,\n        betas,\n      };\n    case 'required':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'any' },\n        toolWarnings,\n        betas,\n      };\n    case 'none':\n      // Anthropic does not support 'none' tool choice, so we remove the tools:\n      return { tools: undefined, tool_choice: undefined, toolWarnings, betas };\n    case 'tool':\n      return {\n        tools: anthropicTools,\n        tool_choice: { type: 'tool', name: toolChoice.toolName },\n        toolWarnings,\n        betas,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `Unsupported tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  LanguageModelV1CallWarning,\n  LanguageModelV1Message,\n  LanguageModelV1Prompt,\n  LanguageModelV1ProviderMetadata,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { convertUint8ArrayToBase64 } from '@ai-sdk/provider-utils';\nimport {\n  AnthropicAssistantMessage,\n  AnthropicCacheControl,\n  AnthropicMessagesPrompt,\n  AnthropicUserMessage,\n} from './anthropic-api-types';\n\nexport function convertToAnthropicMessagesPrompt({\n  prompt,\n  sendReasoning,\n  warnings,\n}: {\n  prompt: LanguageModelV1Prompt;\n  sendReasoning: boolean;\n  warnings: LanguageModelV1CallWarning[];\n}): {\n  prompt: AnthropicMessagesPrompt;\n  betas: Set<string>;\n} {\n  const betas = new Set<string>();\n  const blocks = groupIntoBlocks(prompt);\n\n  let system: AnthropicMessagesPrompt['system'] = undefined;\n  const messages: AnthropicMessagesPrompt['messages'] = [];\n\n  function getCacheControl(\n    providerMetadata: LanguageModelV1ProviderMetadata | undefined,\n  ): AnthropicCacheControl | undefined {\n    const anthropic = providerMetadata?.anthropic;\n\n    // allow both cacheControl and cache_control:\n    const cacheControlValue =\n      anthropic?.cacheControl ?? anthropic?.cache_control;\n\n    // Pass through value assuming it is of the correct type.\n    // The Anthropic API will validate the value.\n    return cacheControlValue as AnthropicCacheControl | undefined;\n  }\n\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    const isLastBlock = i === blocks.length - 1;\n    const type = block.type;\n\n    switch (type) {\n      case 'system': {\n        if (system != null) {\n          throw new UnsupportedFunctionalityError({\n            functionality:\n              'Multiple system messages that are separated by user/assistant messages',\n          });\n        }\n\n        system = block.messages.map(({ content, providerMetadata }) => ({\n          type: 'text',\n          text: content,\n          cache_control: getCacheControl(providerMetadata),\n        }));\n\n        break;\n      }\n\n      case 'user': {\n        // combines all user and tool messages in this block into a single message:\n        const anthropicContent: AnthropicUserMessage['content'] = [];\n\n        for (const message of block.messages) {\n          const { role, content } = message;\n          switch (role) {\n            case 'user': {\n              for (let j = 0; j < content.length; j++) {\n                const part = content[j];\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = j === content.length - 1;\n\n                const cacheControl =\n                  getCacheControl(part.providerMetadata) ??\n                  (isLastPart\n                    ? getCacheControl(message.providerMetadata)\n                    : undefined);\n\n                switch (part.type) {\n                  case 'text': {\n                    anthropicContent.push({\n                      type: 'text',\n                      text: part.text,\n                      cache_control: cacheControl,\n                    });\n                    break;\n                  }\n\n                  case 'image': {\n                    anthropicContent.push({\n                      type: 'image',\n                      source:\n                        part.image instanceof URL\n                          ? {\n                              type: 'url',\n                              url: part.image.toString(),\n                            }\n                          : {\n                              type: 'base64',\n                              media_type: part.mimeType ?? 'image/jpeg',\n                              data: convertUint8ArrayToBase64(part.image),\n                            },\n                      cache_control: cacheControl,\n                    });\n\n                    break;\n                  }\n\n                  case 'file': {\n                    if (part.mimeType !== 'application/pdf') {\n                      throw new UnsupportedFunctionalityError({\n                        functionality: 'Non-PDF files in user messages',\n                      });\n                    }\n\n                    betas.add('pdfs-2024-09-25');\n\n                    anthropicContent.push({\n                      type: 'document',\n                      source:\n                        part.data instanceof URL\n                          ? {\n                              type: 'url',\n                              url: part.data.toString(),\n                            }\n                          : {\n                              type: 'base64',\n                              media_type: 'application/pdf',\n                              data: part.data,\n                            },\n                      cache_control: cacheControl,\n                    });\n\n                    break;\n                  }\n                }\n              }\n\n              break;\n            }\n            case 'tool': {\n              for (let i = 0; i < content.length; i++) {\n                const part = content[i];\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = i === content.length - 1;\n\n                const cacheControl =\n                  getCacheControl(part.providerMetadata) ??\n                  (isLastPart\n                    ? getCacheControl(message.providerMetadata)\n                    : undefined);\n\n                const toolResultContent =\n                  part.content != null\n                    ? part.content.map(part => {\n                        switch (part.type) {\n                          case 'text':\n                            return {\n                              type: 'text' as const,\n                              text: part.text,\n                              cache_control: undefined,\n                            };\n                          case 'image':\n                            return {\n                              type: 'image' as const,\n                              source: {\n                                type: 'base64' as const,\n                                media_type: part.mimeType ?? 'image/jpeg',\n                                data: part.data,\n                              },\n                              cache_control: undefined,\n                            };\n                        }\n                      })\n                    : JSON.stringify(part.result);\n\n                anthropicContent.push({\n                  type: 'tool_result',\n                  tool_use_id: part.toolCallId,\n                  content: toolResultContent,\n                  is_error: part.isError,\n                  cache_control: cacheControl,\n                });\n              }\n\n              break;\n            }\n            default: {\n              const _exhaustiveCheck: never = role;\n              throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n            }\n          }\n        }\n\n        messages.push({ role: 'user', content: anthropicContent });\n\n        break;\n      }\n\n      case 'assistant': {\n        // combines multiple assistant messages in this block into a single message:\n        const anthropicContent: AnthropicAssistantMessage['content'] = [];\n\n        for (let j = 0; j < block.messages.length; j++) {\n          const message = block.messages[j];\n          const isLastMessage = j === block.messages.length - 1;\n          const { content } = message;\n\n          for (let k = 0; k < content.length; k++) {\n            const part = content[k];\n            const isLastContentPart = k === content.length - 1;\n\n            // cache control: first add cache control from part.\n            // for the last part of a message,\n            // check also if the message has cache control.\n            const cacheControl =\n              getCacheControl(part.providerMetadata) ??\n              (isLastContentPart\n                ? getCacheControl(message.providerMetadata)\n                : undefined);\n\n            switch (part.type) {\n              case 'text': {\n                anthropicContent.push({\n                  type: 'text',\n                  text:\n                    // trim the last text part if it's the last message in the block\n                    // because Anthropic does not allow trailing whitespace\n                    // in pre-filled assistant responses\n                    isLastBlock && isLastMessage && isLastContentPart\n                      ? part.text.trim()\n                      : part.text,\n\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'reasoning': {\n                if (sendReasoning) {\n                  anthropicContent.push({\n                    type: 'thinking',\n                    thinking: part.text,\n                    signature: part.signature!,\n                    cache_control: cacheControl,\n                  });\n                } else {\n                  warnings.push({\n                    type: 'other',\n                    message:\n                      'sending reasoning content is disabled for this model',\n                  });\n                }\n                break;\n              }\n\n              case 'redacted-reasoning': {\n                anthropicContent.push({\n                  type: 'redacted_thinking',\n                  data: part.data,\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'tool-call': {\n                anthropicContent.push({\n                  type: 'tool_use',\n                  id: part.toolCallId,\n                  name: part.toolName,\n                  input: part.args,\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n            }\n          }\n        }\n\n        messages.push({ role: 'assistant', content: anthropicContent });\n\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return {\n    prompt: { system, messages },\n    betas,\n  };\n}\n\ntype SystemBlock = {\n  type: 'system';\n  messages: Array<LanguageModelV1Message & { role: 'system' }>;\n};\ntype AssistantBlock = {\n  type: 'assistant';\n  messages: Array<LanguageModelV1Message & { role: 'assistant' }>;\n};\ntype UserBlock = {\n  type: 'user';\n  messages: Array<LanguageModelV1Message & { role: 'user' | 'tool' }>;\n};\n\nfunction groupIntoBlocks(\n  prompt: LanguageModelV1Prompt,\n): Array<SystemBlock | AssistantBlock | UserBlock> {\n  const blocks: Array<SystemBlock | AssistantBlock | UserBlock> = [];\n  let currentBlock: SystemBlock | AssistantBlock | UserBlock | undefined =\n    undefined;\n\n  for (const message of prompt) {\n    const { role } = message;\n    switch (role) {\n      case 'system': {\n        if (currentBlock?.type !== 'system') {\n          currentBlock = { type: 'system', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'assistant': {\n        if (currentBlock?.type !== 'assistant') {\n          currentBlock = { type: 'assistant', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'user': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'tool': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return blocks;\n}\n","import { LanguageModelV1FinishReason } from '@ai-sdk/provider';\n\nexport function mapAnthropicStopReason(\n  finishReason: string | null | undefined,\n): LanguageModelV1FinishReason {\n  switch (finishReason) {\n    case 'end_turn':\n    case 'stop_sequence':\n      return 'stop';\n    case 'tool_use':\n      return 'tool-calls';\n    case 'max_tokens':\n      return 'length';\n    default:\n      return 'unknown';\n  }\n}\n","import { z } from 'zod';\n\n// Copied from ai package\ntype ExecuteFunction<PARAMETERS, RESULT> =\n  | undefined\n  | ((\n      args: PARAMETERS,\n      options: { abortSignal?: AbortSignal },\n    ) => Promise<RESULT>);\n\n// Copied from ai package\nexport type ToolResultContent = Array<\n  | {\n      type: 'text';\n      text: string;\n    }\n  | {\n      type: 'image';\n      data: string; // base64 encoded png image, e.g. screenshot\n      mimeType?: string; // e.g. 'image/png';\n    }\n>;\n\nconst Bash20241022Parameters = z.object({\n  command: z.string(),\n  restart: z.boolean().optional(),\n});\n\n/**\n * Creates a tool for running a bash command. Must have name \"bash\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction bashTool_20241022<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The bash command to run. Required unless the tool is being restarted.\n         */\n        command: string;\n\n        /**\n         * Specifying true will restart this tool. Otherwise, leave this unspecified.\n         */\n        restart?: boolean;\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.bash_20241022';\n  args: {};\n  parameters: typeof Bash20241022Parameters;\n  execute: ExecuteFunction<z.infer<typeof Bash20241022Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.bash_20241022',\n    args: {},\n    parameters: Bash20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Bash20250124Parameters = z.object({\n  command: z.string(),\n  restart: z.boolean().optional(),\n});\n\n/**\n * Creates a tool for running a bash command. Must have name \"bash\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction bashTool_20250124<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The bash command to run. Required unless the tool is being restarted.\n         */\n        command: string;\n\n        /**\n         * Specifying true will restart this tool. Otherwise, leave this unspecified.\n         */\n        restart?: boolean;\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.bash_20250124';\n  args: {};\n  parameters: typeof Bash20250124Parameters;\n  execute: ExecuteFunction<z.infer<typeof Bash20250124Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.bash_20250124',\n    args: {},\n    parameters: Bash20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst TextEditor20241022Parameters = z.object({\n  command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n  path: z.string(),\n  file_text: z.string().optional(),\n  insert_line: z.number().int().optional(),\n  new_str: z.string().optional(),\n  old_str: z.string().optional(),\n  view_range: z.array(z.number().int()).optional(),\n});\n\n/**\n * Creates a tool for editing text. Must have name \"str_replace_editor\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction textEditorTool_20241022<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n         */\n        command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n        /**\n         * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n         */\n        path: string;\n\n        /**\n         * Required parameter of `create` command, with the content of the file to be created.\n         */\n        file_text?: string;\n\n        /**\n         * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n         */\n        insert_line?: number;\n\n        /**\n         * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n         */\n        new_str?: string;\n\n        /**\n         * Required parameter of `str_replace` command containing the string in `path` to replace.\n         */\n        old_str?: string;\n\n        /**\n         * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n         */\n        view_range?: number[];\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.text_editor_20241022';\n  args: {};\n  parameters: typeof TextEditor20241022Parameters;\n  execute: ExecuteFunction<\n    z.infer<typeof TextEditor20241022Parameters>,\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.text_editor_20241022',\n    args: {},\n    parameters: TextEditor20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst TextEditor20250124Parameters = z.object({\n  command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n  path: z.string(),\n  file_text: z.string().optional(),\n  insert_line: z.number().int().optional(),\n  new_str: z.string().optional(),\n  old_str: z.string().optional(),\n  view_range: z.array(z.number().int()).optional(),\n});\n\n/**\n * Creates a tool for editing text. Must have name \"str_replace_editor\".\n *\n * Image results are supported.\n *\n * @param execute - The function to execute the tool. Optional.\n */\nfunction textEditorTool_20250124<RESULT>(\n  options: {\n    execute?: ExecuteFunction<\n      {\n        /**\n         * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n         */\n        command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n        /**\n         * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n         */\n        path: string;\n\n        /**\n         * Required parameter of `create` command, with the content of the file to be created.\n         */\n        file_text?: string;\n\n        /**\n         * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n         */\n        insert_line?: number;\n\n        /**\n         * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n         */\n        new_str?: string;\n\n        /**\n         * Required parameter of `str_replace` command containing the string in `path` to replace.\n         */\n        old_str?: string;\n\n        /**\n         * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n         */\n        view_range?: number[];\n      },\n      RESULT\n    >;\n    experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n  } = {},\n): {\n  type: 'provider-defined';\n  id: 'anthropic.text_editor_20250124';\n  args: {};\n  parameters: typeof TextEditor20250124Parameters;\n  execute: ExecuteFunction<\n    z.infer<typeof TextEditor20250124Parameters>,\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.text_editor_20250124',\n    args: {},\n    parameters: TextEditor20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Computer20241022Parameters = z.object({\n  action: z.enum([\n    'key',\n    'type',\n    'mouse_move',\n    'left_click',\n    'left_click_drag',\n    'right_click',\n    'middle_click',\n    'double_click',\n    'screenshot',\n    'cursor_position',\n  ]),\n  coordinate: z.array(z.number().int()).optional(),\n  text: z.string().optional(),\n});\n\n/**\n * Creates a tool for executing actions on a computer. Must have name \"computer\".\n *\n * Image results are supported.\n *\n * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n * @param execute - The function to execute the tool. Optional.\n */\nfunction computerTool_20241022<RESULT>(options: {\n  displayWidthPx: number;\n  displayHeightPx: number;\n  displayNumber?: number;\n  execute?: ExecuteFunction<\n    {\n      /**\n       * The action to perform. The available actions are:\n       * - `key`: Press a key or key-combination on the keyboard.\n       *   - This supports xdotool's `key` syntax.\n       *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n       * - `type`: Type a string of text on the keyboard.\n       * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n       * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `left_click`: Click the left mouse button.\n       * - `left_click_drag`: Click and drag the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `right_click`: Click the right mouse button.\n       * - `middle_click`: Click the middle mouse button.\n       * - `double_click`: Double-click the left mouse button.\n       * - `screenshot`: Take a screenshot of the screen.\n       */\n      action:\n        | 'key'\n        | 'type'\n        | 'mouse_move'\n        | 'left_click'\n        | 'left_click_drag'\n        | 'right_click'\n        | 'middle_click'\n        | 'double_click'\n        | 'screenshot'\n        | 'cursor_position';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n       */\n      coordinate?: number[];\n\n      /**\n       * Required only by `action=type` and `action=key`.\n       */\n      text?: string;\n    },\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n}): {\n  type: 'provider-defined';\n  id: 'anthropic.computer_20241022';\n  args: {};\n  parameters: typeof Computer20241022Parameters;\n  execute: ExecuteFunction<z.infer<typeof Computer20241022Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.computer_20241022',\n    args: {\n      displayWidthPx: options.displayWidthPx,\n      displayHeightPx: options.displayHeightPx,\n      displayNumber: options.displayNumber,\n    },\n    parameters: Computer20241022Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nconst Computer20250124Parameters = z.object({\n  action: z.enum([\n    'key',\n    'hold_key',\n    'type',\n    'cursor_position',\n    'mouse_move',\n    'left_mouse_down',\n    'left_mouse_up',\n    'left_click',\n    'left_click_drag',\n    'right_click',\n    'middle_click',\n    'double_click',\n    'triple_click',\n    'scroll',\n    'wait',\n    'screenshot',\n  ]),\n  coordinate: z.tuple([z.number().int(), z.number().int()]).optional(),\n  duration: z.number().optional(),\n  scroll_amount: z.number().optional(),\n  scroll_direction: z.enum(['up', 'down', 'left', 'right']).optional(),\n  start_coordinate: z.tuple([z.number().int(), z.number().int()]).optional(),\n  text: z.string().optional(),\n});\n\n/**\n * Creates a tool for executing actions on a computer. Must have name \"computer\".\n *\n * Image results are supported.\n *\n * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n * @param execute - The function to execute the tool. Optional.\n */\nfunction computerTool_20250124<RESULT>(options: {\n  displayWidthPx: number;\n  displayHeightPx: number;\n  displayNumber?: number;\n  execute?: ExecuteFunction<\n    {\n      /**\n       * - `key`: Press a key or key-combination on the keyboard.\n       *   - This supports xdotool's `key` syntax.\n       *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n       * - `hold_key`: Hold down a key or multiple keys for a specified duration (in seconds). Supports the same syntax as `key`.\n       * - `type`: Type a string of text on the keyboard.\n       * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n       * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n       * - `left_mouse_down`: Press the left mouse button.\n       * - `left_mouse_up`: Release the left mouse button.\n       * - `left_click`: Click the left mouse button at the specified (x, y) pixel coordinate on the screen. You can also include a key combination to hold down while clicking using the `text` parameter.\n       * - `left_click_drag`: Click and drag the cursor from `start_coordinate` to a specified (x, y) pixel coordinate on the screen.\n       * - `right_click`: Click the right mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `middle_click`: Click the middle mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `double_click`: Double-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `triple_click`: Triple-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n       * - `scroll`: Scroll the screen in a specified direction by a specified amount of clicks of the scroll wheel, at the specified (x, y) pixel coordinate. DO NOT use PageUp/PageDown to scroll.\n       * - `wait`: Wait for a specified duration (in seconds).\n       * - `screenshot`: Take a screenshot of the screen.\n       */\n      action:\n        | 'key'\n        | 'hold_key'\n        | 'type'\n        | 'cursor_position'\n        | 'mouse_move'\n        | 'left_mouse_down'\n        | 'left_mouse_up'\n        | 'left_click'\n        | 'left_click_drag'\n        | 'right_click'\n        | 'middle_click'\n        | 'double_click'\n        | 'triple_click'\n        | 'scroll'\n        | 'wait'\n        | 'screenshot';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n       */\n      coordinate?: [number, number];\n\n      /**\n       * The duration to hold the key down for. Required only by `action=hold_key` and `action=wait`.\n       */\n      duration?: number;\n\n      /**\n       * The number of 'clicks' to scroll. Required only by `action=scroll`.\n       */\n      scroll_amount?: number;\n\n      /**\n       * The direction to scroll the screen. Required only by `action=scroll`.\n       */\n      scroll_direction?: 'up' | 'down' | 'left' | 'right';\n\n      /**\n       * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to start the drag from. Required only by `action=left_click_drag`.\n       */\n      start_coordinate?: [number, number];\n\n      /**\n       * Required only by `action=type`, `action=key`, and `action=hold_key`. Can also be used by click or scroll actions to hold down keys while clicking or scrolling.\n       */\n      text?: string;\n    },\n    RESULT\n  >;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n}): {\n  type: 'provider-defined';\n  id: 'anthropic.computer_20250124';\n  args: {};\n  parameters: typeof Computer20250124Parameters;\n  execute: ExecuteFunction<z.infer<typeof Computer20250124Parameters>, RESULT>;\n  experimental_toToolResultContent?: (result: RESULT) => ToolResultContent;\n} {\n  return {\n    type: 'provider-defined',\n    id: 'anthropic.computer_20250124',\n    args: {\n      displayWidthPx: options.displayWidthPx,\n      displayHeightPx: options.displayHeightPx,\n      displayNumber: options.displayNumber,\n    },\n    parameters: Computer20250124Parameters,\n    execute: options.execute,\n    experimental_toToolResultContent: options.experimental_toToolResultContent,\n  };\n}\n\nexport const anthropicTools = {\n  bash_20241022: bashTool_20241022,\n  bash_20250124: bashTool_20250124,\n  textEditor_20241022: textEditorTool_20241022,\n  textEditor_20250124: textEditorTool_20250124,\n  computer_20241022: computerTool_20241022,\n  computer_20250124: computerTool_20250124,\n};\n"],"mappings":"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","names":["import_provider","import_provider_utils","import_provider","import_provider_utils","import_zod","anthropicTools","import_provider","import_provider_utils","_a","anthropic","i","part","import_zod"]}
/usr/lib/node_modules/task-master-ai/node_modules/@ai-sdk/anthropic/dist/index.mjs:      environmentVariableName: "ANTHROPIC_API_KEY",
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`)}catch(Q){d1(Q instanceof Error?Q:new Error(String(Q)))}}function E_1(){switch(w7()){case"macos":return"/Library/Application Support/ClaudeCode";default:return"/etc/claude-code"}}function q44(){return dn(E_1(),"managed-settings.json")}function $44(A){if(!b1().existsSync(A))return null;try{let B=TI(A),Q=N8(B),I=nfA.safeParse(Q);if(!I.success)return d1(new Error(`Invalid settings: ${I.error.message}`)),null;return I.data}catch(B){if(typeof B==="object"&&B&&"code"in B&&B.code==="ENOENT")v9(`Broken symlink or missing file encountered for settings.json at path: ${A}`);else d1(B instanceof Error?B:new Error(String(B)));return null}}function r81(A){switch(A){case"userSettings":return idA(m4());case"policySettings":case"projectSettings":case"localSettings":return idA(W4())}}function o81(A){switch(A){case"userSettings":return dn(r81(A),"settings.json");case"projectSettings":case"localSettings":return dn(r81(A),un(A));case"policySettings":return q44()}}function un(A){switch(A){case"projectSettings":return dn(".claude","settings.json");case"localSettings":return dn(".claude","settings.local.json")}}function MC(A){return $44(o81(A))}function mB(A,B){if(A==="policySettings")return;let Q=o81(A),I=N44(Q);if(!b1().existsSync(I))b1().mkdirSync(I);let Z={...MC(A),...B};if(IL(Q,JSON.stringify(Z,null,2)),A==="localSettings")g31(un("localSettings"),W4())}function M44(A,B){let Q=[...A,...B];return Array.from(new Set(Q))}function Q5(){let A={};for(let B of tM){let Q=MC(B);if(Q)A=ZN1(A,Q,(I,G)=>{if(Array.isArray(I)&&Array.isArray(G))return M44(I,G);return})}return A}function ndA(A,B=300000){let Q=new Map,I=(...G)=>{let Z=JSON.stringify(G),D=Q.get(Z),Y=Date.now();if(!D)Q.set(Z,{value:A(...G),timestamp:Y,refreshing:!1});if(D&&Y-D.timestamp>B&&!D.refreshing)return D.refreshing=!0,Promise.resolve().then(()=>{let W=A(...G);Q.set(Z,{value:W,timestamp:Date.now(),refreshing:!1})}).catch((W)=>{d1(W instanceof Error?W:new Error(String(W)));let J=Q.get(Z);if(J)J.refreshing=!1}),D.value;return Q.get(Z).value};return I.cache={clear:()=>Q.clear()},I}import{createHash as L44}from"crypto";function pn(A=""){let B=m4(),I=!process.env.CLAUDE_CONFIG_DIR?"":`-${L44("sha256").update(B).digest("hex").substring(0,8)}`;return`${r0}${A}${I}`}function adA(){let A=pn("-credentials");return{name:"keychain",read(){try{let B=TZ(`security find-generic-password -a $USER -w -s "${A}"`);if(B)return JSON.parse(B)}catch(B){return null}return null},update(B){try{let I=JSON.stringify(B).replace(/"/g,"\\\""),G=`security add-generic-password -U -a $USER -s "${A}" -w "${I}"`;return TZ(G),{success:!0}}catch(Q){return{success:!1}}},delete(){try{return TZ(`security delete-generic-password -a $USER -s "${A}"`),!0}catch(B){return!1}}}}import{join as R44}from"path";function U_1(){let A=m4(),B=".credentials.json",Q=R44(A,".credentials.json");return{name:"plaintext",read(){if(b1().existsSync(Q))try{let I=b1().readFileSync(Q,{encoding:"utf8"});return JSON.parse(I)}catch(I){return null}return null},update(I){try{if(!b1().existsSync(A))b1().mkdirSync(A);return b1().writeFileSync(Q,JSON.stringify(I),{encoding:"utf8",flush:!1}),b1().chmodSync(Q,384),{success:!0,warning:"Warning: Storing credentials in plaintext."}}catch(G){return{success:!1}}},delete(){if(b1().existsSync(Q))try{return b1().unlinkSync(Q),!0}catch(I){return!1}return!0}}}function O44(A){let B=U_1();return{name:`${A.name}-with-${B.name}-fallback`,read(){let Q=A.read();if(Q!==null&&Q!==void 0)return Q;return B.read()||{}},update(Q){let I=A.update(Q);if(I.success)return B.delete(),I;let G=B.update(Q);if(G.success)return{success:!0,warning:G.warning};return{success:!1}},delete(){let Q=A.delete(),I=B.delete();return Q||I}}}function EJ(){if(process.platform==="darwin"){let A=adA();return O44(A)}return U_1()}async function sdA(A){let Q=FA().oauthAccount?.accountUuid,I=jG(A);if(!Q||!I)return;let G=`${qB().BASE_API_URL}/api/claude_cli_profile`;try{return(await h4.get(G,{headers:{"x-api-key":I,"anthropic-beta":Mv},params:{account_uuid:Q}})).data}catch(Z){d1(Z)}}async function rdA(A){let B=`${qB().BASE_API_URL}/api/oauth/profile`;try{return(await h4.get(B,{headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}})).data}catch(Q){d1(Q)}}function wL(A){return Boolean(A?.includes(qwA))}function h31(A){return A?.split(" ").filter(Boolean)??[]}function N_1({codeChallenge:A,state:B,isManual:Q,loginWithClaudeAi:I}){let G=I?qB().CLAUDE_AI_AUTHORIZE_URL:qB().CONSOLE_AUTHORIZE_URL,Z=new URL(G);return Z.searchParams.append("code","true"),Z.searchParams.append("client_id",qB().CLIENT_ID),Z.searchParams.append("response_type","code"),Z.searchParams.append("redirect_uri",Q?qB().MANUAL_REDIRECT_URL:`http://localhost:${qB().REDIRECT_PORT}/callback`),Z.searchParams.append("scope",qB().SCOPES.join(" ")),Z.searchParams.append("code_challenge",A),Z.searchParams.append("code_challenge_method","S256"),Z.searchParams.append("state",B),Z.toString()}async function odA(A,B,Q,I=!1){let G={grant_type:"authorization_code",code:A,redirect_uri:I?qB().MANUAL_REDIRECT_URL:`http://localhost:${qB().REDIRECT_PORT}/callback`,client_id:qB().CLIENT_ID,code_verifier:Q,state:B},Z=await h4.post(qB().TOKEN_URL,G,{headers:{"Content-Type":"application/json"}});if(Z.status!==200)throw new Error(Z.status===401?"Authentication failed: Invalid authorization code":`Token exchange failed (${Z.status}): ${Z.statusText}`);return Z.data}async function tdA(A){let B={grant_type:"refresh_token",refresh_token:A,client_id:qB().CLIENT_ID};try{let Q=await h4.post(qB().TOKEN_URL,B,{headers:{"Content-Type":"application/json"}});if(Q.status!==200)throw new Error(`Token refresh failed: ${Q.statusText}`);let I=Q.data,{access_token:G,refresh_token:Z=A,expires_in:D}=I,Y=Date.now()+D*1000,W=h31(I.scope);E1("tengu_oauth_token_refresh_success",{});let J=await q_1(G);return{accessToken:G,refreshToken:Z,expiresAt:Y,scopes:W,subscriptionType:J}}catch(Q){throw E1("tengu_oauth_token_refresh_failure",{}),Q}}async function edA(A){let B=await h4.get(qB().ROLES_URL,{headers:{Authorization:`Bearer ${A}`}});if(B.status!==200)throw new Error(`Failed to fetch user roles: ${B.statusText}`);let Q=B.data,I=FA();if(!I.oauthAccount)throw new Error("OAuth account information not found in config");I.oauthAccount.organizationRole=Q.organization_role,I.oauthAccount.workspaceRole=Q.workspace_role,I.oauthAccount.organizationName=Q.organization_name,b0(I),E1("tengu_oauth_roles_stored",{org_role:Q.organization_role})}async function AuA(A){try{let B=await h4.post(qB().API_KEY_URL,null,{headers:{Authorization:`Bearer ${A}`}}),Q=B.data?.raw_key;if(Q)return BuA(Q),E1("tengu_oauth_api_key",{status:"success",statusCode:B.status}),Q;return null}catch(B){throw E1("tengu_oauth_api_key",{status:"failure",error:B instanceof Error?B.message:String(B)}),B}}function m31(A){return Date.now()+300000>=A}async function q_1(A){switch((await rdA(A))?.organization?.organization_type){case"claude_max":return"max";case"claude_pro":return"pro";case"claude_enterprise":return"enterprise";case"claude_team":return"team";default:return null}}var TuA=Y1(b_1(),1);var H64=300000;function nS(){let A=process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX,B=Q5().apiKeyHelper,Q=process.env.ANTHROPIC_AUTH_TOKEN||B,{source:I}=VX(O4A());return!(A||Q||(I==="ANTHROPIC_API_KEY"||I==="apiKeyHelper"))}function t31(){if(process.env.ANTHROPIC_AUTH_TOKEN)return{source:"ANTHROPIC_AUTH_TOKEN",hasToken:!0};if(aS())return{source:"apiKeyHelper",hasToken:!0};let B=PZ();if(wL(B?.scopes)&&B?.accessToken)return{source:"claude.ai",hasToken:!0};return{source:"none",hasToken:!1}}function jG(A){let{key:B}=VX(A);return B}function VX(A){if(A&&process.env.ANTHROPIC_API_KEY)return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};if(!1==="true"){if(!process.env.ANTHROPIC_API_KEY)throw new Error("ANTHROPIC_API_KEY env var is required");return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"}}if(process.env.ANTHROPIC_API_KEY&&FA().customApiKeyResponses?.approved?.includes(UJ(process.env.ANTHROPIC_API_KEY)))return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};let B=aS();if(B)return{key:B,source:"apiKeyHelper"};let Q=rn();if(Q)return Q;return{key:null,source:"none"}}function z64(){let A=process.env.CLAUDE_CODE_API_KEY_HELPER_TTL_MS;if(A){let B=parseInt(A,10);if(!Number.isNaN(B)&&B>=0)return B;m6(`Found CLAUDE_CODE_API_KEY_HELPER_TTL_MS env var, but it was not a valid number. Got ${A}`)}return H64}var aS=ndA(()=>{let B=Q5().apiKeyHelper;if(!B)return null;try{let Q=TZ(B)?.toString().trim();if(!Q)throw new Error("apiKeyHelper did not return a valid value");return Q}catch(Q){let I=LA.red("Error getting API key from apiKeyHelper (in settings or ~/.claude.json):");if(Q instanceof Error&&"stderr"in Q)console.error(I,String(Q.stderr));else if(Q instanceof Error)console.error(I,Q.message);else console.error(I,Q);return" "}},z64());function PuA(){aS.cache.clear()}function UJ(A){return A.slice(-20)}var rn=_0(()=>{if(process.platform==="darwin"){let B=pn();try{let Q=TZ(`security find-generic-password -a $USER -w -s "${B}"`);if(Q)return{key:Q,source:"/login managed key"}}catch(Q){d1(Q)}}let A=FA();if(!A.primaryApiKey)return null;return{key:A.primaryApiKey,source:"/login managed key"}});function w64(A){return/^[a-zA-Z0-9-_]+$/.test(A)}function BuA(A){if(!w64(A))throw new Error("Invalid API key format. API key must contain only alphanumeric characters, dashes, and underscores.");let B=FA();if(juA(),process.platform==="darwin")try{let I=pn();TZ(`security add-generic-password -a $USER -s "${I}" -w ${A}`)}catch(I){d1(I),B.primaryApiKey=A}else B.primaryApiKey=A;if(!B.customApiKeyResponses)B.customApiKeyResponses={approved:[],rejected:[]};if(!B.customApiKeyResponses.approved)B.customApiKeyResponses.approved=[];let Q=UJ(A);if(!B.customApiKeyResponses.approved.includes(Q))B.customApiKeyResponses.approved.push(Q);b0(B),rn.cache.clear?.()}function SuA(A){let B=FA(),Q=UJ(A);return B.customApiKeyResponses?.approved?.includes(Q)??!1}function _uA(){juA();let A=FA();A.primaryApiKey=void 0,b0(A),rn.cache.clear?.()}function juA(){if(process.platform==="darwin")try{let A=pn();TZ(`security delete-generic-password -a $USER -s "${A}"`)}catch(A){d1(A)}}function g_1(A){if(!wL(A.scopes))return{success:!0};try{let B=EJ(),Q=B.read()||{};Q.claudeAiOauth={accessToken:A.accessToken,refreshToken:A.refreshToken,expiresAt:A.expiresAt,scopes:A.scopes,subscriptionType:A.subscriptionType};let I=B.update(Q);return PZ.cache?.clear?.(),bY.cache?.clear?.(),I}catch(B){return d1(B),{success:!1,warning:"Failed to save OAuth tokens"}}}var PZ=_0(()=>{try{let Q=EJ().read()?.claudeAiOauth;if(!Q?.accessToken)return null;if(!Q.subscriptionType){let I=Q.isMax===!1?"pro":"max";return{...Q,subscriptionType:I}}return Q}catch(A){return d1(A),null}});async function h_1(A=0){let Q=PZ();if(!Q?.refreshToken||!m31(Q.expiresAt))return!1;if(PZ.cache?.clear?.(),Q=PZ(),!Q?.refreshToken||!m31(Q.expiresAt))return!1;let I=m4();b1().mkdirSync(I);let Z;try{Z=await TuA.lock(I)}catch(D){if(D.code==="ELOCKED"){if(A<5)return await new Promise((Y)=>setTimeout(Y,1000+Math.random()*1000)),h_1(A+1);return!1}return d1(D),!1}try{if(PZ.cache?.clear?.(),Q=PZ(),!Q?.refreshToken||!m31(Q.expiresAt))return!1;let D=await tdA(Q.refreshToken);return g_1({...D,scopes:Q.scopes}),PZ.cache?.clear?.(),!0}catch(D){return d1(D instanceof Error?D:new Error(String(D))),!1}finally{await Z()}}function f9(){if(!nS())return!1;return wL(PZ()?.scopes)}function SZ(){let A=kuA();return A==="max"||A==="enterprise"||A==="team"}function yuA(){return SZ()}function kuA(){if(!nS())return null;let A=PZ();if(!A)return null;return A.subscriptionType??null}function e31(){switch(kuA()){case"enterprise":return"Claude Enterprise";case"team":return"Claude Team";case"max":return"Claude Max";case"pro":return"Claude Pro";default:return"Claude API"}}function Hb(){return!!(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX)}function E64(A){let B=bQ();if(B==="bedrock")return!1;else if(B==="firstParty")return A.includes("claude-3-7")||A.includes("claude-opus-4")||A.includes("claude-sonnet-4");else return A.includes("claude-opus-4")||A.includes("claude-sonnet-4")}var bY=_0((A)=>{let B=[],Q=A.includes("haiku");if(!Q)B.push(UwA);if(f9())B.push(Mv);if(!gY(process.env.DISABLE_INTERLEAVED_THINKING)&&E64(A))B.push(q51);if(bQ()==="firstParty"&&!gY(process.env.CLAUDE_CODE_DISABLE_FINE_GRAINED_TOOL_STREAMING))B.push(NwA);if(process.env.ANTHROPIC_BETAS&&!Q)B.push(...process.env.ANTHROPIC_BETAS.split(",").map((G)=>G.trim()).filter(Boolean));return B});var sS={firstParty:"claude-3-7-sonnet-20250219",bedrock:"us.anthropic.claude-3-7-sonnet-20250219-v1:0",vertex:"claude-3-7-sonnet@20250219"},rS={firstParty:"claude-3-5-sonnet-20241022",bedrock:"anthropic.claude-3-5-sonnet-20241022-v2:0",vertex:"claude-3-5-sonnet-v2@20241022"},on={firstParty:"claude-3-5-haiku-20241022",bedrock:"us.anthropic.claude-3-5-haiku-20241022-v1:0",vertex:"claude-3-5-haiku@20241022"},SC={firstParty:"claude-sonnet-4-20250514",bedrock:"us.anthropic.claude-sonnet-4-20250514-v1:0",vertex:"claude-sonnet-4@20250514"},FN={firstParty:"claude-opus-4-20250514",bedrock:"us.anthropic.claude-opus-4-20250514-v1:0",vertex:"claude-opus-4@20250514"};function xuA(A){let B=A.toLowerCase();if(B.includes("claude-sonnet-4"))return"Sonnet 4";if(B.includes("claude-opus-4"))return"Opus 4";if(B.includes("claude-3-7-sonnet"))return"Claude 3.7 Sonnet";if(B.includes("claude-3-5-sonnet"))return"Claude 3.5 Sonnet";if(B.includes("claude-3-5-haiku"))return"Claude 3.5 Haiku";return}var SG1=Y1(FD0(),1);var XD0=_0(async function(){let A=Ug(),B=new SG1.BedrockClient({region:A}),Q=new SG1.ListInferenceProfilesCommand;try{return((await B.send(Q)).inferenceProfileSummaries||[]).filter((Y)=>Y.inferenceProfileId?.includes("anthropic")).map((Y)=>Y.inferenceProfileId).filter(Boolean)}catch(I){throw d1(I),I}});function Eg(A,B){return A.find((Q)=>Q.includes(B))??null}function _G1(A){let B=[],Q=!1;async function I(){if(Q)return;if(B.length===0)return;Q=!0;while(B.length>0){let{args:G,resolve:Z,reject:D,context:Y}=B.shift();try{let W=await A.apply(Y,G);Z(W)}catch(W){D(W)}}if(Q=!1,B.length>0)I()}return function(...G){return new Promise((Z,D)=>{B.push({args:G,resolve:Z,reject:D,context:this}),I()})}}function jG1(A){return{haiku35:on[A],sonnet35:rS[A],sonnet37:sS[A],sonnet40:SC[A],opus40:FN[A]}}async function zg4(){let A;try{A=await XD0()}catch(D){return d1(D),jG1("bedrock")}if(!A?.length)return jG1("bedrock");let B=Eg(A,"claude-3-5-haiku-20241022"),Q=Eg(A,"claude-3-5-sonnet-20241022"),I=Eg(A,"claude-3-7-sonnet-20250219"),G=Eg(A,"claude-sonnet-4-20250514"),Z=Eg(A,"claude-opus-4-20250514");return{haiku35:B||on.bedrock,sonnet35:Q||rS.bedrock,sonnet37:I||sS.bedrock,sonnet40:G||SC.bedrock,opus40:Z||FN.bedrock}}var wg4=_G1(async()=>{if(T21()!==null)return;try{let A=await zg4();sU1(A)}catch(A){d1(A)}});function Eg4(){if(T21()!==null)return;if(bQ()!=="bedrock"){sU1(jG1(bQ()));return}wg4()}function LX(){let A=T21();if(A===null)return Eg4(),jG1(bQ());return A}var Ug4=SC,VD0=Ug4.firstParty;function q_(){return process.env.ANTHROPIC_SMALL_FAST_MODEL||LX().haiku35}function yG1(A){return A===LX().opus40}function Ng(){let A,B=K4A();if(B!==void 0)A=B;else A=process.env.ANTHROPIC_MODEL||Q5().model||void 0;if(f9()&&!SZ()&&A?.includes("opus"))return;return A}function q7(){let A=Ng();if(A!==void 0&&A!==null)return qg(A);if(A===null&&qP())return RX();return Qs()}function CD0(){if(bQ()==="bedrock")return LX().sonnet37;return LX().sonnet40}var lV8=_0(()=>{return null});function Qs(){if(SZ())return LX().opus40;return CD0()}function RX(){return CD0()}function pC(A){let B=A.match(/(claude-(\d+-\d+-)?\w+)/);if(B&&B[1])return B[1];return A}function kG1(){if(f9()&&!SZ())return xG1.description;let A=FA().fallbackAvailableWarningThreshold;if(A===void 0)return"Use Opus 4 or Sonnet 4 based on Max usage limits";return`Opus 4 for up to ${(A*100).toFixed(0)}% of usage limits, then use Sonnet 4`}function $_(A){if(A===LX().opus40)return"Opus 4";if(A===LX().sonnet40)return"Sonnet 4";return"Sonnet 3.7"}function N_(){if(f9()&&!SZ())return{value:null,label:"Sonnet",description:xG1.description};if(SZ())return{value:null,label:"Default (recommended)",description:kG1()};return{value:null,label:"Default (recommended)",description:`Use the default model (currently ${$_(Qs())})  $3/$15 per Mtok`}}var KD0={value:"sonnet",label:"Sonnet",description:"Sonnet 4 for daily use  $3/$15 per Mtok"},Xf1={value:"opus",label:"Opus",description:"Opus 4 for complex tasks  $15/$75 per Mtok"},Ng4={value:"opus",label:"Opus",description:"Opus 4 for complex tasks  Reaches usage limits ~5x faster"},xG1={value:"sonnet",label:"Sonnet",description:"Sonnet 4 for daily use"};function qg4(){if(f9()&&!SZ())return[N_()];if(SZ())return[N_(),Ng4,xG1];if(bQ()==="bedrock")return[N_(),KD0,Xf1];return[N_(),Xf1]}function HD0(){let A=qg4(),B=null,Q=Ng(),I=O21();if(Q!==void 0&&Q!==null)B=Q;else if(I!==null)B=I;if(B===null||A.some((G)=>G.value===B))return A;if(zD0(B))A.push(B==="sonnet"?KD0:Xf1);else A.push({value:B,label:B,description:"Custom model"});return A}function zD0(A){return["sonnet","opus"].includes(A)}function qg(A){let B=A.toLowerCase().trim();if(zD0(B))return B==="sonnet"?LX().sonnet40:LX().opus40;return B}function M_(A){if(A===null){if(f9()&&!SZ())return`Sonnet (${xG1.description})`;else if(f9())return`Default (${kG1()})`;return`Default (${Qs()})`}let B=qg(A);return A===B?B:`${A} (${B})`}function wD0(A){return A}var ED0={},L_=null,UD0=_0(()=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return null;let A=px(),B={networkConfig:{api:"https://statsig.anthropic.com/v1/"},environment:{tier:["test","dev"].includes("production")?"development":"production"},includeCurrentPageUrlWithEvents:!1,logLevel:vG1.LogLevel.None,storageProvider:new AR1,customUserCacheKeyFunc:(I,G)=>{return Mg4("sha1").update(I).update(G.userID||"").digest("hex").slice(0,10)}};L_=new vG1.StatsigClient(tFA,A,B),L_.on("error",()=>{h4.head("https://api.anthropic.com/api/hello").catch(()=>{})});let Q=L_.initializeAsync().then(()=>{});return process.on("beforeExit",async()=>{await L_?.flush()}),process.on("exit",()=>{L_?.flush()}),{client:L_,initialized:Q}}),R_=_0(async()=>{let A=UD0();if(!A)return null;return await A.initialized,A.client});function ND0(){L_=null,UD0.cache?.clear?.(),R_.cache?.clear?.(),Lg4.cache?.clear?.(),MJ.cache?.clear?.()}async function E1(A,B){if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return;try{let Q=B.model?String(B.model):q7(),I=bY(Q),[G,Z,D]=await Promise.all([R_(),nA.getPackageManagers(),nA.getRuntimes()]);if(!G)return;let Y={...B,model:Q,sessionId:h9(),userType:"external",...I.length>0?{betas:I.join(",")}:{},env:JSON.stringify({platform:nA.platform,nodeVersion:nA.nodeVersion,terminal:nA.terminal,packageManagers:Z.join(","),runtimes:D.join(","),isRunningWithBun:nA.isRunningWithBun(),isCi:!1==="true",isClaubbit:process.env.CLAUBBIT==="true",isGithubAction:process.env.GITHUB_ACTIONS==="true",isClaudeCodeAction:process.env.CLAUDE_CODE_ACTION==="1"||process.env.CLAUDE_CODE_ACTION==="true",isClaudeAiAuth:f9(),version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION,...process.env.GITHUB_ACTIONS==="true"&&{githubEventName:process.env.GITHUB_EVENT_NAME,githubActionsRunnerEnvironment:process.env.RUNNER_ENVIRONMENT,githubActionsRunnerOs:process.env.RUNNER_OS}}),entrypoint:process.env.CLAUDE_CODE_ENTRYPOINT,...void 0,...!1},W={eventName:A,metadata:Y};G.logEvent(W),await G.flush()}catch(Q){}}var MJ=_0(async(A)=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return!1;let B=await R_();if(!B)return!1;let Q=B.checkGate(A);return ED0[A]=Q,Q});function qD0(){return{...ED0}}var Lg4=_0(async(A,B)=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return B;let Q=await R_();if(!Q)return B;let I=Q.getExperiment(A);if(Object.keys(I.value).length===0)return B;return I.value});async function cC(A,B){if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return B;let Q=await R_();if(!Q)return B;let I=Q.getDynamicConfig(A);if(Object.keys(I.value).length===0)return B;return I.value}var $D0=_0(cC);function MD0(){tL.init({dsn:oFA,environment:"external",release:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION,defaultIntegrations:!1,tracesSampleRate:1,tracePropagationTargets:["localhost"]})}function fG1(A){try{let B=px();tL.setExtras({nodeVersion:nA.nodeVersion,platform:nA.platform,isCI:nA.isCI,isTest:!1,packageVersion:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION,sessionId:h9(),statsigGates:qD0(),terminal:nA.terminal,userType:"external"}),tL.setUser({id:B.userID,email:B.email}),tL.captureException(A)}catch{}}import{join as Is}from"path";import{basename as Og4}from"path";var Rg4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function lC(A){if(typeof A!=="string")return null;return Rg4.test(A)?A:null}var Cf1=iA();function Gs(){return Is(m4(),"projects")}function LD0(){let A=bG1(Cf1);return Is(A,`${h9()}.jsonl`)}function Tg4(){return"production"}function RD0(){return"external"}function bG1(A){return Is(Gs(),A.replace(/[^a-zA-Z0-9]/g,"-"))}var Vf1=null;function $g(){if(!Vf1)Vf1=new OD0;return Vf1}class OD0{summaries;messages;sessionMessages;didLoad=!1;sessionFile=null;constructor(){this.summaries=new Map,this.messages=new Map,this.sessionMessages=new Map}async insertMessageChain(A,B=!1){let Q=null;for(let I of A){let G={parentUuid:Q,isSidechain:B,userType:RD0(),cwd:iA(),sessionId:h9(),version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION,...I};this.messages.set(I.uuid,G),await this.appendEntry(G),Q=I.uuid}}async appendEntry(A){if(Tg4()==="test"||Q5().cleanupPeriodDays===0)return;let B=b1();if(this.sessionFile===null){let I=bG1(Cf1);try{B.statSync(I)}catch{B.mkdirSync(I)}this.sessionFile=LD0();try{B.statSync(this.sessionFile)}catch{B.writeFileSync(this.sessionFile,"",{encoding:"utf8",flush:!0})}}let Q=h9();if(A.type==="summary")B.appendFileSync(this.sessionFile,JSON.stringify(A)+`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let Q=this._client._options.timeout;if(!A.stream&&Q==null){let I=nJ1[A.model]??void 0;Q=this._client.calculateNonstreamingTimeout(A.max_tokens,I)}return this._client.post("/v1/messages",{body:A,timeout:Q??600000,...B,stream:A.stream??!1})}stream(A,B){return Et.createMessage(this,A,B)}countTokens(A,B){return this._client.post("/v1/messages/count_tokens",{body:A,...B})}}var zo0={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};EK.Batches=Ut;class xm extends BI{retrieve(A,B={},Q){let{betas:I}=B??{};return this._client.get(cZ`/v1/models/${A}`,{...Q,headers:m5([{...I?.toString()!=null?{"anthropic-beta":I?.toString()}:void 0},Q?.headers])})}list(A={},B){let{betas:Q,...I}=A??{};return this._client.getAPIList("/v1/models",wK,{query:I,...B,headers:m5([{...Q?.toString()!=null?{"anthropic-beta":Q?.toString()}:void 0},B?.headers])})}}var Nt=(A)=>{if(typeof globalThis.process!=="undefined")return globalThis.process.env?.[A]?.trim()??void 0;if(typeof globalThis.Deno!=="undefined")return globalThis.Deno.env?.get?.(A)?.trim();return};var ml1,dl1,AF1,wo0;class d8{constructor({baseURL:A=Nt("ANTHROPIC_BASE_URL"),apiKey:B=Nt("ANTHROPIC_API_KEY")??null,authToken:Q=Nt("ANTHROPIC_AUTH_TOKEN")??null,...I}={}){ml1.add(this),AF1.set(this,void 0);let G={apiKey:B,authToken:Q,...I,baseURL:A||"https://api.anthropic.com"};if(!G.dangerouslyAllowBrowser&&ur0())throw new P9(`It looks like you're running in a browser-like environment.
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:Assistant:`;d8.DEFAULT_TIMEOUT=600000;d8.AnthropicError=P9;d8.APIError=Z5;d8.APIConnectionError=Zq;d8.APIConnectionTimeoutError=co;d8.APIUserAbortError=mI;d8.NotFoundError=ao;d8.ConflictError=so;d8.RateLimitError=oo;d8.BadRequestError=lo;d8.AuthenticationError=io;d8.InternalServerError=to;d8.PermissionDeniedError=no;d8.UnprocessableEntityError=ro;d8.toFile=gJ1;class Jq extends d8{constructor(){super(...arguments);this.completions=new tR(this),this.messages=new EK(this),this.models=new xm(this),this.beta=new uJ(this)}}Jq.Completions=tR;Jq.Messages=EK;Jq.Models=xm;Jq.Beta=uJ;var lZ="API Error",qt="Prompt is too long",ul1="Credit balance is too low",BF1="Invalid API key  Please run /login",QF1="Invalid API key  Fix external API key",pl1="Claude AI usage limit reached",cl1="Repeated server overload with Opus model",DW="(no content)",IF1="OAuth token revoked  Please run /login",ll1="Repeated 529 Overloaded errors",vm="Opus is experiencing high load, please use /model to switch to Sonnet";function GF1(A,B,Q){if(A instanceof Error&&A.message.includes(ll1))return ZW({content:cl1});if(A instanceof Error&&A.message.includes(vm))return ZW({content:vm});if(A instanceof Z5&&A.status===429&&f9()){let I=A.headers?.get?.("anthropic-ratelimit-unified-reset"),G=Number(I)||0,Z=`${pl1}|${G}`;return ZW({content:Z})}if(A instanceof Error&&A.message.includes("prompt is too long"))return ZW({content:qt});if(A instanceof Error&&A.message.includes("Your credit balance is too low"))return ZW({content:ul1});if(A instanceof Error&&A.message.toLowerCase().includes("x-api-key")){let{source:I}=VX(Q);return ZW({content:I==="ANTHROPIC_API_KEY"||I==="apiKeyHelper"?QF1:BF1})}if(A instanceof Z5&&A.status===403&&A.message.includes("OAuth token has been revoked"))return ZW({content:IF1});if(process.env.CLAUDE_CODE_USE_BEDROCK&&A instanceof Error&&A.message.toLowerCase().includes("model id"))return ZW({content:`${lZ} (${B}): ${A.message}`});if(A instanceof Error)return ZW({content:`${lZ}: ${A.message}`});return ZW({content:lZ})}function il1(A){if(A!=="refusal")return;return E1("tengu_refusal_api_response",{}),ZW({content:`${lZ}: Claude Code is unable to respond to this request, which appears to violate our Usage Policy (https://www.anthropic.com/legal/aup). Please double press esc to edit your last message or start a new session for Claude Code to assist with a different task.`})}function Eo0(A,B){return new Set([...A].filter((Q)=>!B.has(Q)))}function Uo0(A,B){return A.size>0&&B.size>0&&[...A].every((Q)=>B.has(Q))}V31();var AO="2025-06-18";var ZF1=[AO,"2025-03-26","2024-11-05","2024-10-07"],DF1="2.0",No0=d.union([d.string(),d.number().int()]),qo0=d.string(),MP6=d.object({progressToken:d.optional(No0)}).passthrough(),BV=d.object({_meta:d.optional(MP6)}).passthrough(),YW=d.object({method:d.string(),params:d.optional(BV)}),$t=d.object({_meta:d.optional(d.object({}).passthrough())}).passthrough(),hw=d.object({method:d.string(),params:d.optional($t)}),QV=d.object({_meta:d.optional(d.object({}).passthrough())}).passthrough(),YF1=d.union([d.string(),d.number().int()]),$o0=d.object({jsonrpc:d.literal(DF1),id:YF1}).merge(YW).strict(),WF1=(A)=>$o0.safeParse(A).success,Mo0=d.object({jsonrpc:d.literal(DF1)}).merge(hw).strict(),Lo0=(A)=>Mo0.safeParse(A).success,Ro0=d.object({jsonrpc:d.literal(DF1),id:YF1,result:QV}).strict(),Mt=(A)=>Ro0.safeParse(A).success,dD;(function(A){A[A.ConnectionClosed=-32000]="ConnectionClosed",A[A.RequestTimeout=-32001]="RequestTimeout",A[A.ParseError=-32700]="ParseError",A[A.InvalidRequest=-32600]="InvalidRequest",A[A.MethodNotFound=-32601]="MethodNotFound",A[A.InvalidParams=-32602]="InvalidParams",A[A.InternalError=-32603]="InternalError"})(dD||(dD={}));var Oo0=d.object({jsonrpc:d.literal(DF1),id:YF1,error:d.object({code:d.number().int(),message:d.string(),data:d.optional(d.unknown())})}).strict(),To0=(A)=>Oo0.safeParse(A).success,mw=d.union([$o0,Mo0,Ro0,Oo0]),Fq=QV.strict(),JF1=hw.extend({method:d.literal("notifications/cancelled"),params:$t.extend({requestId:YF1,reason:d.string().optional()})}),Lt=d.object({name:d.string(),title:d.optional(d.string())}).passthrough(),Po0=Lt.extend({version:d.string()}),LP6=d.object({experimental:d.optional(d.object({}).passthrough()),sampling:d.optional(d.object({}).passthrough()),elicitation:d.optional(d.object({}).passthrough()),roots:d.optional(d.object({listChanged:d.optional(d.boolean())}).passthrough())}).passthrough(),nl1=YW.extend({method:d.literal("initialize"),params:BV.extend({protocolVersion:d.string(),capabilities:LP6,clientInfo:Po0})});var RP6=d.object({experimental:d.optional(d.object({}).passthrough()),logging:d.optional(d.object({}).passthrough()),completions:d.optional(d.object({}).passthrough()),prompts:d.optional(d.object({listChanged:d.optional(d.boolean())}).passthrough()),resources:d.optional(d.object({subscribe:d.optional(d.boolean()),listChanged:d.optional(d.boolean())}).passthrough()),tools:d.optional(d.object({listChanged:d.optional(d.boolean())}).passthrough())}).passthrough(),al1=QV.extend({protocolVersion:d.string(),capabilities:RP6,serverInfo:Po0,instructions:d.optional(d.string())}),FF1=hw.extend({method:d.literal("notifications/initialized")}),So0=(A)=>FF1.safeParse(A).success,XF1=YW.extend({method:d.literal("ping")}),OP6=d.object({progress:d.number(),total:d.optional(d.number()),message:d.optional(d.string())}).passthrough(),VF1=hw.extend({method:d.literal("notifications/progress"),params:$t.merge(OP6).extend({progressToken:No0})}),CF1=YW.extend({params:BV.extend({cursor:d.optional(qo0)}).optional()}),KF1=QV.extend({nextCursor:d.optional(qo0)}),_o0=d.object({uri:d.string(),mimeType:d.optional(d.string()),_meta:d.optional(d.object({}).passthrough())}).passthrough(),jo0=_o0.extend({text:d.string()}),yo0=_o0.extend({blob:d.string().base64()}),ko0=Lt.extend({uri:d.string(),description:d.optional(d.string()),mimeType:d.optional(d.string()),_meta:d.optional(d.object({}).passthrough())}),TP6=Lt.extend({uriTemplate:d.string(),description:d.optional(d.string()),mimeType:d.optional(d.string()),_meta:d.optional(d.object({}).passthrough())}),PP6=CF1.extend({method:d.literal("resources/list")}),uj=KF1.extend({resources:d.array(ko0)}),SP6=CF1.extend({method:d.literal("resources/templates/list")}),sl1=KF1.extend({resourceTemplates:d.array(TP6)}),_P6=YW.extend({method:d.literal("resources/read"),params:BV.extend({uri:d.string()})}),Rt=QV.extend({contents:d.array(d.union([jo0,yo0]))}),jP6=hw.extend({method:d.literal("notifications/resources/list_changed")}),yP6=YW.extend({method:d.literal("resources/subscribe"),params:BV.extend({uri:d.string()})}),kP6=YW.extend({method:d.literal("resources/unsubscribe"),params:BV.extend({uri:d.string()})}),xP6=hw.extend({method:d.literal("notifications/resources/updated"),params:$t.extend({uri:d.string()})}),vP6=d.object({name:d.string(),description:d.optional(d.string()),required:d.optional(d.boolean())}).passthrough(),fP6=Lt.extend({description:d.optional(d.string()),arguments:d.optional(d.array(vP6)),_meta:d.optional(d.object({}).passthrough())}),bP6=CF1.extend({method:d.literal("prompts/list")}),Ot=KF1.extend({prompts:d.array(fP6)}),gP6=YW.extend({method:d.literal("prompts/get"),params:BV.extend({name:d.string(),arguments:d.optional(d.record(d.string()))})}),rl1=d.object({type:d.literal("text"),text:d.string(),_meta:d.optional(d.object({}).passthrough())}).passthrough(),ol1=d.object({type:d.literal("image"),data:d.string().base64(),mimeType:d.string(),_meta:d.optional(d.object({}).passthrough())}).passthrough(),tl1=d.object({type:d.literal("audio"),data:d.string().base64(),mimeType:d.string(),_meta:d.optional(d.object({}).passthrough())}).passthrough(),hP6=d.object({type:d.literal("resource"),resource:d.union([jo0,yo0]),_meta:d.optional(d.object({}).passthrough())}).passthrough(),mP6=ko0.extend({type:d.literal("resource_link")}),xo0=d.union([rl1,ol1,tl1,mP6,hP6]),dP6=d.object({role:d.enum(["user","assistant"]),content:xo0}).passthrough(),el1=QV.extend({description:d.optional(d.string()),messages:d.array(dP6)}),uP6=hw.extend({method:d.literal("notifications/prompts/list_changed")}),pP6=d.object({title:d.optional(d.string()),readOnlyHint:d.optional(d.boolean()),destructiveHint:d.optional(d.boolean()),idempotentHint:d.optional(d.boolean()),openWorldHint:d.optional(d.boolean())}).passthrough(),cP6=Lt.extend({description:d.optional(d.string()),inputSchema:d.object({type:d.literal("object"),properties:d.optional(d.object({}).passthrough()),required:d.optional(d.array(d.string()))}).passthrough(),outputSchema:d.optional(d.object({type:d.literal("object"),properties:d.optional(d.object({}).passthrough()),required:d.optional(d.array(d.string()))}).passthrough()),annotations:d.optional(pP6),_meta:d.optional(d.object({}).passthrough())}),Ai1=CF1.extend({method:d.literal("tools/list")}),Tt=KF1.extend({tools:d.array(cP6)}),fm=QV.extend({content:d.array(xo0).default([]),structuredContent:d.object({}).passthrough().optional(),isError:d.optional(d.boolean())}),Am8=fm.or(QV.extend({toolResult:d.unknown()})),Bi1=YW.extend({method:d.literal("tools/call"),params:BV.extend({name:d.string(),arguments:d.optional(d.record(d.unknown()))})}),lP6=hw.extend({method:d.literal("notifications/tools/list_changed")}),vo0=d.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),iP6=YW.extend({method:d.literal("logging/setLevel"),params:BV.extend({level:vo0})}),nP6=hw.extend({method:d.literal("notifications/message"),params:$t.extend({level:vo0,logger:d.optional(d.string()),data:d.unknown()})}),aP6=d.object({name:d.string().optional()}).passthrough(),sP6=d.object({hints:d.optional(d.array(aP6)),costPriority:d.optional(d.number().min(0).max(1)),speedPriority:d.optional(d.number().min(0).max(1)),intelligencePriority:d.optional(d.number().min(0).max(1))}).passthrough(),rP6=d.object({role:d.enum(["user","assistant"]),content:d.union([rl1,ol1,tl1])}).passthrough(),oP6=YW.extend({method:d.literal("sampling/createMessage"),params:BV.extend({messages:d.array(rP6),systemPrompt:d.optional(d.string()),includeContext:d.optional(d.enum(["none","thisServer","allServers"])),temperature:d.optional(d.number()),maxTokens:d.number().int(),stopSequences:d.optional(d.array(d.string())),metadata:d.optional(d.object({}).passthrough()),modelPreferences:d.optional(sP6)})}),Qi1=QV.extend({model:d.string(),stopReason:d.optional(d.enum(["endTurn","stopSequence","maxTokens"]).or(d.string())),role:d.enum(["user","assistant"]),content:d.discriminatedUnion("type",[rl1,ol1,tl1])}),tP6=d.object({type:d.literal("boolean"),title:d.optional(d.string()),description:d.optional(d.string()),default:d.optional(d.boolean())}).passthrough(),eP6=d.object({type:d.literal("string"),title:d.optional(d.string()),description:d.optional(d.string()),minLength:d.optional(d.number()),maxLength:d.optional(d.number()),format:d.optional(d.enum(["email","uri","date","date-time"]))}).passthrough(),AS6=d.object({type:d.enum(["number","integer"]),title:d.optional(d.string()),description:d.optional(d.string()),minimum:d.optional(d.number()),maximum:d.optional(d.number())}).passthrough(),BS6=d.object({type:d.literal("string"),title:d.optional(d.string()),description:d.optional(d.string()),enum:d.array(d.string()),enumNames:d.optional(d.array(d.string()))}).passthrough(),QS6=d.union([tP6,eP6,AS6,BS6]),IS6=YW.extend({method:d.literal("elicitation/create"),params:BV.extend({message:d.string(),requestedSchema:d.object({type:d.literal("object"),properties:d.record(d.string(),QS6),required:d.optional(d.array(d.string()))}).passthrough()})}),Ii1=QV.extend({action:d.enum(["accept","reject","cancel"]),content:d.optional(d.record(d.string(),d.unknown()))}),GS6=d.object({type:d.literal("ref/resource"),uri:d.string()}).passthrough();var ZS6=d.object({type:d.literal("ref/prompt"),name:d.string()}).passthrough(),DS6=YW.extend({method:d.literal("completion/complete"),params:BV.extend({ref:d.union([ZS6,GS6]),argument:d.object({name:d.string(),value:d.string()}).passthrough(),context:d.optional(d.object({arguments:d.optional(d.record(d.string(),d.string()))}))})}),Gi1=QV.extend({completion:d.object({values:d.array(d.string()).max(100),total:d.optional(d.number().int()),hasMore:d.optional(d.boolean())}).passthrough()}),YS6=d.object({uri:d.string().startsWith("file://"),name:d.optional(d.string()),_meta:d.optional(d.object({}).passthrough())}).passthrough(),Zi1=YW.extend({method:d.literal("roots/list")}),Di1=QV.extend({roots:d.array(YS6)}),WS6=hw.extend({method:d.literal("notifications/roots/list_changed")}),Bm8=d.union([XF1,nl1,DS6,iP6,gP6,bP6,PP6,SP6,_P6,yP6,kP6,Bi1,Ai1]),Qm8=d.union([JF1,VF1,FF1,WS6]),Im8=d.union([Fq,Qi1,Ii1,Di1]),Gm8=d.union([XF1,oP6,IS6,Zi1]),Zm8=d.union([JF1,VF1,nP6,xP6,jP6,lP6,uP6]),Dm8=d.union([Fq,al1,Gi1,el1,Ot,uj,sl1,Rt,fm,Tt]);class uD extends Error{constructor(A,B,Q){super(`MCP error ${A}: ${B}`);this.code=A,this.data=Q,this.name="McpError"}}var JS6=60000;class Pt{constructor(A){this._options=A,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(JF1,(B)=>{let Q=this._requestHandlerAbortControllers.get(B.params.requestId);Q===null||Q===void 0||Q.abort(B.params.reason)}),this.setNotificationHandler(VF1,(B)=>{this._onprogress(B)}),this.setRequestHandler(XF1,(B)=>({}))}_setupTimeout(A,B,Q,I,G=!1){this._timeoutInfo.set(A,{timeoutId:setTimeout(I,B),startTime:Date.now(),timeout:B,maxTotalTimeout:Q,resetTimeoutOnProgress:G,onTimeout:I})}_resetTimeout(A){let B=this._timeoutInfo.get(A);if(!B)return!1;let Q=Date.now()-B.startTime;if(B.maxTotalTimeout&&Q>=B.maxTotalTimeout)throw this._timeoutInfo.delete(A),new uD(dD.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:B.maxTotalTimeout,totalElapsed:Q});return clearTimeout(B.timeoutId),B.timeoutId=setTimeout(B.onTimeout,B.timeout),!0}_cleanupTimeout(A){let B=this._timeoutInfo.get(A);if(B)clearTimeout(B.timeoutId),this._timeoutInfo.delete(A)}async connect(A){this._transport=A,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=(B)=>{this._onerror(B)},this._transport.onmessage=(B,Q)=>{if(Mt(B)||To0(B))this._onresponse(B);else if(WF1(B))this._onrequest(B,Q);else if(Lo0(B))this._onnotification(B);else this._onerror(new Error(`Unknown message type: ${JSON.stringify(B)}`))},await this._transport.start()}_onclose(){var A;let B=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(A=this.onclose)===null||A===void 0||A.call(this);let Q=new uD(dD.ConnectionClosed,"Connection closed");for(let I of B.values())I(Q)}_onerror(A){var B;(B=this.onerror)===null||B===void 0||B.call(this,A)}_onnotification(A){var B;let Q=(B=this._notificationHandlers.get(A.method))!==null&&B!==void 0?B:this.fallbackNotificationHandler;if(Q===void 0)return;Promise.resolve().then(()=>Q(A)).catch((I)=>this._onerror(new Error(`Uncaught error in notification handler: ${I}`)))}_onrequest(A,B){var Q,I,G,Z;let D=(Q=this._requestHandlers.get(A.method))!==null&&Q!==void 0?Q:this.fallbackRequestHandler;if(D===void 0){(I=this._transport)===null||I===void 0||I.send({jsonrpc:"2.0",id:A.id,error:{code:dD.MethodNotFound,message:"Method not found"}}).catch((J)=>this._onerror(new Error(`Failed to send an error response: ${J}`)));return}let Y=new AbortController;this._requestHandlerAbortControllers.set(A.id,Y);let W={signal:Y.signal,sessionId:(G=this._transport)===null||G===void 0?void 0:G.sessionId,_meta:(Z=A.params)===null||Z===void 0?void 0:Z._meta,sendNotification:(J)=>this.notification(J,{relatedRequestId:A.id}),sendRequest:(J,F,X)=>this.request(J,F,{...X,relatedRequestId:A.id}),authInfo:B===null||B===void 0?void 0:B.authInfo,requestId:A.id};Promise.resolve().then(()=>D(A,W)).then((J)=>{var F;if(Y.signal.aborted)return;return(F=this._transport)===null||F===void 0?void 0:F.send({result:J,jsonrpc:"2.0",id:A.id})},(J)=>{var F,X;if(Y.signal.aborted)return;return(F=this._transport)===null||F===void 0?void 0:F.send({jsonrpc:"2.0",id:A.id,error:{code:Number.isSafeInteger(J.code)?J.code:dD.InternalError,message:(X=J.message)!==null&&X!==void 0?X:"Internal error"}})}).catch((J)=>this._onerror(new Error(`Failed to send response: ${J}`))).finally(()=>{this._requestHandlerAbortControllers.delete(A.id)})}_onprogress(A){let{progressToken:B,...Q}=A.params,I=Number(B),G=this._progressHandlers.get(I);if(!G){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(A)}`));return}let Z=this._responseHandlers.get(I),D=this._timeoutInfo.get(I);if(D&&Z&&D.resetTimeoutOnProgress)try{this._resetTimeout(I)}catch(Y){Z(Y);return}G(Q)}_onresponse(A){let B=Number(A.id),Q=this._responseHandlers.get(B);if(Q===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(A)}`));return}if(this._responseHandlers.delete(B),this._progressHandlers.delete(B),this._cleanupTimeout(B),Mt(A))Q(A);else{let I=new uD(A.error.code,A.error.message,A.error.data);Q(I)}}get transport(){return this._transport}async close(){var A;await((A=this._transport)===null||A===void 0?void 0:A.close())}request(A,B,Q){let{relatedRequestId:I,resumptionToken:G,onresumptiontoken:Z}=Q!==null&&Q!==void 0?Q:{};return new Promise((D,Y)=>{var W,J,F,X,V,C;if(!this._transport){Y(new Error("Not connected"));return}if(((W=this._options)===null||W===void 0?void 0:W.enforceStrictCapabilities)===!0)this.assertCapabilityForMethod(A.method);(J=Q===null||Q===void 0?void 0:Q.signal)===null||J===void 0||J.throwIfAborted();let K=this._requestMessageId++,z={...A,jsonrpc:"2.0",id:K};if(Q===null||Q===void 0?void 0:Q.onprogress)this._progressHandlers.set(K,Q.onprogress),z.params={...A.params,_meta:{...((F=A.params)===null||F===void 0?void 0:F._meta)||{},progressToken:K}};let U=(L)=>{var T;this._responseHandlers.delete(K),this._progressHandlers.delete(K),this._cleanupTimeout(K),(T=this._transport)===null||T===void 0||T.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:K,reason:String(L)}},{relatedRequestId:I,resumptionToken:G,onresumptiontoken:Z}).catch((M)=>this._onerror(new Error(`Failed to send cancellation: ${M}`))),Y(L)};this._responseHandlers.set(K,(L)=>{var T;if((T=Q===null||Q===void 0?void 0:Q.signal)===null||T===void 0?void 0:T.aborted)return;if(L instanceof Error)return Y(L);try{let M=B.parse(L.result);D(M)}catch(M){Y(M)}}),(X=Q===null||Q===void 0?void 0:Q.signal)===null||X===void 0||X.addEventListener("abort",()=>{var L;U((L=Q===null||Q===void 0?void 0:Q.signal)===null||L===void 0?void 0:L.reason)});let $=(V=Q===null||Q===void 0?void 0:Q.timeout)!==null&&V!==void 0?V:JS6,R=()=>U(new uD(dD.RequestTimeout,"Request timed out",{timeout:$}));this._setupTimeout(K,$,Q===null||Q===void 0?void 0:Q.maxTotalTimeout,R,(C=Q===null||Q===void 0?void 0:Q.resetTimeoutOnProgress)!==null&&C!==void 0?C:!1),this._transport.send(z,{relatedRequestId:I,resumptionToken:G,onresumptiontoken:Z}).catch((L)=>{this._cleanupTimeout(K),Y(L)})})}async notification(A,B){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(A.method);let Q={...A,jsonrpc:"2.0"};await this._transport.send(Q,B)}setRequestHandler(A,B){let Q=A.shape.method.value;this.assertRequestHandlerCapability(Q),this._requestHandlers.set(Q,(I,G)=>{return Promise.resolve(B(A.parse(I),G))})}removeRequestHandler(A){this._requestHandlers.delete(A)}assertCanSetRequestHandler(A){if(this._requestHandlers.has(A))throw new Error(`A request handler for ${A} already exists, which would be overridden`)}setNotificationHandler(A,B){this._notificationHandlers.set(A.shape.method.value,(Q)=>Promise.resolve(B(A.parse(Q))))}removeNotificationHandler(A){this._notificationHandlers.delete(A)}}function HF1(A,B){return Object.entries(B).reduce((Q,[I,G])=>{if(G&&typeof G==="object")Q[I]=Q[I]?{...Q[I],...G}:G;else Q[I]=G;return Q},{...A})}var fe0=Y1(ji1(),1);class yi1 extends Pt{constructor(A,B){var Q;super(B);this._clientInfo=A,this._cachedToolOutputValidators=new Map,this._capabilities=(Q=B===null||B===void 0?void 0:B.capabilities)!==null&&Q!==void 0?Q:{},this._ajv=new fe0.default}registerCapabilities(A){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=HF1(this._capabilities,A)}assertCapability(A,B){var Q;if(!((Q=this._serverCapabilities)===null||Q===void 0?void 0:Q[A]))throw new Error(`Server does not support ${A} (required for ${B})`)}async connect(A,B){if(await super.connect(A),A.sessionId!==void 0)return;try{let Q=await this.request({method:"initialize",params:{protocolVersion:AO,capabilities:this._capabilities,clientInfo:this._clientInfo}},al1,B);if(Q===void 0)throw new Error(`Server sent invalid initialize result: ${Q}`);if(!ZF1.includes(Q.protocolVersion))throw new Error(`Server's protocol version is not supported: ${Q.protocolVersion}`);if(this._serverCapabilities=Q.capabilities,this._serverVersion=Q.serverInfo,A.setProtocolVersion)A.setProtocolVersion(Q.protocolVersion);this._instructions=Q.instructions,await this.notification({method:"notifications/initialized"})}catch(Q){throw this.close(),Q}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(A){var B,Q,I,G,Z;switch(A){case"logging/setLevel":if(!((B=this._serverCapabilities)===null||B===void 0?void 0:B.logging))throw new Error(`Server does not support logging (required for ${A})`);break;case"prompts/get":case"prompts/list":if(!((Q=this._serverCapabilities)===null||Q===void 0?void 0:Q.prompts))throw new Error(`Server does not support prompts (required for ${A})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!((I=this._serverCapabilities)===null||I===void 0?void 0:I.resources))throw new Error(`Server does not support resources (required for ${A})`);if(A==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${A})`);break;case"tools/call":case"tools/list":if(!((G=this._serverCapabilities)===null||G===void 0?void 0:G.tools))throw new Error(`Server does not support tools (required for ${A})`);break;case"completion/complete":if(!((Z=this._serverCapabilities)===null||Z===void 0?void 0:Z.completions))throw new Error(`Server does not support completions (required for ${A})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(A){var B;switch(A){case"notifications/roots/list_changed":if(!((B=this._capabilities.roots)===null||B===void 0?void 0:B.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${A})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(A){switch(A){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${A})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${A})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${A})`);break;case"ping":break}}async ping(A){return this.request({method:"ping"},Fq,A)}async complete(A,B){return this.request({method:"completion/complete",params:A},Gi1,B)}async setLoggingLevel(A,B){return this.request({method:"logging/setLevel",params:{level:A}},Fq,B)}async getPrompt(A,B){return this.request({method:"prompts/get",params:A},el1,B)}async listPrompts(A,B){return this.request({method:"prompts/list",params:A},Ot,B)}async listResources(A,B){return this.request({method:"resources/list",params:A},uj,B)}async listResourceTemplates(A,B){return this.request({method:"resources/templates/list",params:A},sl1,B)}async readResource(A,B){return this.request({method:"resources/read",params:A},Rt,B)}async subscribeResource(A,B){return this.request({method:"resources/subscribe",params:A},Fq,B)}async unsubscribeResource(A,B){return this.request({method:"resources/unsubscribe",params:A},Fq,B)}async callTool(A,B=fm,Q){let I=await this.request({method:"tools/call",params:A},B,Q),G=this.getToolOutputValidator(A.name);if(G){if(!I.structuredContent&&!I.isError)throw new uD(dD.InvalidRequest,`Tool ${A.name} has an output schema but did not return structured content`);if(I.structuredContent)try{if(!G(I.structuredContent))throw new uD(dD.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(G.errors)}`)}catch(Z){if(Z instanceof uD)throw Z;throw new uD(dD.InvalidParams,`Failed to validate structured content: ${Z instanceof Error?Z.message:String(Z)}`)}}return I}cacheToolOutputSchemas(A){this._cachedToolOutputValidators.clear();for(let B of A)if(B.outputSchema)try{let Q=this._ajv.compile(B.outputSchema);this._cachedToolOutputValidators.set(B.name,Q)}catch(Q){}}getToolOutputValidator(A){return this._cachedToolOutputValidators.get(A)}async listTools(A,B){let Q=await this.request({method:"tools/list",params:A},Tt,B);return this.cacheToolOutputSchemas(Q.tools),Q}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}var R12=Y1(L12(),1);import fF1 from"node:process";import{PassThrough as Ej6}from"node:stream";class _t{append(A){this._buffer=this._buffer?Buffer.concat([this._buffer,A]):A}readMessage(){if(!this._buffer)return null;let A=this._buffer.indexOf(`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`}});function Yj2(){return}async function Wj2({setMessages:A,readFileState:B}){await $3(),A([]),_W.cache.clear?.(),sG.cache.clear?.(),OX(W4()),Object.keys(B).forEach((Q)=>{delete B[Q]}),G4A()}var K$5={type:"local",name:"clear",description:"Clear conversation history and free up context",isEnabled:()=>!0,isHidden:!1,async call(A,B){return Wj2(B),""},userFacingName(){return"clear"}},Jj2=K$5;var H$5=Y1(N1(),1);var z$5={type:"local",name:"compact",description:"Clear conversation history but keep a summary in context. Optional: /compact [instructions for summarization]",isEnabled:()=>!0,isHidden:!1,argumentHint:"<optional custom summarization instructions>",async call(A,B){let{abortController:Q,messages:I}=B;if(I.length===0)throw new Error("No messages to compact");let G=A.trim();try{return await tH1(I,B,!1,G),_W.cache.clear?.(),sG.cache.clear?.(),"Compacted. ctrl+r to see full summary"}catch(Z){if(Q.signal.aborted)throw new Error("Compaction canceled.");else if(Z instanceof Error&&Z.message===s11)throw new Error(s11);else throw d1(Z instanceof Error?Z:new Error(String(Z))),new Error(`Error during compaction: ${Z}`)}},userFacingName(){return"compact"}},Fj2=z$5;var o9=Y1(N1(),1),eA1=Y1(N1(),1);var p4=Y1(N1(),1);function vw1({onThemeSelect:A,showIntroText:B=!1,helpText:Q="",showHelpTextBelow:I=!1,hideEscToCancel:G=!1,skipExitHandling:Z=!1}){let[D,Y]=k9(),W=w2(Z?()=>{}:void 0),F=p4.createElement(h,{flexDirection:"column",gap:1,paddingLeft:1},B&&p4.createElement(S,null,"Let's get started."),p4.createElement(h,{flexDirection:"column"},p4.createElement(S,{bold:!0},"Choose the text style that looks best with your terminal:"),Q&&!I&&p4.createElement(S,{dimColor:!0},Q)),p4.createElement(e0,{options:[{label:"Dark mode",value:"dark"},{label:"Light mode",value:"light"},{label:"Dark mode (colorblind-friendly)",value:"dark-daltonized"},{label:"Light mode (colorblind-friendly)",value:"light-daltonized"},{label:"Dark mode (ANSI colors only)",value:"dark-ansi"},{label:"Light mode (ANSI colors only)",value:"light-ansi"}],onFocus:(X)=>{Y(X)},onChange:A,onCancel:Z?()=>{}:async()=>{await yI(0)},visibleOptionCount:6,defaultValue:D}),p4.createElement(h,{flexDirection:"column",paddingTop:1},p4.createElement(S,{bold:!0},"Preview"),p4.createElement(h,{paddingLeft:1,marginRight:1,borderStyle:"round",flexDirection:"column"},p4.createElement(EW,{patch:{oldStart:1,newStart:1,oldLines:3,newLines:3,lines:["function greet() {",'-  console.log("Hello, World!");','+  console.log("Hello, Claude!");',"}"]},dim:!1}))));if(!B)return p4.createElement(p4.Fragment,null,p4.createElement(h,{flexDirection:"column",borderStyle:"round",paddingX:1,marginTop:1},F),I&&Q&&p4.createElement(h,{marginLeft:3,marginTop:1},p4.createElement(S,{dimColor:!0},Q)),!G&&p4.createElement(h,{marginLeft:3},p4.createElement(S,{dimColor:!0},W.pending?p4.createElement(p4.Fragment,null,"Press ",W.keyName," again to exit"):p4.createElement(p4.Fragment,null,"Esc to cancel"))));return F}var i8=Y1(N1(),1),Xj2=Y1(N1(),1);var z2A="__NO_PREFERENCE__";function fw1({initial:A,onSelect:B}){let Q=A===null?z2A:A,[I,G]=Xj2.useState(Q),Z=HD0(),D=w2();return i8.createElement(h,{flexDirection:"column"},i8.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"remember",paddingX:2,paddingY:1,width:"100%"},i8.createElement(h,{marginBottom:1,flexDirection:"column"},i8.createElement(S,{color:"remember",bold:!0},"Select Model"),i8.createElement(S,{dimColor:!0},"Switch between Claude models. Applies to this session and future Claude Code sessions. For custom model names, specify with --model.")),i8.createElement(h,{flexDirection:"column",paddingX:1},i8.createElement(e0,{defaultValue:I,focusValue:Z.some((Y)=>Y.value===I)?I:Z[0]?.value??void 0,options:Z.map((Y)=>({...Y,value:Y.value===null?z2A:Y.value})),onFocus:(Y)=>G(Y),onChange:(Y)=>B(Y===z2A?null:Y),onCancel:()=>{}}))),i8.createElement(h,{paddingX:1},i8.createElement(S,{dimColor:!0},D.pending?i8.createElement(i8.Fragment,null,"Press ",D.keyName," again to exit"):i8.createElement(i8.Fragment,null,"Enter to confirm  Esc to exit"))))}var GD=Y1(N1(),1);function bw1({onDone:A}){GD.default.useEffect(()=>{E1("claude_md_includes_dialog_shown",{})},[]);function B(I){let G=a9();if(I==="no")E1("claude_md_external_includes_dialog_declined",{}),E5({...G,hasClaudeMdExternalIncludesApproved:!1,hasClaudeMdExternalIncludesWarningShown:!0});else E1("claude_md_external_includes_dialog_accepted",{}),E5({...G,hasClaudeMdExternalIncludesApproved:!0,hasClaudeMdExternalIncludesWarningShown:!0});A()}let Q=w2();return V0((I,G)=>{if(G.escape){B("no");return}}),GD.default.createElement(GD.default.Fragment,null,GD.default.createElement(h,{flexDirection:"column",gap:1,padding:1,borderStyle:"round",borderColor:"warning"},GD.default.createElement(S,{bold:!0,color:"warning"},"Allow external CLAUDE.md file imports?"),GD.default.createElement(S,null,"This project's CLAUDE.md imports files outside the current working directory. Never allow this for third-party repositories."),GD.default.createElement(S,{dimColor:!0},"Important: Only use ",r0," with files you trust. Accessing untrusted files may pose security risks"," ",GD.default.createElement(nQ,{url:"https://docs.anthropic.com/s/claude-code-security"})," "),GD.default.createElement(e0,{options:[{label:"Yes, allow external imports",value:"yes"},{label:"No, disable external imports",value:"no"}],onChange:(I)=>B(I),onCancel:()=>B("no")})),GD.default.createElement(h,{marginLeft:3},GD.default.createElement(S,{dimColor:!0},Q.pending?GD.default.createElement(GD.default.Fragment,null,"Press ",Q.keyName," again to exit"):GD.default.createElement(GD.default.Fragment,null,"Enter to confirm  Esc to disable external includes"))))}function Vj2({onClose:A,isConnectedToIde:B}){let[Q,I]=k9(),[G,Z]=eA1.useState(FA()),D=o9.useRef(FA()),[Y,W]=eA1.useState(0),J=w2(),[{mainLoopModel:F,todoFeatureEnabled:X,verbose:V},C]=B8(),[K,z]=eA1.useState({}),[U,$]=eA1.useState(null),R=g1A();async function L(x){E1("tengu_config_model_changed",{from_model:F,to_model:x}),C((k)=>({...k,mainLoopModel:x})),z((k)=>{let a=M_(x);if("model"in k){let{model:u,...Z1}=k;return{...Z1,model:a}}return{...k,model:a}})}function T(x){C((p)=>({...p,verbose:x})),z((p)=>{if("verbose"in p){let{verbose:k,...a}=p;return a}return{...p,verbose:x}})}function M(x){C((p)=>({...p,todoFeatureEnabled:x})),z((p)=>{if("Todo List Enabled"in p){let{"Todo List Enabled":k,...a}=p;return a}return{...p,"Todo List Enabled":x}})}let P=[{id:"autoCompactEnabled",label:"Auto-compact",value:G.autoCompactEnabled,type:"boolean",onChange(x){let p={...FA(),autoCompactEnabled:x};b0(p),Z(p),E1("tengu_auto_compact_setting_changed",{enabled:x})}},{id:"todoFeatureEnabled",label:"Use todo list",value:X,type:"boolean",onChange:M},{id:"verbose",label:"Verbose output",value:V,type:"boolean",onChange:T},{id:"theme",label:"Theme",value:Q,type:"managedEnum",onChange:I},{id:"notifChannel",label:"Notifications",value:G.preferredNotifChannel,options:["auto","iterm2","terminal_bell","iterm2_with_bell","kitty","notifications_disabled"],type:"enum",onChange(x){let p={...FA(),preferredNotifChannel:x};b0(p),Z(p)}},{id:"editorMode",label:"Editor mode",value:G.editorMode==="emacs"?"normal":G.editorMode||"normal",options:["normal","vim"],type:"enum",onChange(x){let p={...FA(),editorMode:x};b0(p),Z(p),E1("tengu_editor_mode_changed",{mode:x,source:"config_panel"})}},{id:"model",label:"Model",value:F===null?"Default (recommended)":F,type:"managedEnum",onChange:L},...B?[{id:"diffTool",label:"Diff tool",value:G.diffTool??"auto",options:["terminal","auto"],type:"enum",onChange(x){let p={...FA(),diffTool:x};b0(p),Z(p),E1("tengu_diff_tool_changed",{tool:x,source:"config_panel"})}},{id:"autoConnectIde",label:"Auto-connect to IDE",value:G.autoConnectIde??!1,type:"boolean",onChange(x){let p={...FA(),autoConnectIde:x};b0(p),Z(p),E1("tengu_auto_connect_ide_changed",{enabled:x,source:"config_panel"})}}]:[],...R?[{id:"showExternalIncludesDialog",label:"External CLAUDE.md includes",value:(()=>{if(a9().hasClaudeMdExternalIncludesApproved)return"true";else return"false"})(),type:"managedEnum",onChange(){}}]:[],...process.env.ANTHROPIC_API_KEY?[{id:"apiKey",label:`Use custom API key: ${LA.bold(UJ(process.env.ANTHROPIC_API_KEY))}`,value:Boolean(process.env.ANTHROPIC_API_KEY&&G.customApiKeyResponses?.approved?.includes(UJ(process.env.ANTHROPIC_API_KEY))),type:"boolean",onChange(x){let p={...FA()};if(!p.customApiKeyResponses)p.customApiKeyResponses={approved:[],rejected:[]};if(!p.customApiKeyResponses.approved)p.customApiKeyResponses.approved=[];if(!p.customApiKeyResponses.rejected)p.customApiKeyResponses.rejected=[];if(process.env.ANTHROPIC_API_KEY){let k=UJ(process.env.ANTHROPIC_API_KEY);if(x)p.customApiKeyResponses.approved=[...p.customApiKeyResponses.approved.filter((a)=>a!==k),k],p.customApiKeyResponses.rejected=p.customApiKeyResponses.rejected.filter((a)=>a!==k);else p.customApiKeyResponses.approved=p.customApiKeyResponses.approved.filter((a)=>a!==k),p.customApiKeyResponses.rejected=[...p.customApiKeyResponses.rejected.filter((a)=>a!==k),k]}b0(p),Z(p)}}]:[],...[]];return V0((x,p)=>{if(p.escape){if(U!==null){$(null);return}let a=Object.entries(K).map(([B1,v])=>{return E1("tengu_config_changed",{key:B1,value:v}),`Set ${B1} to ${LA.bold(v)}`}),u=Boolean(process.env.ANTHROPIC_API_KEY&&D.current.customApiKeyResponses?.approved?.includes(UJ(process.env.ANTHROPIC_API_KEY))),Z1=Boolean(process.env.ANTHROPIC_API_KEY&&G.customApiKeyResponses?.approved?.includes(UJ(process.env.ANTHROPIC_API_KEY)));if(u!==Z1)a.push(`${Z1?"Enabled":"Disabled"} custom API key`),E1("tengu_config_changed",{key:"env.ANTHROPIC_API_KEY",value:Z1});if(G.theme!==D.current.theme)a.push(`Set theme to ${LA.bold(G.theme)}`);if(G.preferredNotifChannel!==D.current.preferredNotifChannel)a.push(`Set notifications to ${LA.bold(G.preferredNotifChannel)}`);if(G.editorMode!==D.current.editorMode)a.push(`Set editor mode to ${LA.bold(G.editorMode||"emacs")}`);if(G.diffTool!==D.current.diffTool)a.push(`Set diff tool to ${LA.bold(G.diffTool)}`);if(G.autoConnectIde!==D.current.autoConnectIde)a.push(`${G.autoConnectIde?"Enabled":"Disabled"} auto-connect to IDE`);if(G.autoCompactEnabled!==D.current.autoCompactEnabled)a.push(`${G.autoCompactEnabled?"Enabled":"Disabled"} auto-compact`);if(a.length>0)A(a.join(`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:    `))}var E9=Y1(N1(),1),CF=Y1(N1(),1);var wT=Y1(N1(),1);function by2(A,B,Q){let[I,G]=wT.useState(A),Z=wT.useRef(),D=wT.useRef(A);return wT.useEffect(()=>{D.current=A},[A]),wT.useEffect(()=>{if(Z.current)clearTimeout(Z.current);return Z.current=setTimeout(()=>{G(D.current())},Q),()=>{if(Z.current)clearTimeout(Z.current)}},[...B,Q]),I}var AE1=Y1(N1(),1);async function dM5(){try{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX)return!0;return await h4.head("https://www.google.com",{timeout:5000,headers:{"Cache-Control":"no-cache"}}),!0}catch{return!1}}function c2A(A){let B=Lm()?30000:1000,Q=A??B,[I,G]=AE1.useState(null);return AE1.useEffect(()=>{let Z=!0;if(process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return;let D=async()=>{if(!Z)return;let W=await dM5();if(Z)G(W)};D();let Y=setInterval(D,Q);return()=>{Z=!1,clearInterval(Y)}},[Q]),{isConnected:I}}function uM5(){if(process.env.TERM==="xterm-ghostty")return["","","","","","*"];return process.platform==="darwin"?["","","","","",""]:["","","*","","",""]}var gy2=uM5(),BE1=[...gy2,...[...gy2].reverse()],pM5=["Accomplishing","Actioning","Actualizing","Baking","Booping","Brewing","Calculating","Cerebrating","Channelling","Churning","Clauding","Coalescing","Cogitating","Computing","Combobulating","Concocting","Conjuring","Considering","Contemplating","Cooking","Crafting","Creating","Crunching","Deciphering","Deliberating","Determining","Discombobulating","Divining","Doing","Effecting","Elucidating","Enchanting","Envisioning","Finagling","Flibbertigibbeting","Forging","Forming","Frolicking","Generating","Germinating","Hatching","Herding","Honking","Hustling","Ideating","Imagining","Incubating","Inferring","Jiving","Manifesting","Marinating","Meandering","Moseying","Mulling","Mustering","Musing","Noodling","Percolating","Perusing","Philosophising","Pontificating","Pondering","Processing","Puttering","Puzzling","Reticulating","Ruminating","Scheming","Schlepping","Shimmying","Shucking","Simmering","Smooshing","Spelunking","Spinning","Stewing","Sussing","Synthesizing","Thinking","Tinkering","Transmuting","Unfurling","Unravelling","Vibing","Wandering","Whirring","Wibbling","Wizarding","Working","Wrangling"];function ly({mode:A,haikuWords:B,currentResponseLength:Q,overrideMessage:I}){let[G,Z]=CF.useState(0),[D,Y]=CF.useState(0),[W,J]=CF.useState(0),{isConnected:F}=c2A(),X=by2(()=>LP(B.length>0?B:pM5),[B.length],1000),V=I||X,C=CF.useRef(Date.now()),K=CF.useRef(Q);CF.useEffect(()=>{K.current=Q},[Q]),qV(()=>{if(!F){Z(4);return}Z(($)=>$+1)},120),qV(()=>{J(($)=>{let R=K.current-$;if(R<=0)return $;let L;if(R<70)L=1;else if(R<200)L=Math.max(2,Math.ceil(R*0.08));else L=18;return Math.min($+L,K.current)})},10),qV(()=>{Y(Math.floor((Date.now()-C.current)/1000))},10);let z=[E9.createElement(S,{color:"secondaryText",key:"elapsedTime"},D,"s"),E9.createElement(h,{flexDirection:"row",key:"tokens"},E9.createElement(cM5,{mode:A,key:"spinnerMode"}),E9.createElement(S,{color:"secondaryText"},hG(Math.round(W/4))," tokens")),E9.createElement(h,{key:"esc"},E9.createElement(S,{color:"secondaryText",bold:!0},"esc"," "),E9.createElement(S,{color:"secondaryText"},"to interrupt"))];if(F===!1)z.push(E9.createElement(h,{key:"offline"},E9.createElement(S,{color:"error",bold:!0},"offline")));let U=F===!1?"secondaryText":"claude";return E9.createElement(h,{flexDirection:"row",flexWrap:"wrap",marginTop:1,width:"100%"},E9.createElement(h,{flexWrap:"wrap",height:1,width:2,key:"spinner"},E9.createElement(S,{color:U},BE1[G%BE1.length])),E9.createElement(S,{color:U,key:"message"},V,""," "),E9.createElement(S,{color:"secondaryText"},"("),wW(z,($)=>E9.createElement(S,{color:"secondaryText",key:`separator-${$}`}," ",""," ")),E9.createElement(S,{color:"secondaryText"},")"))}function cM5({mode:A}){switch(A){case"tool-input":return E9.createElement(lM5,null);case"tool-use":return E9.createElement(h,{flexWrap:"wrap",flexGrow:0,height:1,width:2},E9.createElement(S,{color:"secondaryText"},""));case"responding":return E9.createElement(h,{width:2},E9.createElement(S,{color:"secondaryText"},Y0.arrowDown));case"thinking":return E9.createElement(h,{width:2},E9.createElement(S,{color:"secondaryText"},Y0.arrowDown));case"requesting":return E9.createElement(h,{width:2},E9.createElement(S,{color:"secondaryText"},Y0.arrowUp))}}function lM5(){let[A,B]=CF.useState(!0);return qV(()=>{B((Q)=>!Q)},500),E9.createElement(h,{flexWrap:"wrap",flexGrow:0,height:1,width:2},E9.createElement(S,{color:"secondaryText"},A?"":" "))}function QY(){let[A,B]=CF.useState(0),{isConnected:Q}=c2A();return qV(()=>{B((G)=>(G+1)%BE1.length)},120),E9.createElement(h,{flexWrap:"wrap",height:1,width:2},E9.createElement(S,{color:Q===!1?"secondaryText":"text"},BE1[A]))}var iM5=new Set(["Analyzing","Blocking","Buffering","Capturing","Connecting","Crashing","Debugging","Diagnosing","Disconnecting","Erroring","Failing","Fixing","Freezing","Hanging","Investigating","Lagging","Loading","Logging","Monitoring","Patching","Rebooting","Recording","Recovering","Repairing","Resetting","Restarting","Restoring","Retrying","Stalling","Tracking","Troubleshooting","Waiting","Aborting","Canceling","Deleting","Destroying","Erasing","Exiting","Killing","Obliterating","Purging","Removing","Stopping","Terminating","Wiping","Breaching","Infiltrating","Invading","Penetrating","Violating","Authenticating","Authorizing","Backing","Bootstrapping","Branching","Building","Bundling","Caching","Clearing","Cloning","Clustering","Committing","Compiling","Configuring","Containerizing","Demoting","Deploying","Dockerizing","Downgrading","Draining","Executing","Fetching","Flushing","Formatting","Indexing","Initializing","Installing","Launching","Linting","Merging","Migrating","Minifying","Optimizing","Orchestrating","Packaging","Promoting","Provisioning","Publishing","Pulling","Pushing","Rebuilding","Redeploying","Refactoring","Releasing","Reverting","Rolling","Running","Scaffolding","Scaling","Shipping","Staging","Starting","Synchronizing","Syncing","Testing","Transpiling","Uninstalling","Updating","Upgrading","Validating","Verifying"]);function hy2(A){let[B,Q]=CF.useState([]),I=Rz1(async(G)=>{if(VY0())return;try{let Z=await tZ({systemPrompt:["Analyze this message and come up with a single positive, cheerful and delightful verb in gerund form that's related to the message. Only include the word with no other text or punctuation. The word should have the first letter capitalized. Add some whimsy and surprise to entertain the user. Ensure the word is highly relevant to the user's message. Synonyms are welcome, including obscure words. Be careful to avoid words that might look alarming or concerning to the software engineer seeing it as a status notification, such as Connecting, Disconnecting, Retrying, Lagging, Freezing, etc. NEVER use a destructive word, such as Terminating, Killing, Deleting, Destroying, Stopping, Exiting, or similar. NEVER use a word that may be derogatory, offensive, or inappropriate in a non-coding context, such as Penetrating."],userPrompt:G,enablePromptCaching:!0,isNonInteractiveSession:!1,temperature:1,promptCategory:"spinner"});if(Z?.message?.content){let Y=(Array.isArray(Z.message.content)?Z.message.content.filter((W)=>W.type==="text").map((W)=>W.text).join(""):Z.message.content).trim().replace(/[^\w]/g,"");if(Y.length<=20&&!Y.includes(" ")&&!iM5.has(Y))Q((W)=>[Y,...W.slice(0,9)])}}catch(Z){d1(Z instanceof Error?Z:new Error(`Error generating haiku word: ${String(Z)}`))}},600);return CF.useEffect(()=>{if(!A)Q([])},[A]),{haikuWords:B,generateHaikuWord:I}}var _4=Y1(N1(),1);var DD=Y1(N1(),1);function QE1({customApiKeyTruncated:A,onDone:B}){function Q(G){let Z=FA();switch(G){case"yes":{b0({...Z,customApiKeyResponses:{...Z.customApiKeyResponses,approved:[...Z.customApiKeyResponses?.approved??[],A]}}),B();break}case"no":{b0({...Z,customApiKeyResponses:{...Z.customApiKeyResponses,rejected:[...Z.customApiKeyResponses?.rejected??[],A]}}),B();break}}}let I=w2();return DD.default.createElement(DD.default.Fragment,null,DD.default.createElement(h,{flexDirection:"column",gap:1,padding:1,borderStyle:"round",borderColor:"warning"},DD.default.createElement(S,{bold:!0,color:"warning"},"Detected a custom API key in your environment"),DD.default.createElement(S,null,DD.default.createElement(S,{bold:!0},"ANTHROPIC_API_KEY"),DD.default.createElement(S,null,": sk-ant-...",A)),DD.default.createElement(S,null,"Do you want to use this API key?"),DD.default.createElement(e0,{defaultValue:"no",focusValue:"no",options:[{label:"Yes",value:"yes"},{label:`No (${LA.bold("recommended")})`,value:"no"}],onChange:(G)=>Q(G),onCancel:()=>Q("no")})),DD.default.createElement(h,{marginLeft:3},DD.default.createElement(S,{dimColor:!0},I.pending?DD.default.createElement(DD.default.Fragment,null,"Press ",I.keyName," again to exit"):DD.default.createElement(DD.default.Fragment,null,"Enter to confirm ",Y0.dot," Esc to cancel"))))}var eI=Y1(N1(),1);var IE1=Y1(N1(),1);function my2(A){let[B,Q]=IE1.useState(!1);return IE1.useEffect(()=>{let I=setTimeout(()=>{Q(!0)},A);return()=>clearTimeout(I)},[A]),B}async function nM5(){try{let A=["https://api.anthropic.com/api/hello","https://console.anthropic.com/v1/oauth/hello"],B=async(G)=>{try{let Z=await h4.get(G,{headers:{"User-Agent":TR()}});if(Z.status!==200)return{success:!1,error:`Failed to connect to ${new URL(G).hostname}: Status ${Z.status}`};return{success:!0}}catch(Z){return{success:!1,error:`Failed to connect to ${new URL(G).hostname}: ${Z instanceof Error?Z.code||Z.message:String(Z)}`}}},I=(await Promise.all(A.map(B))).find((G)=>!G.success);if(I)E1("tengu_preflight_check_failed",{isConnectivityError:!1,hasErrorMessage:!!I.error});return I||{success:!0}}catch(A){return d1(A),E1("tengu_preflight_check_failed",{isConnectivityError:!0}),{success:!1,error:`Connectivity check error: ${A instanceof Error?A.code||A.message:String(A)}`}}}function dy2({onSuccess:A}){let[B,Q]=eI.useState(null),[I,G]=eI.useState(!0),Z=my2(1000)&&I;return eI.useEffect(()=>{async function D(){let Y=await nM5();Q(Y),G(!1)}D()},[]),eI.useEffect(()=>{if(B?.success)A();else if(B&&!B.success){let D=setTimeout(()=>process.exit(1),100);return()=>clearTimeout(D)}},[B,A]),eI.default.createElement(h,{flexDirection:"column",gap:1,paddingLeft:1},I&&Z?eI.default.createElement(h,{paddingLeft:1},eI.default.createElement(QY,null),eI.default.createElement(S,null,"Checking connectivity...")):!B?.success&&!I&&eI.default.createElement(h,{flexDirection:"column",gap:1},eI.default.createElement(S,{color:"error"},"Unable to connect to Anthropic services"),eI.default.createElement(S,{color:"error"},B?.error),eI.default.createElement(h,{flexDirection:"column",gap:1},eI.default.createElement(S,null,"Please check your internet connection and network settings."),eI.default.createElement(S,null,"Note: ",r0," might not be available in your country. Check supported countries at"," ",eI.default.createElement(S,{color:"suggestion"},"https://anthropic.com/supported-countries")))))}function l2A({onDone:A}){let[B,Q]=_4.useState(0),I=nS(),[G,Z]=k9();_4.useEffect(()=>{E1("tengu_began_setup",{oauthEnabled:I})},[I]);function D(){if(B<C.length-1){let K=B+1;Q(K),E1("tengu_onboarding_step",{oauthEnabled:I,stepId:C[K]?.id})}else A()}function Y(K){Z(K),D()}let W=w2();V0(async(K,z)=>{let U=C[B];if(z.return&&U&&["security"].includes(U.id))if(B===C.length-1){A();return}else{if(U.id==="security")await $3();D()}else if(z.escape&&U?.id==="terminal-setup")D()});let J=_4.default.createElement(vw1,{initialTheme:G,onThemeSelect:Y,showIntroText:!0,helpText:"To change this later, run /theme",hideEscToCancel:!0,skipExitHandling:!0}),F=_4.default.createElement(h,{flexDirection:"column",gap:1,paddingLeft:1},_4.default.createElement(S,{bold:!0},"Security notes:"),_4.default.createElement(h,{flexDirection:"column",width:70},_4.default.createElement(AR,null,_4.default.createElement(AR.Item,null,_4.default.createElement(S,null,"Claude can make mistakes"),_4.default.createElement(S,{color:"secondaryText",wrap:"wrap"},"You should always review Claude's responses, especially when",_4.default.createElement(SI,null),"running code.",_4.default.createElement(SI,null))),_4.default.createElement(AR.Item,null,_4.default.createElement(S,null,"Due to prompt injection risks, only use it with code you trust"),_4.default.createElement(S,{color:"secondaryText",wrap:"wrap"},"For more details see:",_4.default.createElement(SI,null),_4.default.createElement(nQ,{url:"https://docs.anthropic.com/s/claude-code-security"}))))),_4.default.createElement(uw,null)),X=_4.default.createElement(dy2,{onSuccess:D}),V=_4.useMemo(()=>{if(!process.env.ANTHROPIC_API_KEY)return"";let K=UJ(process.env.ANTHROPIC_API_KEY);if(cG1(K)==="new")return K},[]),C=[];if(I)C.push({id:"preflight",component:X});if(C.push({id:"theme",component:J}),I)C.push({id:"oauth",component:_4.default.createElement(GE1,{onDone:D})});if(V)C.push({id:"api-key",component:_4.default.createElement(QE1,{customApiKeyTruncated:V,onDone:D})});if(C.push({id:"security",component:F}),oA1())C.push({id:"terminal-setup",component:_4.default.createElement(h,{flexDirection:"column",gap:1,paddingLeft:1},_4.default.createElement(S,{bold:!0},"Use ",r0,"'s terminal setup?"),_4.default.createElement(h,{flexDirection:"column",width:70,gap:1},_4.default.createElement(S,null,"For the optimal coding experience, enable the recommended settings",_4.default.createElement(SI,null),"for your terminal:"," ",nA.terminal==="Apple_Terminal"?"Option+Enter for newlines and visual bell":"Shift+Enter for newlines"),_4.default.createElement(e0,{options:[{label:"Yes, use recommended settings",value:"install"},{label:"No, maybe later with /terminal-setup",value:"no"}],onChange:(K)=>{if(K==="install")V2A(G).then(()=>{D()});else D()},onCancel:()=>D()}),_4.default.createElement(S,{dimColor:!0},W.pending?_4.default.createElement(_4.default.Fragment,null,"Press ",W.keyName," again to exit"):_4.default.createElement(_4.default.Fragment,null,"Enter to confirm  Esc to skip"))))});return _4.default.createElement(h,{flexDirection:"column",gap:1},C[B]?.id!=="oauth"&&_4.default.createElement(i2A,null),_4.default.createElement(h,{flexDirection:"column",padding:0,gap:0},C[B]?.component,W.pending&&_4.default.createElement(h,{padding:1},_4.default.createElement(S,{dimColor:!0},"Press ",W.keyName," again to exit"))))}var uy2=28;function i2A(){let{columns:A}=r9(),B=A<uy2;return _4.default.createElement(h,{...B?{}:{borderColor:"claude",borderStyle:"round"},paddingX:1,width:uy2},_4.default.createElement(S,null,_4.default.createElement(S,{color:"claude"},"")," Welcome to"," ",_4.default.createElement(S,{bold:!0},r0)))}import{PassThrough as aM5}from"stream";function sM5(A){return new Promise((B)=>{let Q="",I=new aM5;I.on("data",(Z)=>{Q+=Z.toString()});let G=Y8(A,{stdout:I,patchConsole:!1});process.nextTick(()=>{G.unmount(),B(Q)})})}async function Y01(A){let B=await sM5(A);console.log(B),process.stdout.write("\x1B[?25l")}class n2A{alreadyRendered={};async renderStatic(A){for(let B in A)if(!this.alreadyRendered[B]&&A[B])await Y01(A[B]),this.alreadyRendered[B]=!0}reset(){this.alreadyRendered={}}}var py2="Paste code here if prompted > ";function GE1({onDone:A,startingMessage:B}){let I=Q5().forceLoginMethod,G=I==="claudeai"?"Login method pre-selected: Subscription Plan (Claude Pro/Max)":I==="console"?"Login method pre-selected: API Usage Billing (Anthropic Console)":null,[Z,D]=X9.useState(()=>{if(I==="claudeai"||I==="console")return{state:"ready_to_start"};return{state:"idle"}}),[Y,W]=X9.useState(""),[J,F]=X9.useState(0),[X]=X9.useState(()=>new u2A),[V,C]=X9.useState(()=>{return I==="claudeai"}),[K,z]=X9.useState(!1),[U]=X9.useState(()=>new n2A),$=r9().columns-py2.length-1;X9.useEffect(()=>{if(I==="claudeai")E1("tengu_oauth_claudeai_forced",{});else if(I==="console")E1("tengu_oauth_console_forced",{})},[I]),X9.useEffect(()=>{if(Z.state==="about_to_retry")$3(),U.reset(),setTimeout(()=>{D(Z.nextState)},1000)},[Z,U]),V0(async(P,x)=>{if(x.return){if(Z.state==="success")E1("tengu_oauth_success",{loginWithClaudeAi:V}),await $3(),A();else if(Z.state==="error"&&Z.toRetry)W(""),D({state:"about_to_retry",nextState:Z.toRetry})}});async function R(P,x){try{let[p,k]=P.split("#");if(!p||!k){D({state:"error",message:"Invalid code. Please make sure the full code was copied",toRetry:{state:"waiting_for_login",url:x}});return}E1("tengu_oauth_manual_entry",{}),X.handleManualAuthCodeInput({authorizationCode:p,state:k})}catch(p){d1(p instanceof Error?p:new Error(String(p))),D({state:"error",message:p.message,toRetry:{state:"waiting_for_login",url:x}})}}let L=X9.useCallback(async()=>{try{let P=await X.startOAuthFlow(async(k)=>{D({state:"waiting_for_login",url:k}),setTimeout(()=>z(!0),3000)},{loginWithClaudeAi:V}).catch((k)=>{let a=k.message.includes("Token exchange failed");throw D({state:"error",message:a?"Failed to exchange authorization code for access token. Please try again.":k.message,toRetry:{state:"idle"}}),E1("tengu_oauth_token_exchange_error",{error:k.message}),k}),x=g_1(P);if(x.warning)E1("tengu_oauth_storage_warning",{warning:x.warning});if(D({state:"creating_api_key"}),await edA(P.accessToken).catch((k)=>{throw D({state:"error",message:"Failed to fetch user roles: "+k.message,toRetry:{state:"idle"}}),E1("tengu_oauth_user_roles_error",{error:k.message}),k}),wL(P.scopes)?!0:await AuA(P.accessToken).catch((k)=>{throw D({state:"error",message:"Failed to create API key: "+k.message,toRetry:{state:"idle"}}),E1("tengu_oauth_api_key_error",{error:k.message}),k}))await iH1(),d2A(),D({state:"success"}),fu({message:"Claude Code login successful"});else D({state:"error",message:"Unable to create API key. The server accepted the request but didn't return a key.",toRetry:{state:"idle"}}),E1("tengu_oauth_api_key_error",{error:"server_returned_no_key"})}catch(P){let x=P.message;E1("tengu_oauth_error",{error:x})}},[X,z,V]),T=X9.useRef(!1);X9.useEffect(()=>{if(Z.state==="ready_to_start"&&!T.current)T.current=!0,process.nextTick(()=>{L(),T.current=!1})},[Z.state,L]);function M(){switch(Z.state){case"idle":return X9.default.createElement(h,{flexDirection:"column",gap:1},X9.default.createElement(S,{bold:!0},B?B:`${r0} can now be used with your Claude subscription or billed based on API usage through your Console account.`),X9.default.createElement(h,{marginTop:1},X9.default.createElement(S,{bold:!0},"Select login method:")),X9.default.createElement(h,null,X9.default.createElement(e0,{options:[{label:`Claude account with subscription
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`,value:"console"}],onCancel:()=>{},onChange:(P)=>{if(D({state:"ready_to_start"}),P==="claudeai")E1("tengu_oauth_claudeai_selected",{}),C(!0);else E1("tengu_oauth_console_selected",{}),C(!1)}})));case"waiting_for_login":return X9.default.createElement(h,{flexDirection:"column",gap:1},G&&X9.default.createElement(h,null,X9.default.createElement(S,{dimColor:!0},G)),!K&&X9.default.createElement(h,null,X9.default.createElement(QY,null),X9.default.createElement(S,null,"Opening browser to sign in")),K&&X9.default.createElement(h,null,X9.default.createElement(S,null,py2),X9.default.createElement(l3,{value:Y,onChange:W,onSubmit:(P)=>R(P,Z.url),cursorOffset:J,onChangeCursorOffset:F,columns:$})));case"creating_api_key":return X9.default.createElement(h,{flexDirection:"column",gap:1},X9.default.createElement(h,null,X9.default.createElement(QY,null),X9.default.createElement(S,null,"Creating API key for Claude Code")));case"about_to_retry":return X9.default.createElement(h,{flexDirection:"column",gap:1},X9.default.createElement(S,{color:"permission"},"Retrying"));case"success":return X9.default.createElement(h,{flexDirection:"column",gap:2},FA().oauthAccount?.emailAddress?X9.default.createElement(S,{dimColor:!0},"Logged in as"," ",X9.default.createElement(S,null,FA().oauthAccount?.emailAddress)):null,X9.default.createElement(S,{color:"success"},"Login successful. Press ",X9.default.createElement(S,{bold:!0},"Enter")," to continue"));case"error":return X9.default.createElement(h,{flexDirection:"column",gap:1},X9.default.createElement(S,{color:"error"},"OAuth error: ",Z.message),Z.toRetry&&X9.default.createElement(h,{marginTop:1},X9.default.createElement(S,{color:"permission"},"Press ",X9.default.createElement(S,{bold:!0},"Enter")," to retry.")));default:return null}}return X9.useEffect(()=>{let P={};if(P.header=X9.default.createElement(h,{key:"header",flexDirection:"column",gap:1},X9.default.createElement(i2A,null),X9.default.createElement(h,{paddingBottom:1,paddingLeft:1},X9.default.createElement(fy2,null))),Z.state==="waiting_for_login"&&K)P.urlToCopy=X9.default.createElement(h,{flexDirection:"column",key:"urlToCopy",gap:1,paddingBottom:1},X9.default.createElement(h,{paddingX:1},X9.default.createElement(S,{dimColor:!0},"Browser didn't open? Use the url below to sign in:")),X9.default.createElement(h,{width:1000},X9.default.createElement(S,{dimColor:!0},Z.url)));U.renderStatic(P)},[U,Z,K]),X9.default.createElement(h,{flexDirection:"column",gap:1},X9.default.createElement(h,{paddingLeft:1,flexDirection:"column",gap:1},M()))}var w4=Y1(N1(),1);var rM5=53;function Ep({model:A}){let B=gY(process.env.IS_DEMO)?29:Math.max(rM5,iA().length+12),Q=jG(!1),{columns:I}=r9(),G=I<B,Z=Boolean(process.env.ANTHROPIC_API_KEY&&SuA(process.env.ANTHROPIC_API_KEY)),D=gY(process.env.DISABLE_PROMPT_CACHING),Y=wD0(A),W=null,J=Boolean(Z||D||process.env.API_TIMEOUT_MS||process.env.MAX_THINKING_TOKENS||process.env.ANTHROPIC_BASE_URL);return w4.createElement(h,{flexDirection:"column"},w4.createElement(h,{...G?{}:{borderColor:"claude",borderStyle:"round"},flexDirection:"column",gap:1,paddingLeft:1,width:B},w4.createElement(S,null,w4.createElement(S,{color:"claude"},"")," Welcome to"," ",w4.createElement(S,{bold:!0},r0),"!"),process.env.IS_DEMO?null:w4.createElement(w4.Fragment,null,w4.createElement(h,{paddingLeft:2,flexDirection:"column",gap:1},w4.createElement(S,{color:"secondaryText",italic:!0},"/help for help, /status for your current setup"),w4.createElement(S,{color:"secondaryText"},"cwd: ",iA()),!1,!1),J&&w4.createElement(h,{borderColor:"secondaryBorder",borderStyle:"single",borderBottom:!1,borderLeft:!1,borderRight:!1,borderTop:!0,flexDirection:"column",marginLeft:2,marginRight:1,paddingTop:1},w4.createElement(h,{marginBottom:1},w4.createElement(S,{color:"secondaryText"},"Overrides (via env):")),Z&&Q?w4.createElement(S,{color:"secondaryText"}," API Key:"," ",w4.createElement(S,{bold:!0},Q.length<25?`${Q.slice(0,3)}`:`sk-ant-${Q.slice(-B+25)}`)):null,D?w4.createElement(S,{color:"secondaryText"}," Prompt caching:"," ",w4.createElement(S,{color:"error",bold:!0},"off")):null,process.env.API_TIMEOUT_MS?w4.createElement(S,{color:"secondaryText"}," API timeout:"," ",w4.createElement(S,{bold:!0},process.env.API_TIMEOUT_MS,"ms")):null,process.env.MAX_THINKING_TOKENS?w4.createElement(S,{color:"secondaryText"}," Max thinking tokens:"," ",w4.createElement(S,{bold:!0},process.env.MAX_THINKING_TOKENS)):null,process.env.ANTHROPIC_BASE_URL?w4.createElement(S,{color:"secondaryText"}," API Base URL:"," ",w4.createElement(S,{bold:!0},process.env.ANTHROPIC_BASE_URL)):null))))}var cy2=Y1(N1(),1);function Up(){let[{mainLoopModel:A,maxRateLimitFallbackActive:B}]=B8();return cy2.useMemo(()=>{if(A===null){if(B)return RX();return Qs()}return qg(A)},[A,B])}var ly2=()=>({type:"local-jsx",name:"login",description:jG(!1)?"Switch Anthropic accounts":"Sign in with your Anthropic account",isEnabled:()=>!0,isHidden:!1,async call(A,B){return await $3(),AG.createElement(a2A,{onDone:async(Q,I)=>{Y01(AG.createElement(Ep,{model:I})),B.onChangeAPIKey(),A(Q?"Login successful":"Login interrupted")}})},userFacingName(){return"login"}});function a2A(A){let B=Up(),Q=w2(()=>A.onDone(!1,B));return AG.createElement(h,{flexDirection:"column"},AG.createElement(GE1,{onDone:()=>A.onDone(!0,B),startingMessage:A.startingMessage}),AG.createElement(h,{marginLeft:3},AG.createElement(S,{dimColor:!0},Q.pending?AG.createElement(AG.Fragment,null,"Press ",Q.keyName," again to exit"):"")))}var y7=Y1(N1(),1);import{execSync as ZE1}from"child_process";var iy2=Y1(N1(),1);function ny2(){return iy2.default.createElement(S,null,"Checking GitHub CLI installation")}var BZ=Y1(N1(),1);function ay2({currentRepo:A,useCurrentRepo:B,repoUrl:Q,onRepoUrlChange:I,onSubmit:G,onToggleUseCurrentRepo:Z}){let[D,Y]=BZ.useState(0),J=r9().columns;return V0((F,X)=>{if(X.upArrow)Z(!0);else if(X.downArrow)Z(!1);else if(X.return)G()}),BZ.default.createElement(BZ.default.Fragment,null,BZ.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},BZ.default.createElement(h,{flexDirection:"column",marginBottom:1},BZ.default.createElement(S,{bold:!0},"Install GitHub App"),BZ.default.createElement(S,{dimColor:!0},"Select GitHub repository")),A&&BZ.default.createElement(h,{marginBottom:1},BZ.default.createElement(S,{bold:B,color:B?"permission":void 0},B?"> ":"  ","Use current repository: ",A)),BZ.default.createElement(h,{marginBottom:1},BZ.default.createElement(S,{bold:!B||!A,color:!B||!A?"permission":void 0},!B||!A?"> ":"  ","Enter a different repository")),(!B||!A)&&BZ.default.createElement(h,{marginBottom:1},BZ.default.createElement(l3,{value:Q,onChange:I,onSubmit:G,focus:!0,placeholder:"owner/repo or https://github.com/owner/repo",columns:J,cursorOffset:D,onChangeCursorOffset:Y,showCursor:!0}))),BZ.default.createElement(h,{marginLeft:3},BZ.default.createElement(S,{dimColor:!0},A?"/ to select  ":"","Enter to continue")))}var KF=Y1(N1(),1);function sy2({repoUrl:A,onSubmit:B}){return V0((Q,I)=>{if(I.return)B()}),KF.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},KF.default.createElement(h,{flexDirection:"column",marginBottom:1},KF.default.createElement(S,{bold:!0},"Install the Claude GitHub App")),KF.default.createElement(h,{marginBottom:1},KF.default.createElement(S,null,"Opening browser to install the Claude GitHub App")),KF.default.createElement(h,{marginBottom:1},KF.default.createElement(S,null,"Please install the app for repository: ",KF.default.createElement(S,{bold:!0},A))),KF.default.createElement(h,{marginBottom:1},KF.default.createElement(S,{dimColor:!0},"Important: Make sure to grant access to this specific repository")),KF.default.createElement(h,null,KF.default.createElement(S,{bold:!0,color:"permission"},"Press Enter once you've installed the app",Y0.ellipsis)))}var L3=Y1(N1(),1);function ry2({useExistingSecret:A,secretName:B,onToggleUseExistingSecret:Q,onSecretNameChange:I,onSubmit:G}){let[Z,D]=L3.useState(0),Y=r9(),[W]=k9();return V0((J,F)=>{if(F.upArrow)Q(!0);else if(F.downArrow)Q(!1);else if(F.return)G()}),L3.default.createElement(L3.default.Fragment,null,L3.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},L3.default.createElement(h,{flexDirection:"column",marginBottom:1},L3.default.createElement(S,{bold:!0},"Install GitHub App"),L3.default.createElement(S,{dimColor:!0},"Setup API key secret")),L3.default.createElement(h,{marginBottom:1},L3.default.createElement(S,{color:"warning"},"ANTHROPIC_API_KEY already exists in repository secrets!")),L3.default.createElement(h,{marginBottom:1},L3.default.createElement(S,null,"Would you like to:")),L3.default.createElement(h,{marginBottom:1},L3.default.createElement(S,null,A?$9("success",W)("> "):"  ","Use the existing API key")),L3.default.createElement(h,{marginBottom:1},L3.default.createElement(S,null,!A?$9("success",W)("> "):"  ","Create a new secret with a different name")),!A&&L3.default.createElement(L3.default.Fragment,null,L3.default.createElement(h,{marginBottom:1},L3.default.createElement(S,null,"Enter new secret name (alphanumeric with underscores):")),L3.default.createElement(l3,{value:B,onChange:I,onSubmit:G,focus:!0,placeholder:"e.g., CLAUDE_API_KEY",columns:Y.columns,cursorOffset:Z,onChangeCursorOffset:D,showCursor:!0}))),L3.default.createElement(h,{marginLeft:3},L3.default.createElement(S,{dimColor:!0},"/ to select  Enter to continue")))}var YD=Y1(N1(),1);function oy2({existingApiKey:A,useExistingKey:B,apiKey:Q,onApiKeyChange:I,onSubmit:G,onToggleUseExistingKey:Z}){let[D,Y]=YD.useState(0),W=r9(),[J]=k9();return V0((F,X)=>{if(A){if(X.upArrow)Z(!0);else if(X.downArrow)Z(!1)}if(X.return)G()}),YD.default.createElement(YD.default.Fragment,null,YD.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},YD.default.createElement(h,{flexDirection:"column",marginBottom:1},YD.default.createElement(S,{bold:!0},"Install GitHub App"),YD.default.createElement(S,{dimColor:!0},"Choose API key")),A&&YD.default.createElement(h,{marginBottom:1},YD.default.createElement(S,null,B?$9("success",J)("> "):"  ","Use your existing Claude Code API key")),YD.default.createElement(h,{marginBottom:1},YD.default.createElement(S,null,!B||!A?$9("success",J)("> "):"  ","Enter a new API key")),(!B||!A)&&YD.default.createElement(l3,{value:Q,onChange:I,onSubmit:G,onPaste:I,focus:!0,placeholder:"sk-ant (Create a new key at https://console.anthropic.com/settings/keys)",mask:"*",columns:W.columns,cursorOffset:D,onChangeCursorOffset:Y,showCursor:!0})),YD.default.createElement(h,{marginLeft:3},YD.default.createElement(S,{dimColor:!0},A?"/ to select  ":"","Enter to continue")))}var A$=Y1(N1(),1);function ty2({currentWorkflowInstallStep:A,secretExists:B,useExistingSecret:Q,secretName:I,skipWorkflow:G=!1,selectedWorkflows:Z}){let D=G?["Getting repository information",B&&Q?"Using existing API key secret":`Setting up ${I} secret`]:["Getting repository information","Creating branch",Z.length>1?"Creating workflow files":"Creating workflow file",B&&Q?"Using existing API key secret":`Setting up ${I} secret`,"Opening pull request page"];return A$.default.createElement(A$.default.Fragment,null,A$.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},A$.default.createElement(h,{flexDirection:"column",marginBottom:1},A$.default.createElement(S,{bold:!0},"Install GitHub App"),A$.default.createElement(S,{dimColor:!0},"Create GitHub Actions workflow")),D.map((Y,W)=>{let J="pending";if(W<A)J="completed";else if(W===A)J="in-progress";return A$.default.createElement(h,{key:W},A$.default.createElement(S,{color:J==="completed"?"success":J==="in-progress"?"warning":void 0},J==="completed"?" ":"",Y,J==="in-progress"?"":""))})))}var _B=Y1(N1(),1);function ey2({secretExists:A,useExistingSecret:B,secretName:Q,skipWorkflow:I=!1}){return _B.default.createElement(_B.default.Fragment,null,_B.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},_B.default.createElement(h,{flexDirection:"column",marginBottom:1},_B.default.createElement(S,{bold:!0},"Install GitHub App"),_B.default.createElement(S,{dimColor:!0},"Success")),!I&&_B.default.createElement(S,{color:"success"}," GitHub Actions workflow created!"),A&&B&&_B.default.createElement(h,{marginTop:1},_B.default.createElement(S,{color:"success"}," Using existing ANTHROPIC_API_KEY secret")),(!A||!B)&&_B.default.createElement(h,{marginTop:1},_B.default.createElement(S,{color:"success"}," API key saved as ",Q," secret")),_B.default.createElement(h,{marginTop:1},_B.default.createElement(S,null,"Next steps:")),I?_B.default.createElement(_B.default.Fragment,null,_B.default.createElement(S,null,"1. Install the Claude GitHub App if you haven't already"),_B.default.createElement(S,null,"2. Your workflow file was kept unchanged"),_B.default.createElement(S,null,"3. API key is configured and ready to use")):_B.default.createElement(_B.default.Fragment,null,_B.default.createElement(S,null,"1. A pre-filled PR page has been created"),_B.default.createElement(S,null,"2. Install the Claude GitHub App if you haven't already"),_B.default.createElement(S,null,"3. Merge the PR to enable Claude PR assistance"))),_B.default.createElement(h,{marginLeft:3},_B.default.createElement(S,{dimColor:!0},"Press any key to exit")))}var j7=Y1(N1(),1);function Ak2({error:A,errorReason:B,errorInstructions:Q}){return j7.default.createElement(j7.default.Fragment,null,j7.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},j7.default.createElement(h,{flexDirection:"column",marginBottom:1},j7.default.createElement(S,{bold:!0},"Install GitHub App"),j7.default.createElement(S,{dimColor:!0},"Error")),j7.default.createElement(S,{color:"error"},"Error: ",A),B&&j7.default.createElement(h,{marginTop:1},j7.default.createElement(S,{dimColor:!0},"Reason: ",B)),Q&&Q.length>0&&j7.default.createElement(h,{flexDirection:"column",marginTop:1},j7.default.createElement(S,{dimColor:!0},"How to fix:"),Q.map((I,G)=>j7.default.createElement(h,{key:G,marginLeft:2},j7.default.createElement(S,{dimColor:!0}," "),j7.default.createElement(S,null,I)))),j7.default.createElement(h,{marginTop:1},j7.default.createElement(S,{dimColor:!0},"For manual setup instructions, see:"," ",j7.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/#manual-setup-direct-api")))),j7.default.createElement(h,{marginLeft:3},j7.default.createElement(S,{dimColor:!0},"Press any key to exit")))}var jW=Y1(N1(),1);function Bk2({repoName:A,onSelectAction:B}){return jW.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},jW.default.createElement(h,{flexDirection:"column",marginBottom:1},jW.default.createElement(S,{bold:!0},"Existing Workflow Found"),jW.default.createElement(S,{dimColor:!0},"Repository: ",A)),jW.default.createElement(h,{flexDirection:"column",marginBottom:1},jW.default.createElement(S,null,"A Claude workflow file already exists at"," ",jW.default.createElement(S,{color:"claude"},".github/workflows/claude.yml")),jW.default.createElement(S,{dimColor:!0},"What would you like to do?")),jW.default.createElement(h,{flexDirection:"column"},jW.default.createElement(e0,{options:[{label:"Update workflow file with latest version",value:"update"},{label:"Skip workflow update (configure secrets only)",value:"skip"},{label:"Exit without making changes",value:"exit"}],onChange:(Z)=>{B(Z)},onCancel:()=>{B("exit")}})),jW.default.createElement(h,{marginTop:1},jW.default.createElement(S,{dimColor:!0},"View the latest workflow template at:"," ",jW.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/blob/main/examples/claude.yml"))))}var yW=Y1(N1(),1);function Qk2({warnings:A,onContinue:B}){return V0((Q,I)=>{if(I.return)B()}),yW.default.createElement(yW.default.Fragment,null,yW.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},yW.default.createElement(h,{flexDirection:"column",marginBottom:1},yW.default.createElement(S,{bold:!0},Y0.warning," Setup Warnings"),yW.default.createElement(S,{dimColor:!0},"We found some potential issues, but you can continue anyway")),A.map((Q,I)=>yW.default.createElement(h,{key:I,flexDirection:"column",marginBottom:1},yW.default.createElement(S,{color:"warning",bold:!0},Q.title),yW.default.createElement(S,null,Q.message),Q.instructions.length>0&&yW.default.createElement(h,{flexDirection:"column",marginLeft:2,marginTop:1},Q.instructions.map((G,Z)=>yW.default.createElement(S,{key:Z,dimColor:!0}," ",G))))),yW.default.createElement(h,{marginTop:1},yW.default.createElement(S,{bold:!0,color:"permission"},"Press Enter to continue anyway, or Ctrl+C to exit and fix issues"))))}var NQ=Y1(N1(),1);function Ik2({onSubmit:A,defaultSelections:B}){let[Q,I]=NQ.useState(new Set(B)),[G,Z]=NQ.useState(0),[D,Y]=NQ.useState(!1),W=[{value:"claude",label:"@Claude Code",description:"Tag @claude in issues and PR comments"},{value:"claude-review",label:"Claude Code Review",description:"Automated code review on new PRs"}];return V0((J,F)=>{if(F.upArrow)Z((X)=>X>0?X-1:W.length-1),Y(!1);else if(F.downArrow)Z((X)=>X<W.length-1?X+1:0),Y(!1);else if(J===" "){let X=W[G]?.value;if(X)I((V)=>{let C=new Set(V);if(C.has(X))C.delete(X);else C.add(X);return C})}else if(F.return)if(Q.size===0)Y(!0);else A(Array.from(Q))}),NQ.default.createElement(NQ.default.Fragment,null,NQ.default.createElement(h,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1,width:"100%"},NQ.default.createElement(h,{flexDirection:"column",marginBottom:1},NQ.default.createElement(S,{bold:!0},"Select GitHub workflows to install"),NQ.default.createElement(S,{dimColor:!0},"We'll create a workflow file in your repository for each one you select.")),NQ.default.createElement(h,{flexDirection:"column",paddingX:1},W.map((J,F)=>{let X=Q.has(J.value),V=F===G;return NQ.default.createElement(h,{key:J.value,flexDirection:"row",marginBottom:F<W.length-1?1:0},NQ.default.createElement(h,{marginRight:1,minWidth:2},NQ.default.createElement(S,{bold:V},X?"":" ")),NQ.default.createElement(h,{flexDirection:"column"},NQ.default.createElement(S,{bold:V},J.label),NQ.default.createElement(S,{dimColor:!0},J.description)))}))),NQ.default.createElement(h,{marginLeft:2},NQ.default.createElement(S,{dimColor:!0}," Navigate  Space to toggle  Enter to confirm")),D&&NQ.default.createElement(h,{marginLeft:1},NQ.default.createElement(S,{color:"error"},"You must select at least one workflow to continue")))}var Gk2="Add Claude Code GitHub Workflow",Zk2=`name: Claude Code
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:          anthropic_api_key: \${{ secrets.ANTHROPIC_API_KEY }}
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:          anthropic_api_key: \${{ secrets.ANTHROPIC_API_KEY }}
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`;async function oM5(A,B,Q,I,G,Z,D){let Y=await t0("gh",["api",`repos/${A}/contents/${Q}`,"--jq",".sha"]),W=null;if(Y.code===0)W=Y.stdout.trim();let J=I;if(G!=="ANTHROPIC_API_KEY")J=I.replace(/anthropic_api_key: \$\{\{ secrets\.ANTHROPIC_API_KEY \}\}/g,`anthropic_api_key: \${{ secrets.${G} }}`);let F=Buffer.from(J).toString("base64"),X=["api","--method","PUT",`repos/${A}/contents/${Q}`,"-f",W?`message=Update ${Z}`:`message=${Z}`,"-f",`content=${F}`,"-f",`branch=${B}`];if(W)X.push("-f",`sha=${W}`);let V=await t0("gh",X);if(V.code!==0){if(V.stderr.includes("422")&&V.stderr.includes("sha"))throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_workflow_file",exit_code:V.code,...D}),new Error(`Failed to create workflow file ${Q}: A Claude workflow file already exists in this repository. Please remove it first or update it manually.`);E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_workflow_file",exit_code:V.code,...D});let C=`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`+" For manual setup  Visit: https://github.com/anthropics/claude-code-action";throw new Error(`Failed to create workflow file ${Q}: ${V.stderr}${C}`)}}async function s2A(A,B,Q,I,G=!1,Z,D){try{E1("tengu_setup_github_actions_started",{skip_workflow:G,has_api_key:!!B,using_default_secret_name:Q==="ANTHROPIC_API_KEY",selected_claude_workflow:Z.includes("claude"),selected_claude_review_workflow:Z.includes("claude-review"),...D});let Y=await t0("gh",["api",`repos/${A}`,"--jq",".id"]);if(Y.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"repo_not_found",exit_code:Y.code,...D}),new Error(`Failed to access repository ${A}`);let W=await t0("gh",["api",`repos/${A}`,"--jq",".default_branch"]);if(W.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_get_default_branch",exit_code:W.code,...D}),new Error(`Failed to get default branch: ${W.stderr}`);let J=W.stdout.trim(),F=await t0("gh",["api",`repos/${A}/git/ref/heads/${J}`,"--jq",".object.sha"]);if(F.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_get_branch_sha",exit_code:F.code,...D}),new Error(`Failed to get branch SHA: ${F.stderr}`);let X=F.stdout.trim(),V=null;if(!G){I(),V=`add-claude-github-actions-${Date.now()}`;let C=await t0("gh",["api","--method","POST",`repos/${A}/git/refs`,"-f",`ref=refs/heads/${V}`,"-f",`sha=${X}`]);if(C.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_branch",exit_code:C.code,...D}),new Error(`Failed to create branch: ${C.stderr}`);I();let K=[];if(Z.includes("claude"))K.push({path:".github/workflows/claude.yml",content:Zk2,message:"Claude PR Assistant workflow"});if(Z.includes("claude-review"))K.push({path:".github/workflows/claude-code-review.yml",content:Yk2,message:"Claude Code Review workflow"});for(let z of K)await oM5(A,V,z.path,z.content,Q,z.message,D)}if(I(),B){let C=await t0("gh",["secret","set",Q,"--body",B,"--repo",A]);if(C.code!==0){E1("tengu_setup_github_actions_failed",{reason:"failed_to_set_api_key_secret",exit_code:C.code,...D});let K=`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`+" For manual setup  Visit: https://github.com/anthropics/claude-code-action";throw new Error(`Failed to set API key secret: ${C.stderr||"Unknown error"}${K}`)}}if(!G&&V){I();let C=`https://github.com/${A}/compare/${J}...${V}?quick_pull=1&title=${encodeURIComponent(Gk2)}&body=${encodeURIComponent(Dk2)}`;if(process.platform==="darwin")await t0("open",[C]);else if(process.platform==="win32")await t0("cmd.exe",["/c","start","",C]);else await t0("xdg-open",[C])}E1("tengu_setup_github_actions_completed",{skip_workflow:G,has_api_key:!!B,using_default_secret_name:Q==="ANTHROPIC_API_KEY",selected_claude_workflow:Z.includes("claude"),selected_claude_review_workflow:Z.includes("claude-review"),...D}),b0({...FA(),githubActionSetupCount:(FA().githubActionSetupCount??0)+1})}catch(Y){if(!Y||!(Y instanceof Error)||!Y.message.includes("Failed to"))E1("tengu_setup_github_actions_failed",{reason:"unexpected_error",...D});if(Y instanceof Error)d1(Y);throw Y}}var tM5={step:"check-gh",selectedRepoName:"",currentRepo:"",useCurrentRepo:!0,apiKey:"",useExistingKey:!0,currentWorkflowInstallStep:0,warnings:[],secretExists:!1,secretName:"ANTHROPIC_API_KEY",useExistingSecret:!0,workflowExists:!1,selectedWorkflows:["claude","claude-review"]};function eM5(A){let[B]=y7.useState(()=>jG(!1)),[Q,I]=y7.useState({...tM5,useExistingKey:!!B});w2(),y7.default.useEffect(()=>{E1("tengu_install_github_app_started",{})},[]);let G=y7.useCallback(async()=>{let $=[];try{ZE1("gh --version",{stdio:"ignore"})}catch{$.push({title:"GitHub CLI not found",message:"GitHub CLI (gh) does not appear to be installed or accessible.",instructions:["Install GitHub CLI from https://cli.github.com/","macOS: brew install gh","Windows: winget install --id GitHub.cli","Linux: See installation instructions at https://github.com/cli/cli#installation"]})}try{ZE1("gh auth status",{stdio:"ignore"})}catch{$.push({title:"GitHub CLI not authenticated",message:"GitHub CLI does not appear to be authenticated.",instructions:["Run: gh auth login","Follow the prompts to authenticate with GitHub","Or set up authentication using environment variables or other methods"]})}let R="";try{ZE1("git rev-parse --is-inside-work-tree",{stdio:"ignore"});let T=ZE1("git remote get-url origin",{encoding:"utf8"}).trim().match(/github\.com[:/]([^/]+\/[^/]+)(\.git)?$/);if(T)R=T[1]?.replace(/\.git$/,"")||""}catch{}I((L)=>({...L,warnings:$,currentRepo:R,selectedRepoName:R,step:$.length>0?"warnings":"choose-repo"}))},[]);y7.default.useEffect(()=>{if(Q.step==="check-gh")G()},[Q.step,G]);async function Z(){if(process.platform==="darwin")await t0("open",["https://github.com/apps/claude"]);else if(process.platform==="win32")await t0("cmd.exe",["/c","start","","https://github.com/apps/claude"]);else await t0("xdg-open",["https://github.com/apps/claude"])}async function D($){try{let R=await t0("gh",["api",`repos/${$}`,"--jq",".permissions.admin"]);if(R.code===0)return{hasAccess:R.stdout.trim()==="true"};if(R.stderr.includes("404")||R.stderr.includes("Not Found"))return{hasAccess:!1,error:"repository_not_found"};return{hasAccess:!1}}catch{return{hasAccess:!1}}}async function Y($){return(await t0("gh",["api",`repos/${$}/contents/.github/workflows/claude.yml`,"--jq",".sha"])).code===0}async function W(){let $=await t0("gh",["secret","list","--app","actions","--repo",Q.selectedRepoName]);if($.code===0)if($.stdout.split(`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`).some((T)=>{return/^ANTHROPIC_API_KEY\s+/.test(T)}))I((T)=>({...T,secretExists:!0,step:"check-existing-secret"}));else I((T)=>({...T,step:"api-key"}));else I((R)=>({...R,step:"api-key"}))}let J=async()=>{if(Q.step==="warnings")I(($)=>({...$,step:"install-app"})),setTimeout(()=>{Z()},0);else if(Q.step==="choose-repo"){let $=Q.useCurrentRepo?Q.currentRepo:Q.selectedRepoName;if(!$.trim())return;let R=[];if($.includes("github.com")){let M=$.match(/github\.com[:/]([^/]+\/[^/]+)(\.git)?$/);if(!M)R.push({title:"Invalid GitHub URL format",message:"The repository URL format appears to be invalid.",instructions:["Use format: owner/repo or https://github.com/owner/repo","Example: anthropics/claude-cli"]});else $=M[1]?.replace(/\.git$/,"")||""}if(!$.includes("/"))R.push({title:"Repository format warning",message:'Repository should be in format "owner/repo"',instructions:["Use format: owner/repo","Example: anthropics/claude-cli"]});let L=await D($);if(L.error==="repository_not_found")R.push({title:"Repository not found",message:`Repository ${$} was not found or you don't have access.`,instructions:[`Check that the repository name is correct: ${$}`,"Ensure you have access to this repository",'For private repositories, make sure your GitHub token has the "repo" scope',"You can add the repo scope with: gh auth refresh -h github.com -s repo,workflow"]});else if(!L.hasAccess)R.push({title:"Admin permissions required",message:`You might need admin permissions on ${$} to set up GitHub Actions.`,instructions:["Repository admins can install GitHub Apps and set secrets","Ask a repository admin to run this command if setup fails","Alternatively, you can use the manual setup instructions"]});let T=await Y($);if(R.length>0){let M=[...Q.warnings,...R];I((P)=>({...P,selectedRepoName:$,workflowExists:T,warnings:M,step:"warnings"}))}else I((M)=>({...M,selectedRepoName:$,workflowExists:T,step:"install-app"})),setTimeout(()=>{Z()},0)}else if(Q.step==="install-app")if(Q.workflowExists)I(($)=>({...$,step:"check-existing-workflow"}));else I(($)=>({...$,step:"select-workflows"}));else if(Q.step==="check-existing-workflow")return;else if(Q.step==="select-workflows")return;else if(Q.step==="check-existing-secret")if(Q.useExistingSecret){I(($)=>({...$,step:"creating",currentWorkflowInstallStep:0}));try{await s2A(Q.selectedRepoName,null,Q.secretName,()=>{I(($)=>({...$,currentWorkflowInstallStep:$.currentWorkflowInstallStep+1}))},Q.workflowAction==="skip",Q.selectedWorkflows,{useCurrentRepo:Q.useCurrentRepo,workflowExists:Q.workflowExists,secretExists:Q.secretExists}),I(($)=>({...$,step:"success"}))}catch($){let R=$ instanceof Error?$.message:"Failed to set up GitHub Actions";if(R.includes("workflow file already exists"))E1("tengu_install_github_app_error",{reason:"workflow_file_exists"}),I((L)=>({...L,step:"error",error:"A Claude workflow file already exists in this repository.",errorReason:"Workflow file conflict",errorInstructions:["The file .github/workflows/claude.yml already exists","You can either:","  1. Delete the existing file and run this command again","  2. Update the existing file manually using the template from:","     https://github.com/anthropics/claude-code-action/#manual-setup-direct-api"]}));else E1("tengu_install_github_app_error",{reason:"setup_github_actions_failed"}),I((L)=>({...L,step:"error",error:R,errorReason:"GitHub Actions setup failed",errorInstructions:[]}))}}else I(($)=>({...$,step:"api-key"}));else if(Q.step==="api-key"){let $=Q.useExistingKey?B:Q.apiKey;if(!$){E1("tengu_install_github_app_error",{reason:"api_key_missing"}),I((R)=>({...R,step:"error",error:"API key is required"}));return}I((R)=>({...R,apiKey:$,step:"creating",currentWorkflowInstallStep:0}));try{await s2A(Q.selectedRepoName,$,Q.secretName,()=>{I((R)=>({...R,currentWorkflowInstallStep:R.currentWorkflowInstallStep+1}))},Q.workflowAction==="skip",Q.selectedWorkflows,{useCurrentRepo:Q.useCurrentRepo,workflowExists:Q.workflowExists,secretExists:Q.secretExists}),I((R)=>({...R,step:"success"}))}catch(R){let L=R instanceof Error?R.message:"Failed to set up GitHub Actions";if(L.includes("workflow file already exists"))E1("tengu_install_github_app_error",{reason:"workflow_file_exists"}),I((T)=>({...T,step:"error",error:"A Claude workflow file already exists in this repository.",errorReason:"Workflow file conflict",errorInstructions:["The file .github/workflows/claude.yml already exists","You can either:","  1. Delete the existing file and run this command again","  2. Update the existing file manually using the template from:","     https://github.com/anthropics/claude-code-action/#manual-setup-direct-api"]}));else E1("tengu_install_github_app_error",{reason:"setup_github_actions_failed"}),I((T)=>({...T,step:"error",error:L,errorReason:"GitHub Actions setup failed",errorInstructions:[]}))}}},F=($)=>{I((R)=>({...R,selectedRepoName:$}))},X=($)=>{I((R)=>({...R,apiKey:$}))},V=($)=>{if($&&!/^[a-zA-Z0-9_]+$/.test($))return;I((R)=>({...R,secretName:$}))},C=($)=>{I((R)=>({...R,useCurrentRepo:$,selectedRepoName:$?R.currentRepo:""}))},K=($)=>{I((R)=>({...R,useExistingKey:$}))},z=($)=>{I((R)=>({...R,useExistingSecret:$,secretName:$?"ANTHROPIC_API_KEY":""}))},U=async($)=>{if($==="exit"){A.onDone("Installation cancelled by user");return}if(I((R)=>({...R,workflowAction:$})),$==="skip")I((R)=>({...R,step:"check-existing-secret"})),await W();else if($==="update")I((R)=>({...R,step:"check-existing-secret"})),await W()};switch(V0(()=>{if(Q.step==="success"||Q.step==="error"){if(Q.step==="success")E1("tengu_install_github_app_completed",{});A.onDone(Q.step==="success"?"GitHub Actions setup complete!":Q.error?`Couldn't install GitHub App: ${Q.error}
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`)))),j8.createElement(h,{alignItems:"flex-start",justifyContent:"flex-start",borderColor:z==="bash"?"bashBorder":z==="memory"||z==="memorySelect"?"remember":"secondaryBorder",borderDimColor:z!=="memory",borderStyle:"round",marginTop:$.length>0?0:1,width:"100%"},j8.createElement(h,{alignItems:"flex-start",alignSelf:"flex-start",flexWrap:"nowrap",justifyContent:"flex-start",width:3},z==="bash"?j8.createElement(S,{color:"bashBorder",dimColor:D},"!"):z==="memory"||z==="memorySelect"?j8.createElement(S,{color:"remember",dimColor:D},"#"):j8.createElement(S,{color:D?"secondaryText":void 0},">")),j8.createElement(h,{paddingRight:1},(()=>{let f0={multiline:!0,onSubmit:m0,onChange:wA,value:C,onHistoryUp:o0,onHistoryDown:V9,onHistoryReset:()=>I0(),placeholder:z==="memory"?'Add to memory. Try "Always use descriptive variable names"':$.length>0&&(FA().queuedCommandUpHintCount||0)<P2?"Press up to edit queued messages":IA?P1:void 0,onExit:K1,onExitMessage:(a0,U9)=>BA({show:a0,key:U9}),onMessage:(a0,U9)=>{if(a0&&U9)k({text:U9},{timeoutMs:3600000});else k({text:""},{timeoutMs:0})},onImagePaste:$2,columns:xB,disableCursorMovementForUpDownKeys:n0.length>0,cursorOffset:T1,onChangeCursorOffset:R1,onPaste:v2,onIsPastingChange:e,focus:z!=="memorySelect",showCursor:z!=="memorySelect",argumentHint:R0,onUndo:m1?()=>{let a0=v1();if(a0)K(a0.text),R1(a0.cursorOffset),Z1(a0.pastedContents)}:void 0};return jp()?j8.createElement(S9A,{...f0,initialMode:B1,onModeChange:v,isLoading:D}):j8.createElement(l3,{...f0})})())),z==="memorySelect"&&j8.createElement(tw1,{onSelect:(f0)=>{m0(C,!1,f0)},onCancel:()=>{U("memory")}}),j8.createElement(tx2,{apiKeyStatus:G,debug:A,exitMessage:WA,vimMode:B1,mode:z,autoUpdaterResult:V,isAutoUpdating:h1,verbose:W,tokenUsage:a8,onAutoUpdaterResult:X,onChangeIsUpdating:DA,suggestions:n0,selectedSuggestion:U0,notification:p,toolPermissionContext:Q,helpOpen:t,suppressHint:C.length>0,shellsSelected:D1,ideSelection:B,mcpClients:a,ideInstallationStatus:Q1,isPasting:O1}))}var Qv2=XO5;function VO5(){Ut1(""),kI(0)}var Iv2=Y1(N1(),1);function Gv2(){Iv2.useEffect(()=>{let A=Math.round(process.uptime()*1000);E1("tengu_timer",{event:"startup",durationMs:A})},[])}var z01=Y1(N1(),1);function Zv2(){let[A,B]=z01.useState(()=>{let Z=jG(!1);if(!nS()||f9())return"valid";if(Z)return"loading";return"missing"}),[Q,I]=z01.useState(null),G=z01.useCallback(async()=>{if(!nS()||f9())return;let Z=jG(!1);if(!Z){B("missing");return}try{let Y=await X$2(Z,!1)?"valid":"invalid";B(Y);return}catch(D){I(D),B("error");return}},[]);return{status:A,reverify:G,error:Q}}function Dv2(A,B,Q,I,G,Z,D,Y){V0((W,J)=>{if(!J.escape)return;if(Z?.aborted)return;if(!Z)return;if(!Q)return;if(I)return;if(jp()&&Y==="INSERT")return;if(G.length>0){if(D)D()}E1("tengu_cancel",{}),A(()=>[]),B()})}var Yv2=Y1(N1(),1);var CO5=["Edit","MultiEdit","Write","NotebookEdit"];function w01(A){return CO5.includes(A)}function E01(A,B,Q,I){let G;if(A.getPath&&B){let Z=A.inputSchema.safeParse(B);if(Z.success){let D=A.getPath(Z.data);if(D)G=_G(D)}}return{decision:Q,source:I,tool_name:A.name,...G&&{language:G}}}async function U01(A,B,Q){await cK("tool_decision",{decision:B,source:Q,tool_name:A})}function KO5(A){return Yv2.useCallback(async(B,Q,I,G)=>{return new Promise((Z)=>{function D(){E1("tengu_tool_use_cancelled",{messageID:G.message.id,toolName:B.name})}function Y(){Z({behavior:"ask",message:k11}),I.abortController.abort()}if(I.abortController.signal.aborted){D(),Y();return}return AL(B,Q,I,G).then(async(W)=>{if(W.behavior==="allow"){if(E1("tengu_tool_use_granted_in_config",{messageID:G.message.id,toolName:B.name}),w01(B.name)){let F=E01(B,Q,"accept","config");dk()?.add(1,F)}U01(B.name,"accept","config"),Z({...W,updatedInput:Q,userModified:!1});return}let J=await B.description(Q,{isNonInteractiveSession:I.options.isNonInteractiveSession,getToolPermissionContext:I.getToolPermissionContext,tools:I.options.tools});if(I.abortController.signal.aborted){D(),Y();return}switch(W.behavior){case"deny":{if(E1("tengu_tool_use_denied_in_config",{messageID:G.message.id,toolName:B.name}),w01(B.name)){let F=E01(B,Q,"reject","config");dk()?.add(1,F)}U01(B.name,"reject","config"),Z(W);return}case"ask":{A((F)=>[...F,{assistantMessage:G,tool:B,description:J,input:Q,toolUseContext:I,permissionResult:W,onAbort(){if(D(),E1("tengu_tool_use_rejected_in_prompt",{messageID:G.message.id,toolName:B.name}),w01(B.name)){let X=E01(B,Q,"reject","user_abort");dk()?.add(1,X)}U01(B.name,"reject","user_abort"),Y()},onAllow(X,V){if(X==="permanent")E1("tengu_tool_use_granted_in_prompt_permanent",{messageID:G.message.id,toolName:B.name});else E1("tengu_tool_use_granted_in_prompt_temporary",{messageID:G.message.id,toolName:B.name});if(w01(B.name)){let U=E01(B,V,"accept",X==="permanent"?"user_permanent":"user_temporary");dk()?.add(1,U)}let C=X==="permanent"?"user_permanent":"user_temporary";U01(B.name,"accept",C);let K=B.inputsEquivalent?!B.inputsEquivalent(Q,V):!1;Z({behavior:"allow",updatedInput:V,userModified:K})},onReject(){if(E1("tengu_tool_use_rejected_in_prompt",{messageID:G.message.id,toolName:B.name}),w01(B.name)){let X=E01(B,Q,"reject","user_reject");dk()?.add(1,X)}U01(B.name,"reject","user_reject"),Y()}}]);return}}}).catch((W)=>{if(W instanceof SG)D(),Y();else d1(W)})})},[A])}var Wv2=KO5;var Jv2=Y1(N1(),1);function Fv2(A,B){return Jv2.useMemo(()=>{if(A&&B&&B.length>0)return RP([...A,...B],"name");return A||[]},[A,B])}var Xv2=Y1(N1(),1);function Vv2(A,B){return Xv2.useMemo(()=>{return RP([...A,...B],"name")},[A,B])}var Cv2=Y1(N1(),1);function Kv2(A,B){return Cv2.useMemo(()=>{if(B.length>0)return RP([...A,...B],"name");return A},[A,B])}var Q9=Y1(N1(),1),MT=Y1(N1(),1);var XI=Y1(N1(),1);function Hv2({message:A,screen:B}){let Q=B==="transcript",I=Bq2(A)||"";return XI.createElement(h,{flexDirection:"column"},XI.createElement(h,{flexDirection:"row"},XI.createElement(h,{minWidth:2},XI.createElement(S,{color:"text"},HE)),XI.createElement(h,{flexDirection:"column"},XI.createElement(S,{bold:!0},"Compact summary",!Q&&XI.createElement(S,{dimColor:!0}," (ctrl+r to expand)")))),Q&&XI.createElement($0,null,XI.createElement(S,null,I)))}var m2=Y1(N1(),1);import{relative as HO5}from"path";function zO5(){let A=FA();b0({...A,lastReleaseNotesSeen:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION})}function zv2(){let A=FA(),{hasReleaseNotes:B,releaseNotes:Q}=m2.useMemo(()=>WE1(A.lastReleaseNotesSeen),[A.lastReleaseNotesSeen]);m2.useEffect(()=>{if(B)zO5()},[B]);let{source:I}=VX(!1),G=!!rn()&&(I==="ANTHROPIC_API_KEY"||I==="apiKeyHelper"),Z=t31(),D=f9()&&(Z.source==="ANTHROPIC_AUTH_TOKEN"||Z.source==="apiKeyHelper"),Y=I!=="none"&&Z.source!=="none"&&!(I==="apiKeyHelper"&&Z.source==="apiKeyHelper");return m2.createElement(h,{flexDirection:"column",paddingLeft:1},m2.createElement(UO5,null),D&&m2.createElement(h,{flexDirection:"row",marginTop:1},m2.createElement(S,{color:"warning"},Y0.warning),m2.createElement(S,{color:"warning"},"Auth conflict: Using ",Z.source," instead of Claude account subscription token. Either unset ",Z.source,", or run `claude /logout`.")),G&&m2.createElement(h,{flexDirection:"row",marginTop:1},m2.createElement(S,{color:"warning"},Y0.warning),m2.createElement(S,{color:"warning"},"Auth conflict: Using ",I," instead of Anthropic Console key. Either unset ",I,", or run `claude /logout`.")),Y&&m2.createElement(h,{flexDirection:"column",marginTop:1},m2.createElement(h,{flexDirection:"row"},m2.createElement(S,{color:"warning"},Y0.warning),m2.createElement(S,{color:"warning"},"Auth conflict: Both a token (",Z.source,") and an API key (",I,") are set. This may lead to unexpected behavior.")),m2.createElement(h,{flexDirection:"column",marginLeft:3},m2.createElement(S,{color:"warning"}," Trying to use"," ",Z.source==="claude.ai"?"claude.ai":Z.source,"?"," ",I==="ANTHROPIC_API_KEY"?'Unset the ANTHROPIC_API_KEY environment variable, or claude /logout then say "No" to the API key approval before login.':I==="apiKeyHelper"?"Unset the apiKeyHelper setting.":"claude /logout"),m2.createElement(S,{color:"warning"}," Trying to use ",I,"?"," ",Z.source==="claude.ai"?"claude /logout to sign out of claude.ai.":`Unset the ${Z.source} environment variable.`))),B&&m2.createElement(h,{flexDirection:"column",marginTop:1},m2.createElement(S,{color:"secondaryText"},"What's new:"),m2.createElement(h,{flexDirection:"column",marginLeft:1},Q.map((W,J)=>m2.createElement(S,{key:J,color:"secondaryText"}," ",W)))))}function wO5({path:A,contentLength:B}){let Q=A.startsWith(iA())?HO5(iA(),A):A;return m2.createElement(h,{flexDirection:"row"},m2.createElement(S,{color:"warning"},Y0.warning),m2.createElement(S,{color:"warning"},"Large ",m2.createElement(S,{bold:!0},Q)," will impact performance (",hG(B)," chars >"," ",hG(i11),")",m2.createElement(S,{color:"secondaryText",dimColor:!0}," "," /memory to edit")))}function EO5(){let A=oO();if(!A)return null;let B=A.content.length;if(B>Ru)return m2.createElement(h,{flexDirection:"row",gap:1},m2.createElement(S,{color:"warning"},Y0.warning),m2.createElement(S,{color:"warning"},"ULTRACLAUDE.md exceeds ",Ru," chars (",B," chars)",m2.createElement(S,{color:"secondaryText",dimColor:!0}," "," /memory to edit")));return null}function UO5(){if(sG().length===0)return null;return m2.createElement(h,{flexDirection:"column"},rH1().map((B)=>m2.createElement(wO5,{key:B.path,path:B.path,contentLength:B.content.length})),m2.createElement(EO5,null))}var $T=Y1(N1(),1);function wv2(){return FA().tipsHistory||{}}function NO5(A){let B=FA();b0({...B,tipsHistory:A})}function Ev2(A){let B=wv2(),Q=FA().numStartups;B[A]=Q,NO5(B)}function qO5(A){return wv2()[A]||0}function y9A(A){let B=qO5(A);if(B===0)return 1/0;return FA().numStartups-B}async function MO5(A){return(await Promise.all(A.map(async(Q)=>{let I=await Q.isRelevant();return{tip:Q,isRelevant:I}}))).filter((Q)=>Q.isRelevant).map((Q)=>Q.tip)}function LO5(A){return A.filter((B)=>{return y9A(B.id)>=B.cooldownSessions})}function RO5(){let A=FA(),{hasReleaseNotes:B}=WE1(A.lastReleaseNotesSeen);return!B}function OO5(A){if(A.length===0)return;if(A.length===1)return A[0];let B=A.map((Q)=>({tip:Q,sessions:y9A(Q.id)}));return B.sort((Q,I)=>I.sessions-Q.sessions),B[0]?.tip}async function Uv2(A,B=!1){if(!RO5()||B)return;let Q=await MO5(A),I=LO5(Q);if(I.length===0)return;let G=I.find((Z)=>Z.id==="claude-opus-welcome");if(G)return G;return OO5(I)}function Nv2(A){Ev2(A.id),E1("tengu_tip_shown",{tipIdLength:A.id,cooldownSessions:A.cooldownSessions})}function qv2({tip:A}){$T.useEffect(()=>{if(!A)return;Nv2(A)},[A]);let B=()=>{if(!A)return null;if(typeof A.content==="function")return A.content();if(A.id==="claude-opus-welcome")return $T.default.createElement(S,{color:"secondaryText"}," ",A.content);return $T.default.createElement(S,{color:"secondaryText"}," Tip: ",A.content)};return $T.default.createElement($T.default.Fragment,null,A&&$T.default.createElement(h,{key:`tip-${A?.id}`,flexDirection:"row",marginTop:1,alignItems:"center",marginLeft:1},B()))}var SV=Y1(N1(),1);async function TO5(){if(f9())return!1;let A=await sdA(!1);if(!A)return!1;return Boolean(A.account.has_claude_max)||Boolean(A.account.has_claude_pro)}function $v2(){let[A]=SV.useState(()=>{let B=FA(),Q=B.subscriptionNoticeCount??0,I=B.hasAvailableSubscription;if(Q>=3)return!1;return I??!1});return SV.useEffect(()=>{TO5().then((B)=>{let Q=FA(),I=Q.subscriptionNoticeCount??0;if(B)I+=1;if(Q.subscriptionNoticeCount!==I||Q.hasAvailableSubscription!==B)b0({...Q,subscriptionNoticeCount:I,hasAvailableSubscription:B})})},[A]),A}function Mv2(){return SV.useEffect(()=>{E1("tengu_switch_to_subscription_notice_shown",{})},[]),SV.createElement(h,{paddingLeft:1,marginTop:1,marginBottom:1},SV.createElement(S,{color:"suggestion"},"You can now use your Claude subscription with ",r0,SV.createElement(S,{color:"text",dimColor:!0}," "," /login to activate")))}var k9A=Y1(N1(),1);function Lv2({message:A,isTranscriptMode:B}){if(!(B&&A.timestamp&&A.type==="assistant"&&A.message.content.some((G)=>G.type==="text")))return null;let I=new Date(A.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return k9A.default.createElement(h,{marginTop:1},k9A.default.createElement(S,{dimColor:!0},I))}var N01=10;function x9A({messages:A,normalizedMessageHistory:B,tools:Q,verbose:I,toolJSX:G,toolUseConfirmQueue:Z,inProgressToolUseIDs:D,isMessageSelectorVisible:Y,tipOfTheDay:W,conversationId:J,screen:F,screenToggleId:X,streamingToolUses:V,showAllInTranscript:C=!1}){let K=Up(),{columns:z}=r9(),U=$v2(),$=Sq2(),[R,L]=Q9.useState([]);Q9.useEffect(()=>{Hp().then((a)=>L(a))},[]);let T=MT.useMemo(()=>HQ(A).filter(qy),[A]),M=MT.useMemo(()=>new Set(Object.keys(zu(T))),[T]),P=MT.useMemo(()=>SH1(T),[T]),x=MT.useMemo(()=>V.filter((a)=>{if(D.has(a.contentBlock.id))return!1;if(T.some((u)=>u.type==="assistant"&&u.message.content[0].type==="tool_use"&&u.message.content[0].id===a.contentBlock.id))return!1;return!0}),[V,D,T]),p=MT.useMemo(()=>x.flatMap((a)=>HQ([dK({content:[a.contentBlock]})])),[x]),k=MT.useCallback((a)=>{let u=F==="transcript",Z1=u&&!C,B1=Z1?T.slice(-N01):T,v=Z1&&T.length>N01;return[{type:"static",jsx:Q9.createElement(h,{flexDirection:"column",gap:1,key:`logo-${J}-${X}`},Q9.createElement(Ep,{model:K}),Ow1()?Q9.createElement(J2A,null):Q9.createElement(zv2,null))},...!gY(process.env.IS_DEMO)&&W?[{type:"static",jsx:Q9.createElement(h,{key:`tip-of-the-day-${J}-${X}`},Q9.createElement(qv2,{tip:W}))}]:[],...U?[{type:"static",jsx:Q9.createElement(h,{key:`max-subscription-${J}-${X}`},Q9.createElement(Mv2,null))}]:[],...$&&!U?[{type:"static",jsx:Q9.createElement(h,{key:`subscription-upsell-${J}-${X}`},Q9.createElement(_q2,null))}]:[],...R.length>0?[{type:"static",jsx:Q9.createElement(h,{key:`install-messages-${J}-${X}`,flexDirection:"column",paddingLeft:1},R.map((Q1,K1)=>Q9.createElement(h,{key:K1,flexDirection:"row",marginTop:1},Q9.createElement(S,{color:"warning"},Y0.bullet),Q9.createElement(S,{color:"warning"}," ",Q1))))}]:[],...v?[{type:"static",jsx:Q9.createElement(Tp,{key:`truncation-indicator-${J}-${X}`,dividerChar:"",title:`Ctrl+E to show ${LA.bold(T.length-N01)} previous messages`,titleColor:"secondaryText",dividerColor:"secondaryBorder",width:z})}]:[],...u&&C&&T.length>N01?[{type:"static",jsx:Q9.createElement(Tp,{key:`hide-indicator-${J}-${X}`,dividerChar:"",title:`Ctrl+E to hide ${LA.bold(T.length-N01)} previous messages`,titleColor:"secondaryText",dividerColor:"secondaryBorder",width:z})}]:[],...B.length>0?[{type:"static",jsx:Q9.createElement(h,{flexDirection:"column",gap:1,key:`history-${J}-${X}`},ce1(B.filter((Q1)=>Q1.type!=="progress").filter((Q1)=>Q1.type!=="user"||!Q1.isMeta),[]).map((Q1)=>Q9.createElement(h,{key:`history-${Q1.uuid}-${X}`,width:z-5},Q9.createElement($E,{message:Q1,messages:B,addMargin:!0,tools:Q,verbose:a,erroredToolUseIDs:new Set,inProgressToolUseIDs:new Set,progressMessagesForMessage:[],shouldAnimate:!1,shouldShowDot:!0,resolvedToolUseIDs:new Set}))),Q9.createElement(Tp,{dividerChar:"=",title:"Previous Conversation Compacted"}))}]:[],...ce1(B1.filter((Q1)=>Q1.type!=="progress").filter((Q1)=>Q1.type!=="user"||!Q1.isMeta),p).map((Q1)=>{let K1=f11(Q1),f1=Qq2(Q1,T),h1=Q1.type==="user"&&Q1.isCompactSummary?Q9.createElement(Hv2,{message:Q1,screen:F}):Q9.createElement($E,{message:Q1,messages:T,addMargin:!0,tools:Q,verbose:a,erroredToolUseIDs:P,inProgressToolUseIDs:D,progressMessagesForMessage:f1,shouldAnimate:!G&&!Z.length&&!Y&&(!K1||D.has(K1)),shouldShowDot:!0,resolvedToolUseIDs:M});return{type:PO5(Q1,A,new Set(V.map((DA)=>DA.contentBlock.id)),M,F)?"static":"transient",jsx:Q9.createElement(h,{key:`${Q1.uuid}-${f1.length}-${X}`,width:z-5,flexDirection:"column"},Q9.createElement(Lv2,{message:Q1,isTranscriptMode:u}),h1)}}).filter((Q1)=>Q1!==void 0),...G$2()?[{type:"static",jsx:Q9.createElement(D$2,null)}]:[]]},[F,C,T,J,X,K,W,U,$,R,z,B,p,Q,P,D,G,Z.length,Y,M,A,V]);return Q9.createElement(Q9.Fragment,null,Q9.createElement(x31,{key:`static-messages-${J}-${X}`,items:k(I).filter((a)=>a.type==="static")},(a)=>a.jsx),k(I).filter((a)=>a.type==="transient").map((a)=>a.jsx))}function PO5(A,B,Q,I,G){if(G==="transcript")return!0;switch(A.type){case"attachment":return!0;case"system":case"user":case"assistant":{let Z=f11(A);if(!Z)return!0;if(Q.has(Z))return!1;let D=eN2(A,B);return Uo0(D,I)}case"progress":return!1}}import{randomUUID as v9A}from"crypto";function Rv2(A,B,Q,I,G){V0(async(Z,D)=>{if(D.ctrl&&Z==="r")B((Y)=>Y==="transcript"?"prompt":"transcript"),Q((Y)=>Y+1),I(!1),await G();if(D.ctrl&&Z==="e"&&A==="transcript")I((Y)=>!Y),Q((Y)=>Y+1),await G();if(D.ctrl&&Z==="c"&&A==="transcript")B("prompt"),Q((Y)=>Y+1),I(!1),await G()})}var q01=Y1(N1(),1);var SO5=d.object({method:d.literal("selection_changed"),params:d.object({selection:d.object({start:d.object({line:d.number(),character:d.number()}),end:d.object({line:d.number(),character:d.number()})}).nullable().optional(),text:d.string().optional(),filePath:d.string().optional()})});function Ov2(A,B){let Q=q01.useRef(!1),I=q01.useRef(null);q01.useEffect(()=>{let G=FW(A);if(I.current!==G)Q.current=!1,I.current=G||null,B({lineCount:0,text:void 0,filePath:void 0});if(Q.current||!G)return;let Z=(D)=>{if(D.selection?.start&&D.selection?.end){let{start:Y,end:W}=D.selection,J=W.line-Y.line+1;if(W.character===0)J--;let F={lineCount:J,text:D.text,filePath:D.filePath};B(F)}};G.client.setNotificationHandler(SO5,(D)=>{if(I.current!==G)return;try{let Y=D.params;if(Y.selection&&Y.selection.start&&Y.selection.end)Z(Y);else if(Y.text!==void 0)Z({selection:null,text:Y.text,filePath:Y.filePath})}catch(Y){console.error("Error processing selection_changed notification:",Y)}}),Q.current=!0},[A,B])}var xp=Gw();function _E1(A){xp=A}function _O5(A,B,Q){if(Q.type!=="assistant")return;if(!Array.isArray(Q.message.content))return;for(let I of Q.message.content){if(I.type!=="tool_use")continue;let G=A.find((Z)=>Z.name===I.name);if(G)B.set(I.id,G)}}function jE1(A,B){try{let Q=Aq2(A);if(Q[Q.length-1]?.type==="user")Q.push(dK({content:x11}));let G=new Map;for(let Z of Q)_O5(B,G,Z);return Q}catch(Q){throw d1(Q),Q}}async function LT(A,B){try{let Q;if(A===void 0)Q=await vD0(0);else if(typeof A==="string")Q=await xD0(A);else Q=A;if(!Q)return null;return qJ1(Q),{messages:jE1(Q.messages,B),log:Q}}catch(Q){throw d1(Q),Q}}var vp=Y1(N1(),1);function Tv2(){let[A,B]=vp.useState([]),Q=vp.useRef([]),I=vp.useCallback((G)=>{Q.current=G(Q.current),B(Q.current)},[B]);return{queuedCommands:A,queuedCommandsRef:Q,setQueuedCommands:I}}function fp({commands:A,debug:B,initialPrompt:Q,shouldShowPromptInput:I,initialTools:G,initialMessages:Z,initialTodos:D,tipOfTheDay:Y,mcpClients:W,dynamicMcpConfig:J,autoConnectIdeFlag:F}){let[X,V]=B8(),{todoFeatureEnabled:C,toolPermissionContext:K,verbose:z,mainLoopModel:U,maxRateLimitFallbackActive:$,mcp:R,rateLimitResetsAt:L}=X,T=Up(),M=qu(),P=g9.useMemo(()=>UT(K,C),[K,C]),[x,p]=g9.useState(J),k=g9.useCallback((VA)=>{p(VA)},[p]),[a,u]=g9.useState("prompt"),[Z1,B1]=g9.useState(1),[v,Q1]=g9.useState(!1),{notification:K1,addNotification:f1}=s$2();sR2(f1,x);let h1=Fv2(W,R.clients),DA=Vv2([...P,...G],R.tools),WA=Kv2(A,R.commands),[BA,P1]=g9.useState(null);oR2(R.clients),Ov2(R.clients,P1);let[I1,T1]=g9.useState("responding"),[R1,t1]=g9.useState([]),[HA,RA]=g9.useState(null),[t,A1]=g9.useState(!1),[D1,U1]=g9.useState(null),[O1,e]=g9.useState(null),[y1,v1]=g9.useState([]),[m1,AA]=g9.useState(Z??[]),[IA,wA]=g9.useState([]),[I0,yA]=g9.useState(""),[K0,A2]=g9.useState("prompt"),{queuedCommands:u0,queuedCommandsRef:P2,setQueuedCommands:o0}=Tv2(),[V9,q6]=g9.useState({}),[z0,m0]=g9.useState(0),[n0,U0]=g9.useState(0),[R0,$2]=g9.useState(null),[v2,W5]=g9.useState(!1),[CB,J6]=g9.useState(!1),[t2,$6]=g9.useState(v9A()),[xB,a8]=g9.useState(FA().hasAcknowledgedCostThreshold),[f0,a0]=g9.useState(new Set),[U9,e6]=g9.useState("INSERT"),{haikuWords:y8,generateHaikuWord:k6}=hy2(t),[z8,R3]=g9.useState(null),[O3,e1]=g9.useState(!1);g9.useEffect(()=>{function VA(mA){if(!mA)return;if(!(FA().autoConnectIde||F||cJ()||process.env.CLAUDE_CODE_AUTO_CONNECT_IDE==="true"))return;p((H2)=>{if(H2?.ide)return H2;return{...H2,ide:{type:mA.url.startsWith("ws:")?"ws-ide":"sse-ide",url:mA.url,ideName:mA.name,authToken:mA.authToken,scope:"dynamic"}}})}l02(VA,()=>e1(!0),(mA)=>{R3(mA)})},[]),g9.useEffect(()=>{if(L!==M.resetsAt)V((VA)=>({...VA,rateLimitResetsAt:M.resetsAt}));if(eq2($,L,M,(VA)=>V((mA)=>({...mA,maxRateLimitFallbackActive:VA}))),$&&U===null)f1({text:`Claude Opus 4 limit reached, now using ${$_(RX())}`})},[f1,$,U,L,M,V]);let $1=g9.useCallback((VA)=>{wA(VA),$3(),$6(v9A())},[]),a1=g9.useCallback(async(VA,mA)=>{let B2=jE1(mA.messages,DA);qJ1(mA),A1(!1),RA(null),U0(0),t1([]),$2(null),await $3(),$6(VA),AA(()=>B2),e(null),yA(""),wA([])},[DA]),_A=(VA)=>{if(yA(VA),K0!=="prompt")return;if(!VA)return;if(y8.length>0&&(!VA.endsWith(" ")||I0.endsWith(" ")))return;if(!VA.includes(" "))return;if(VA.length>=3&&!VA.startsWith("!")&&!VA.startsWith("#")&&!VA.startsWith("/"))k6(VA)},xA=g9.useMemo(()=>aR(h9()),[]),y0=g9.useRef({[xA]:{content:JSON.stringify(D||[]),timestamp:0}}),{status:I9,reverify:n9}=Zv2();function T4(){if(!t)return;if(A1(!1),U0(0),t1([]),$2(null),y1[0])y1[0].onAbort(),v1([]);else HA?.abort()}let M6=g9.useCallback(()=>{if(u0.length===0)return;yA([...u0.map((VA)=>VA.value),I0].filter(Boolean).join(`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/claude-code/cli.js:`).filter(Boolean),Q=b1();for(let I of B)if(I.includes("node_modules")||I.includes("npm"))try{Q.unlinkSync(I),v9(`Removed stale npm claude command at ${I}`)}catch{}}function sT5({onDone:A,force:B}){let[Q,I]=y6.useState({type:"checking"});return y6.useEffect(()=>{async function G(){try{v9(`Install: Starting installation process (force=${B})`),I({type:"cleaning-npm"});let{removed:Z,errors:D}=await nT5();if(Z>0)v9(`Cleaned up ${Z} npm installation(s)`);if(D.length>0&&!B){I({type:"error",message:`Cleanup errors: ${D.join(", ")}`});return}I({type:"installing",version:"latest"}),v9("Install: Calling installLatest(force=true)");let Y=await zp(!0);if(v9(`Install: installLatest returned version=${Y.latestVersion}, wasUpdated=${Y.wasUpdated}`),!Y.latestVersion)m6("Install: Failed to retrieve version information during install");if(!Y.wasUpdated&&!B)v9("Install: Already up to date");I({type:"setting-up"});let W=await Hp(!0);if(v9(`Install: Setup launcher completed with ${W.length} messages`),W.length>0)W.forEach((J)=>v9(`Install: Setup message: ${J}`));if(E1("claude_install_command",{has_version:Y.latestVersion?1:0,forced:B?1:0}),W.length>0)I({type:"set-up",messages:W}),setTimeout(()=>{I({type:"success",version:Y.latestVersion||"current"})},2000);else v9("Install: Shell PATH already configured"),I({type:"success",version:Y.latestVersion||"current"})}catch(Z){m6(`Install command failed: ${Z}`),I({type:"error",message:Z instanceof Error?Z.message:String(Z)})}}G()},[B]),y6.useEffect(()=>{if(Q.type==="success")A();else if(Q.type==="error")setTimeout(()=>{A()},3000)},[Q,A]),y6.default.createElement(h,{flexDirection:"column",marginTop:1},Q.type==="checking"&&y6.default.createElement(S,{color:"claude"},"Checking installation status..."),Q.type==="cleaning-npm"&&y6.default.createElement(S,{color:"warning"},"Cleaning up old npm installations..."),Q.type==="installing"&&y6.default.createElement(S,{color:"claude"},"Installing Claude Code native build",Q.version!=="latest"?` (${Q.version})`:"","..."),Q.type==="setting-up"&&y6.default.createElement(S,{color:"claude"},"Setting up launcher and shell integration..."),Q.type==="set-up"&&y6.default.createElement(h,{flexDirection:"column",gap:1},y6.default.createElement(S,{color:"warning"},"Setup notes:"),Q.messages.map((G,Z)=>y6.default.createElement(h,{key:Z,marginLeft:2},y6.default.createElement(S,{color:"secondaryText"}," ",G)))),Q.type==="success"&&y6.default.createElement(h,{flexDirection:"column",gap:1},y6.default.createElement(h,null,y6.default.createElement(S,{color:"success"},Y0.tick," "),y6.default.createElement(S,{color:"success",bold:!0},"Claude Code successfully installed!")),y6.default.createElement(h,{marginLeft:2,flexDirection:"column",gap:1},Q.version!=="current"&&y6.default.createElement(h,null,y6.default.createElement(S,{color:"secondaryText"},"Version: "),y6.default.createElement(S,{color:"claude"},Q.version)),y6.default.createElement(h,null,y6.default.createElement(S,{color:"secondaryText"},"Location: "),y6.default.createElement(S,{color:"text"},"~/.claude/bin/claude")),y6.default.createElement(h,{marginTop:1},y6.default.createElement(S,{color:"secondaryText"},"Next: Run "),y6.default.createElement(S,{color:"claude",bold:!0},"claude --help"),y6.default.createElement(S,{color:"secondaryText"}," to get started")))),Q.type==="error"&&y6.default.createElement(h,{flexDirection:"column",gap:1},y6.default.createElement(h,null,y6.default.createElement(S,{color:"error"},Y0.cross," "),y6.default.createElement(S,{color:"error"},"Installation failed")),y6.default.createElement(S,{color:"error"},Q.message),y6.default.createElement(h,{marginTop:1},y6.default.createElement(S,{color:"secondaryText"},"Try running with --force to override checks"))))}var Pf2={type:"local-jsx",name:"install",description:"Install Claude Code native build",argumentHint:"[options]",async call(A,B,Q){let I=Q.includes("--force"),{unmount:G}=Y8(y6.default.createElement(sT5,{onDone:()=>{G(),A()},force:I}))}};process.env.COREPACK_ENABLE_AUTO_PIN="0";function rT5(){let A=process.execArgv.some((Q)=>/--inspect(-brk)?|--debug(-brk)?/.test(Q)),B=process.env.NODE_OPTIONS&&/--inspect(-brk)?|--debug(-brk)?/.test(process.env.NODE_OPTIONS);try{return!!global.require("inspector").url()||A||B}catch{return A||B}}if(rT5())process.exit(1);function BP5(){let A=FA();b0({...A,hasCompletedOnboarding:!0,lastOnboardingVersion:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.35"}.VERSION})}async function QP5(A){if(!1==="true"||process.env.IS_DEMO)return!1;let B=FA(),Q=!1;if(!B.theme||!B.hasCompletedOnboarding)Q=!0,await $3(),await new Promise((I)=>{let{unmount:G}=Y8(kB.default.createElement(GQ,{onChangeAppState:OT},kB.default.createElement(l2A,{onDone:async()=>{BP5(),await $3(),G(),I()}})),{exitOnCtrlC:!1})});if(B.hasCompletedOnboarding&&!B.hasSeenGAAnnounce&&!Q&&kE1())await $3(),await new Promise((I)=>{let{unmount:G}=Y8(kB.default.createElement(GQ,{onChangeAppState:OT},kB.default.createElement(rv2,{onDismiss:async()=>{let Z=FA();b0({...Z,hasSeenGAAnnounce:!0}),await $3(),G(),I()}})),{exitOnCtrlC:!1})});if(process.env.ANTHROPIC_API_KEY){let I=UJ(process.env.ANTHROPIC_API_KEY);if(cG1(I)==="new")await new Promise((Z)=>{let{unmount:D}=Y8(kB.default.createElement(GQ,{onChangeAppState:OT},kB.default.createElement(QE1,{customApiKeyTruncated:I,onDone:()=>{D(),Z()}})),{exitOnCtrlC:!1})})}if(A!=="bypassPermissions"&&process.env.CLAUBBIT!=="true"){if(!zY0())await new Promise((I)=>{let{unmount:G}=Y8(kB.default.createElement(GQ,null,kB.default.createElement(tv2,{onDone:()=>{G(),I()}})),{exitOnCtrlC:!1})});if(await Vf2(),await S$2())await new Promise((I)=>{let{unmount:G}=Y8(kB.default.createElement(GQ,null,kB.default.createElement(bw1,{onDone:()=>{G(),I()}})),{exitOnCtrlC:!1})})}if(A==="bypassPermissions"&&!FA().bypassPermissionsModeAccepted)await new Promise((I)=>{let{unmount:G}=Y8(kB.default.createElement(GQ,null,kB.default.createElement(Cf2,{onAccept:()=>{G(),I()}})))});return Q}function IP5(){let A=FA();b0({...A,numStartups:(A.numStartups??0)+1}),GP5(),E4A()?.add(1)}async function GP5(){let[A,B]=await Promise.all([bz(),mn()]);E1("tengu_startup_telemetry",{is_git:A,worktree_count:B})}function ZP5(){zf2(),wf2(),Ef2(),Uf2(),efA()}async function PT(A,B,Q,I){let G=process.version.match(/^v(\d+)\./)?.[1];if(!G||parseInt(G)<18)console.error(LA.bold.red("Error: Claude Code requires Node.js version 18 or higher.")),process.exit(1);let Z=m_2();if(Z.status==="restored")console.log(LA.yellow("Detected an interrupted iTerm2 setup. Your original settings have been restored. You may need to restart iTerm2 for the changes to take effect."));else if(Z.status==="failed")console.error(LA.red(`Failed to restore iTerm2 settings. Please manually restore your original settings with: defaults import com.googlecode.iterm2 ${Z.backupPath}.`));try{let J=await Pw1();if(J.status==="restored")console.log(LA.yellow("Detected an interrupted Terminal.app setup. Your original settings have been restored. You may need to restart Terminal.app for the changes to take effect."));else if(J.status==="failed")console.error(LA.red(`Failed to restore Terminal.app settings. Please manually restore your original settings with: defaults import com.apple.Terminal ${J.backupPath}.`))}catch(J){d1(J instanceof Error?J:new Error(String(J)))}let D=Q??!1;OX(A),LX(),Yf2(),Jf2(),zy2(),MD0(),M9A(),ww1(D),_W(),_E(),R_(),aS(),Of1(),UJ1([],h9()),Pq2(),$9A(),oq2().catch(d1),t_2();let Y=new AbortController;if(setTimeout(()=>Y.abort(),3000),U81(iA(),Y.signal,[]),B==="bypassPermissions"){if(process.platform!=="win32"&&typeof process.getuid==="function"&&process.getuid()===0)console.error("--dangerously-skip-permissions cannot be used with root/sudo privileges for security reasons"),process.exit(1)}let W=a9();if(W.lastCost!==void 0&&W.lastDuration!==void 0)E1("tengu_exit",{last_session_cost:W.lastCost,last_session_api_duration:W.lastAPIDuration,last_session_duration:W.lastDuration,last_session_lines_added:W.lastLinesAdded,last_session_lines_removed:W.lastLinesRemoved,last_session_total_input_tokens:W.lastTotalInputTokens,last_session_total_output_tokens:W.lastTotalOutputTokens,last_session_total_cache_creation_input_tokens:W.lastTotalCacheCreationInputTokens,last_session_total_cache_read_input_tokens:W.lastTotalCacheReadInputTokens,last_session_id:W.lastSessionId}),E5({...W,lastCost:void 0,lastAPIDuration:void 0,lastDuration:void 0,lastLinesAdded:void 0,lastLinesRemoved:void 0,lastTotalInputTokens:void 0,lastTotalOutputTokens:void 0,lastTotalCacheCreationInputTokens:void 0,lastTotalCacheReadInputTokens:void 0,lastSessionId:void 0});if(W.pendingExitFeedback){let J=W.pendingExitFeedback;E1("tengu_exit_feedback",{feedback_choice:J.feedbackChoice,feedback_details:J.feedbackDetails,last_session_id:J.sessionId,model:J.model}),E5({...W,pendingExitFeedback:void 0})}if(!1)try{}catch{}}async function DP5(){if(process.argv[2]==="--ripgrep"){let B=process.argv.slice(3);process.exit(Hs0(B))}if(!process.env.CLAUDE_CODE_ENTRYPOINT)process.env.CLAUDE_CODE_ENTRYPOINT="cli";process.on("exit",()=>{FP5()}),process.on("SIGINT",()=>{process.exit(0)});let A=Ks0();if(A instanceof Promise)await A;process.title="claude",await JP5()}function YP5(A){let B={exitOnCtrlC:A,onFlicker(){E1("tengu_flicker",{})}};if(!process.stdin.isTTY&&!0&&!process.argv.includes("mcp")){if(process.platform!=="win32")try{let Q=tT5("/dev/tty","r");B={...B,stdin:new oT5(Q)}}catch(Q){d1(Q)}}return B}async function WP5(A,B){if(!process.stdin.isTTY&&!process.argv.includes("mcp")){if(B==="stream-json")return process.stdin;let Q="";for await(let I of process.stdin)Q+=I;return[A,Q].filter(Boolean).join(`
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/src/index.ts:   * Defaults to process.env['ANTHROPIC_API_KEY'].
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/src/index.ts:   * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/src/index.ts:    apiKey = Core.readEnv('ANTHROPIC_API_KEY') ?? null,
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.d.mts:     * Defaults to process.env['ANTHROPIC_API_KEY'].
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.d.mts:     * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.d.ts:     * Defaults to process.env['ANTHROPIC_API_KEY'].
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.d.ts:     * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.js:     * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.js:    constructor({ baseURL = Core.readEnv('ANTHROPIC_BASE_URL'), apiKey = Core.readEnv('ANTHROPIC_API_KEY') ?? null, authToken = Core.readEnv('ANTHROPIC_AUTH_TOKEN') ?? null, ...opts } = {}) {
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.mjs:     * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/index.mjs:    constructor({ baseURL = Core.readEnv('ANTHROPIC_BASE_URL'), apiKey = Core.readEnv('ANTHROPIC_API_KEY') ?? null, authToken = Core.readEnv('ANTHROPIC_AUTH_TOKEN') ?? null, ...opts } = {}) {
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/README.md:  apiKey: process.env['ANTHROPIC_API_KEY'], // This is the default and can be omitted
/usr/lib/node_modules/task-master-ai/node_modules/@anthropic-ai/sdk/README.md:  apiKey: process.env['ANTHROPIC_API_KEY'], // This is the default and can be omitted
/usr/lib/node_modules/task-master-ai/.cursor/mcp.json:				"ANTHROPIC_API_KEY": "ANTHROPIC_API_KEY_HERE",
/usr/lib/node_modules/task-master-ai/.cursor/rules/tests.mdc:  const anthropic = new Anthropic({ apiKey: process.env.ANTHROPIC_API_KEY });
/usr/lib/node_modules/task-master-ai/.cursor/rules/tests.mdc:  process.env.ANTHROPIC_API_KEY = 'test-mock-api-key-for-tests';
/usr/lib/node_modules/task-master-ai/.cursor/rules/taskmaster.mdc:    *   `ANTHROPIC_API_KEY`
/usr/lib/node_modules/task-master-ai/.cursor/rules/ai_providers.mdc:        -   **`anthropic`**: Requires `ANTHROPIC_API_KEY`.
/usr/lib/node_modules/task-master-ai/assets/.windsurfrules:  - **ANTHROPIC_API_KEY** (Required): Your Anthropic API key for Claude (Example: `ANTHROPIC_API_KEY=sk-ant-api03-...`)
/usr/lib/node_modules/task-master-ai/assets/scripts_README.md:    - Used **only** for sensitive **API Keys** (e.g., `ANTHROPIC_API_KEY`, `PERPLEXITY_API_KEY`).
/usr/lib/node_modules/task-master-ai/assets/AGENTS.md:        "ANTHROPIC_API_KEY": "your_key_here",
/usr/lib/node_modules/task-master-ai/assets/AGENTS.md:- `ANTHROPIC_API_KEY` (Claude models) - **Recommended**
/usr/lib/node_modules/task-master-ai/assets/env.example:ANTHROPIC_API_KEY="your_anthropic_api_key_here"       # Required: Format: sk-ant-api03-...
/usr/lib/node_modules/task-master-ai/assets/rules/taskmaster.mdc:    *   `ANTHROPIC_API_KEY`
/usr/lib/node_modules/task-master-ai/README.md:        "ANTHROPIC_API_KEY": "YOUR_ANTHROPIC_API_KEY_HERE",
/usr/lib/node_modules/task-master-ai/README.md:        "ANTHROPIC_API_KEY": "YOUR_ANTHROPIC_API_KEY_HERE",
/usr/lib/node_modules/task-master-ai/README-task-master.md:    - Used **only** for sensitive **API Keys** (e.g., `ANTHROPIC_API_KEY`, `PERPLEXITY_API_KEY`, etc.) and specific endpoints (like `OLLAMA_BASE_URL`).
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`)}catch(Q){v1(Q instanceof Error?Q:new Error(String(Q)))}}import{relative as yN9}from"path";var _N9=[{matches:(A)=>A.path==="apiKeyHelper"&&A.code==="invalid_type",tip:{suggestion:'Provide a shell command that outputs your API key to stdout. The script should output only the API key. Example: "/bin/generate_temp_api_key.sh"'}},{matches:(A)=>A.path==="cleanupPeriodDays"&&A.code==="too_small"&&A.expected==="0",tip:{suggestion:"Must be 0 or greater. Use 0 to disable automatic cleanup and keep chat transcripts forever, or set a positive number for days to retain (default is 30 days)"}},{matches:(A)=>A.path.startsWith("env.")&&A.code==="invalid_type",tip:{suggestion:'Environment variables must be strings. Wrap numbers and booleans in quotes. Example: "DEBUG": "true", "PORT": "3000"',docLink:"https://docs.anthropic.com/en/docs/claude-code/settings#environment-variables"}},{matches:(A)=>(A.path==="permissions.allow"||A.path==="permissions.deny")&&A.code==="invalid_type"&&A.expected==="array",tip:{suggestion:'Permission rules must be in an array. Format: ["Tool(specifier)"]. Examples: ["Bash(npm run build)", "Edit(docs/**)", "Read(~/.zshrc)"]. Use * for wildcards.'}},{matches:(A)=>A.path.includes("hooks")&&A.code==="invalid_type",tip:{suggestion:'Hooks use a new format with matchers. Example: {"PostToolUse": [{"matcher": {"tools": ["BashTool"]}, "hooks": [{"type": "command", "command": "echo Done"}]}]}'}},{matches:(A)=>A.code==="invalid_type"&&A.expected==="boolean",tip:{suggestion:'Use true or false without quotes. Example: "includeCoAuthoredBy": true'}},{matches:(A)=>A.code==="unrecognized_keys",tip:{suggestion:"Check for typos or refer to the documentation for valid fields",docLink:"https://docs.anthropic.com/en/docs/claude-code/settings"}},{matches:(A)=>A.code==="invalid_type"&&A.expected==="object"&&A.received===null&&A.path==="",tip:{suggestion:"Check for missing commas, unmatched brackets, or trailing commas. Use a JSON validator to identify the exact syntax error."}},{matches:(A)=>A.path==="permissions.additionalDirectories"&&A.code==="invalid_type",tip:{suggestion:'Must be an array of directory paths. Example: ["~/projects", "/tmp/workspace"]. You can also use --add-dir flag or /add-dir command',docLink:"https://docs.anthropic.com/en/docs/claude-code/iam#working-directories"}}],jN9={permissions:"https://docs.anthropic.com/en/docs/claude-code/iam#configuring-permissions",env:"https://docs.anthropic.com/en/docs/claude-code/settings#environment-variables",hooks:"https://docs.anthropic.com/en/docs/claude-code/hooks"};function erA(A){let B=_N9.find((I)=>I.matches(A));if(!B)return null;let Q={...B.tip};if(!Q.docLink&&A.path){let I=A.path.split(".")[0];if(I)Q.docLink=jN9[I]}return Q}function AoA(A){return A.code==="invalid_type"}function BoA(A){return A.code==="invalid_literal"}function QoA(A){return A.code==="invalid_enum_value"}function kN9(A){return A.code==="unrecognized_keys"}function IoA(A){return A.code==="too_small"}function DoA(A,B){let Q=B.startsWith(cA())?yN9(cA(),B):B;return A.issues.map((I)=>{let D=I.path.join("."),G=I.message,Z,F,Y,W;if(QoA(I))F=I.options.map((C)=>String(C)),W=I.received;else if(BoA(I))Y=String(I.expected),W=I.received;else if(AoA(I))Y=I.expected,W=I.received;else if(IoA(I))Y=String(I.minimum);let J=erA({path:D,code:I.code,expected:Y,received:W,enumValues:F,message:I.message,value:W});if(BoA(I))Z=`"${I.expected}"`,G=`"${I.received}" is not valid. Expected: ${Z}`;else if(QoA(I))Z=F?.map((C)=>`"${C}"`).join(", "),G=`"${I.received}" is not valid. Expected one of: ${Z}`;else if(AoA(I))if(I.expected==="object"&&I.received==="null"&&D==="")G="Invalid or malformed JSON";else G=`Expected ${I.expected}, but received ${I.received}`;else if(kN9(I)){let C=I.keys.join(", ");G=`Unrecognized field${I.keys.length>1?"s":""}: ${C}`}else if(IoA(I))G=`Number must be greater than or equal to ${I.minimum}`,Z=String(I.minimum);return{file:Q,path:D,message:G,expected:Z,suggestion:J?.suggestion,docLink:J?.docLink}})}var Rr=null;function Yv1(){switch(zQ()){case"macos":return"/Library/Application Support/ClaudeCode";case"windows":return"C:\\ProgramData\\ClaudeCode";default:return"/etc/claude-code"}}function xN9(){return Or(Yv1(),"managed-settings.json")}function GoA(A){if(!b1().existsSync(A))return{settings:null,errors:[]};try{let B=uI(A),Q=S4(B),I=WrA.safeParse(Q);if(!I.success)return v1(new Error(`Invalid settings at ${A}: ${I.error.message}`)),SA(`Settings content: ${JSON.stringify(Q)}`),{settings:null,errors:DoA(I.error,A)};return{settings:I.data,errors:[]}}catch(B){if(typeof B==="object"&&B&&"code"in B&&B.code==="ENOENT")SA(`Broken symlink or missing file encountered for settings.json at path: ${A}`);else v1(B instanceof Error?B:new Error(String(B)));return{settings:null,errors:[]}}}function XD1(A){switch(A){case"userSettings":return Fv1(d9());case"policySettings":case"projectSettings":case"localSettings":return Fv1(z9())}}function zr(A){switch(A){case"userSettings":return Or(XD1(A),"settings.json");case"projectSettings":case"localSettings":return Or(XD1(A),Tr(A));case"policySettings":return xN9()}}function Tr(A){switch(A){case"projectSettings":return Or(".claude","settings.json");case"localSettings":return Or(".claude","settings.local.json")}}function NJ(A){let{settings:B}=GoA(zr(A));return B}function r8(A,B){if(A==="policySettings")return;let Q=zr(A),I=fN9(Q);if(!b1().existsSync(I))b1().mkdirSync(I);let D=NJ(A);if(!D&&b1().existsSync(Q))try{let Z=uI(Q),F=S4(Z);if(F&&typeof F==="object")D=F,SA(`Using raw settings from ${Q} due to validation failure`)}catch(Z){v1(new Error(`Failed to read raw settings from ${Q}: ${Z}`))}let G=f61(D||{},B,(Z,F,Y,W)=>{if(F===void 0&&W&&typeof Y==="string"){delete W[Y];return}if(Array.isArray(F))return F;return});if($q(Q,JSON.stringify(G,null,2)),bN9(),A==="localSettings")wD1(Tr("localSettings"),z9())}function vN9(A,B){let Q=[...A,...B];return Array.from(new Set(Q))}function bN9(){Rr=null}function gN9(){let A={},B=[],Q=new Set,I=new Set;for(let D of _R){let G=zr(D),Z=Fv1(G);if(I.has(Z))continue;I.add(Z);let{settings:F,errors:Y}=GoA(G);for(let W of Y){let J=`${W.file}:${W.path}:${W.message}`;if(!Q.has(J))Q.add(J),B.push(W)}if(F)A=f61(A,F,(W,J)=>{if(Array.isArray(W)&&Array.isArray(J))return vN9(W,J);return})}return{settings:A,errors:B}}function wQ(){let{settings:A}=Lq();return A||{}}function Lq(){if(Rr!==null)return Rr;return Rr=gN9(),Rr}function ND1(A,B=300000){let Q=new Map,I=(...D)=>{let G=JSON.stringify(D),Z=Q.get(G),F=Date.now();if(!Z)Q.set(G,{value:A(...D),timestamp:F,refreshing:!1});if(Z&&F-Z.timestamp>B&&!Z.refreshing)return Z.refreshing=!0,Promise.resolve().then(()=>{let Y=A(...D);Q.set(G,{value:Y,timestamp:Date.now(),refreshing:!1})}).catch((Y)=>{v1(Y instanceof Error?Y:new Error(String(Y)));let W=Q.get(G);if(W)W.refreshing=!1}),Z.value;return Q.get(G).value};return I.cache={clear:()=>Q.clear()},I}function ZoA(A,B=300000){let Q=new Map,I=async(...D)=>{let G=JSON.stringify(D),Z=Q.get(G),F=Date.now();if(!Z){let Y=await A(...D);return Q.set(G,{value:Y,timestamp:F,refreshing:!1}),Y}if(Z&&F-Z.timestamp>B&&!Z.refreshing)return Z.refreshing=!0,A(...D).then((Y)=>{Q.set(G,{value:Y,timestamp:Date.now(),refreshing:!1})}).catch((Y)=>{v1(Y instanceof Error?Y:new Error(String(Y)));let W=Q.get(G);if(W)W.refreshing=!1}),Z.value;return Q.get(G).value};return I.cache={clear:()=>Q.clear()},I}import{createHash as hN9}from"crypto";function Pr(A=""){let B=d9(),I=!process.env.CLAUDE_CONFIG_DIR?"":`-${hN9("sha256").update(B).digest("hex").substring(0,8)}`;return`${I2}${A}${I}`}function FoA(){let A=Pr("-credentials");return{name:"keychain",read(){try{let B=AI(`security find-generic-password -a $USER -w -s "${A}"`);if(B)return JSON.parse(B)}catch(B){return null}return null},update(B){try{let I=JSON.stringify(B).replace(/"/g,"\\\""),D=`security add-generic-password -U -a $USER -s "${A}" -w "${I}"`;return AI(D),{success:!0}}catch(Q){return{success:!1}}},delete(){try{return AI(`security delete-generic-password -a $USER -s "${A}"`),!0}catch(B){return!1}}}}import{join as uN9}from"path";function Wv1(){let A=d9(),B=".credentials.json",Q=uN9(A,".credentials.json");return{name:"plaintext",read(){if(b1().existsSync(Q))try{let I=b1().readFileSync(Q,{encoding:"utf8"});return JSON.parse(I)}catch(I){return null}return null},update(I){try{if(!b1().existsSync(A))b1().mkdirSync(A);return b1().writeFileSync(Q,JSON.stringify(I),{encoding:"utf8",flush:!1}),b1().chmodSync(Q,384),{success:!0,warning:"Warning: Storing credentials in plaintext."}}catch(D){return{success:!1}}},delete(){if(b1().existsSync(Q))try{return b1().unlinkSync(Q),!0}catch(I){return!1}return!0}}}function mN9(A,B){return{name:`${A.name}-with-${B.name}-fallback`,read(){let Q=A.read();if(Q!==null&&Q!==void 0)return Q;return B.read()||{}},update(Q){let I=A.read(),D=A.update(Q);if(D.success){if(I===null)B.delete();return D}let G=B.update(Q);if(G.success)return{success:!0,warning:G.warning};return{success:!1}},delete(){let Q=A.delete(),I=B.delete();return Q||I}}}function $J(){if(process.platform==="darwin"){let A=FoA(),B=Wv1();return mN9(A,B)}return Wv1()}async function YoA(A){let Q=JA().oauthAccount?.accountUuid,I=$G(A);if(!Q||!I)return;let D=`${_8().BASE_API_URL}/api/claude_cli_profile`;try{return(await Z9.get(D,{headers:{"x-api-key":I,"anthropic-beta":yb},params:{account_uuid:Q}})).data}catch(G){v1(G)}}async function qD1(A){let B=`${_8().BASE_API_URL}/api/oauth/profile`;try{return(await Z9.get(B,{headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}})).data}catch(Q){v1(Q)}}function vR(A){return Boolean(A?.includes(b_1))}function $D1(A){return A?.split(" ").filter(Boolean)??[]}function Jv1({codeChallenge:A,state:B,isManual:Q,loginWithClaudeAi:I,inferenceOnly:D}){let G=I?_8().CLAUDE_AI_AUTHORIZE_URL:_8().CONSOLE_AUTHORIZE_URL,Z=new URL(G);Z.searchParams.append("code","true"),Z.searchParams.append("client_id",_8().CLIENT_ID),Z.searchParams.append("response_type","code"),Z.searchParams.append("redirect_uri",Q?_8().MANUAL_REDIRECT_URL:`http://localhost:${_8().REDIRECT_PORT}/callback`);let F=D?[b_1]:_8().SCOPES;return Z.searchParams.append("scope",F.join(" ")),Z.searchParams.append("code_challenge",A),Z.searchParams.append("code_challenge_method","S256"),Z.searchParams.append("state",B),Z.toString()}async function WoA(A,B,Q,I=!1,D){let G={grant_type:"authorization_code",code:A,redirect_uri:I?_8().MANUAL_REDIRECT_URL:`http://localhost:${_8().REDIRECT_PORT}/callback`,client_id:_8().CLIENT_ID,code_verifier:Q,state:B};if(D!==void 0)G.expires_in=D;let Z=await Z9.post(_8().TOKEN_URL,G,{headers:{"Content-Type":"application/json"}});if(Z.status!==200)throw new Error(Z.status===401?"Authentication failed: Invalid authorization code":`Token exchange failed (${Z.status}): ${Z.statusText}`);return Z.data}async function JoA(A){let B={grant_type:"refresh_token",refresh_token:A,client_id:_8().CLIENT_ID};try{let Q=await Z9.post(_8().TOKEN_URL,B,{headers:{"Content-Type":"application/json"}});if(Q.status!==200)throw new Error(`Token refresh failed: ${Q.statusText}`);let I=Q.data,{access_token:D,refresh_token:G=A,expires_in:Z}=I,F=Date.now()+Z*1000,Y=$D1(I.scope);E1("tengu_oauth_token_refresh_success",{});let W=await Cv1(D);return{accessToken:D,refreshToken:G,expiresAt:F,scopes:Y,subscriptionType:W}}catch(Q){throw E1("tengu_oauth_token_refresh_failure",{}),Q}}async function CoA(A){let B=await Z9.get(_8().ROLES_URL,{headers:{Authorization:`Bearer ${A}`}});if(B.status!==200)throw new Error(`Failed to fetch user roles: ${B.statusText}`);let Q=B.data,I=JA();if(!I.oauthAccount)throw new Error("OAuth account information not found in config");I.oauthAccount.organizationRole=Q.organization_role,I.oauthAccount.workspaceRole=Q.workspace_role,I.oauthAccount.organizationName=Q.organization_name,b0(I),E1("tengu_oauth_roles_stored",{org_role:Q.organization_role})}async function XoA(A){try{let B=await Z9.post(_8().API_KEY_URL,null,{headers:{Authorization:`Bearer ${A}`}}),Q=B.data?.raw_key;if(Q)return VoA(Q),E1("tengu_oauth_api_key",{status:"success",statusCode:B.status}),Q;return null}catch(B){throw E1("tengu_oauth_api_key",{status:"failure",error:B instanceof Error?B.message:String(B)}),B}}function LD1(A){if(A===null)return!1;let B=300000;return Date.now()+B>=A}async function Cv1(A){switch((await qD1(A))?.organization?.organization_type){case"claude_max":return"max";case"claude_pro":return"pro";case"claude_enterprise":return"enterprise";case"claude_team":return"team";default:return null}}var JF0=Y1(fr(),1);var oZ1=Y1(FF0(),1);function YF0(A){return A?.name==="CredentialsProviderError"}function WF0(A){if(!A||typeof A!=="object")return!1;let B=A;if(!B.Credentials||typeof B.Credentials!=="object")return!1;let Q=B.Credentials;return typeof Q.AccessKeyId==="string"&&typeof Q.SecretAccessKey==="string"&&typeof Q.SessionToken==="string"&&Q.AccessKeyId.length>0&&Q.SecretAccessKey.length>0&&Q.SessionToken.length>0}var Uu1=async()=>{await new oZ1.STSClient().send(new oZ1.GetCallerIdentityCommand({}))};import{exec as np9}from"child_process";var ap9=300000;function zX(){let A=process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX,Q=(wQ()||{}).apiKeyHelper,I=process.env.ANTHROPIC_AUTH_TOKEN||Q,{source:D}=MF(a61());return!(A||I||(D==="ANTHROPIC_API_KEY"||D==="apiKeyHelper"))}function tj(){if(process.env.ANTHROPIC_AUTH_TOKEN)return{source:"ANTHROPIC_AUTH_TOKEN",hasToken:!0};if(process.env.CLAUDE_CODE_OAUTH_TOKEN)return{source:"CLAUDE_CODE_OAUTH_TOKEN",hasToken:!0};if(ej())return{source:"apiKeyHelper",hasToken:!0};let B=BI();if(vR(B?.scopes)&&B?.accessToken)return{source:"claude.ai",hasToken:!0};return{source:"none",hasToken:!1}}function $G(A){let{key:B}=MF(A);return B}function MF(A){if(A&&process.env.ANTHROPIC_API_KEY)return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};if(E6(!1)){if(!process.env.ANTHROPIC_API_KEY&&!process.env.CLAUDE_CODE_OAUTH_TOKEN)throw new Error("ANTHROPIC_API_KEY or CLAUDE_CODE_OAUTH_TOKEN env var is required");if(process.env.ANTHROPIC_API_KEY)return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};return{key:null,source:"none"}}if(process.env.ANTHROPIC_API_KEY&&JA().customApiKeyResponses?.approved?.includes(RJ(process.env.ANTHROPIC_API_KEY)))return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};let B=ej();if(B)return{key:B,source:"apiKeyHelper"};let Q=Ro();if(Q)return Q;return{key:null,source:"none"}}function sp9(){let A=process.env.CLAUDE_CODE_API_KEY_HELPER_TTL_MS;if(A){let B=parseInt(A,10);if(!Number.isNaN(B)&&B>=0)return B;I9(`Found CLAUDE_CODE_API_KEY_HELPER_TTL_MS env var, but it was not a valid number. Got ${A}`)}return ap9}var ej=ND1(()=>{let B=(wQ()||{}).apiKeyHelper;if(!B)return null;try{let Q=AI(B)?.toString().trim();if(!Q)throw new Error("apiKeyHelper did not return a valid value");return Q}catch(Q){let I=YA.red("Error getting API key from apiKeyHelper (in settings or ~/.claude.json):");if(Q instanceof Error&&"stderr"in Q)console.error(I,String(Q.stderr));else if(Q instanceof Error)console.error(I,Q.message);else console.error(I,Q);return" "}},sp9());function wu1(){ej.cache.clear()}var CF0=3600000,tZ1=ND1(async()=>{let A=wQ()?.awsAuthRefresh;if(!A)return null;try{return await Uu1(),null}catch{return SA("Running AWS auth refresh command"),new Promise((B)=>{let Q=np9(A);Q.stdout.on("data",(I)=>{console.log(I)}),Q.stderr.on("data",(I)=>{console.error(I)}),Q.on("close",(I)=>{if(I===0)SA("AWS auth refresh completed successfully"),B(null);else{let D=YA.red("Error running awsAuthRefresh (in settings or ~/.claude.json):");console.error(D),B(null)}})})}},CF0);var Mo=ND1(async()=>{let A=wQ()?.awsCredentialExport;if(!A)return null;try{return await Uu1(),null}catch{try{SA("Running AWS credential export command");let B=AI(A)?.toString().trim();if(!B)throw new Error("awsCredentialExport did not return a valid value");let Q=JSON.parse(B);if(!WF0(Q))throw new Error("awsCredentialExport did not return valid AWS STS output structure");return SA("AWS credentials retrieved from awsCredentialExport"),{accessKeyId:Q.Credentials.AccessKeyId,secretAccessKey:Q.Credentials.SecretAccessKey,sessionToken:Q.Credentials.SessionToken}}catch(B){let Q=YA.red("Error getting AWS credentials from awsCredentialExport (in settings or ~/.claude.json):");if(B instanceof Error&&"stderr"in B)console.error(Q,String(B.stderr));else if(B instanceof Error)console.error(Q,B.message);else console.error(Q,B);return null}}},CF0);function XF0(){Mo.cache.clear()}function RJ(A){return A.slice(-20)}var Ro=L0(()=>{if(process.platform==="darwin"){let B=Pr();try{let Q=AI(`security find-generic-password -a $USER -w -s "${B}"`);if(Q)return{key:Q,source:"/login managed key"}}catch(Q){v1(Q)}}let A=JA();if(!A.primaryApiKey)return null;return{key:A.primaryApiKey,source:"/login managed key"}});function rp9(A){return/^[a-zA-Z0-9-_]+$/.test(A)}function VoA(A){if(!rp9(A))throw new Error("Invalid API key format. API key must contain only alphanumeric characters, dashes, and underscores.");let B=JA();if(EF0(),process.platform==="darwin")try{let I=Pr();AI(`security add-generic-password -a $USER -s "${I}" -w ${A}`)}catch(I){v1(I),B.primaryApiKey=A}else B.primaryApiKey=A;if(!B.customApiKeyResponses)B.customApiKeyResponses={approved:[],rejected:[]};if(!B.customApiKeyResponses.approved)B.customApiKeyResponses.approved=[];let Q=RJ(A);if(!B.customApiKeyResponses.approved.includes(Q))B.customApiKeyResponses.approved.push(Q);b0(B),Ro.cache.clear?.()}function VF0(A){let B=JA(),Q=RJ(A);return B.customApiKeyResponses?.approved?.includes(Q)??!1}function KF0(){EF0();let A=JA();A.primaryApiKey=void 0,b0(A),Ro.cache.clear?.()}function EF0(){if(process.platform==="darwin")try{let A=Pr();AI(`security delete-generic-password -a $USER -s "${A}"`)}catch(A){v1(A)}}function Oo(A){if(!vR(A.scopes))return{success:!0};if(!A.refreshToken||!A.expiresAt)return{success:!0};try{let B=$J(),Q=B.read()||{};Q.claudeAiOauth={accessToken:A.accessToken,refreshToken:A.refreshToken,expiresAt:A.expiresAt,scopes:A.scopes,subscriptionType:A.subscriptionType};let I=B.update(Q);return BI.cache?.clear?.(),mY.cache?.clear?.(),I}catch(B){return v1(B),{success:!1,warning:"Failed to save OAuth tokens"}}}var BI=L0(()=>{if(process.env.CLAUDE_CODE_OAUTH_TOKEN)return{accessToken:process.env.CLAUDE_CODE_OAUTH_TOKEN,refreshToken:null,expiresAt:null,scopes:["user:inference"],subscriptionType:null};try{let Q=$J().read()?.claudeAiOauth;if(!Q?.accessToken)return null;if(!Q.subscriptionType){let I=Q.isMax===!1?"pro":"max";return{...Q,subscriptionType:I}}return Q}catch(A){return v1(A),null}});async function eZ1(A=0){let Q=BI();if(!Q?.refreshToken||!LD1(Q.expiresAt))return!1;if(BI.cache?.clear?.(),Q=BI(),!Q?.refreshToken||!LD1(Q.expiresAt))return!1;let I=d9();b1().mkdirSync(I);let G;try{G=await JF0.lock(I)}catch(Z){if(Z.code==="ELOCKED"){if(A<5)return await new Promise((F)=>setTimeout(F,1000+Math.random()*1000)),eZ1(A+1);return!1}return v1(Z),!1}try{if(BI.cache?.clear?.(),Q=BI(),!Q?.refreshToken||!LD1(Q.expiresAt))return!1;let Z=await JoA(Q.refreshToken);return Oo({...Z,scopes:Q.scopes}),BI.cache?.clear?.(),!0}catch(Z){return v1(Z instanceof Error?Z:new Error(String(Z))),!1}finally{await G()}}function MB(){if(!zX())return!1;return vR(BI()?.scopes)}function HF0(){if(process.env.CLAUDE_CODE_USE_BEDROCK==="true"||process.env.CLAUDE_CODE_USE_VERTEX==="true")return!1;if(MB())return!1;return!0}function LZ(){let A=UF0();return A==="max"||A==="enterprise"||A==="team"}function zF0(){return LZ()}function UF0(){if(!zX())return null;let A=BI();if(!A)return null;return A.subscriptionType??null}function AF1(){switch(UF0()){case"enterprise":return"Claude Enterprise";case"team":return"Claude Team";case"max":return"Claude Max";case"pro":return"Claude Pro";default:return"Claude API"}}function ih(){return!!(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX)}function wF0(){let B=wQ()?.otelHeadersHelper;if(!B)return{};try{let Q=AI(B)?.toString().trim();if(!Q)throw new Error("otelHeadersHelper did not return a valid value");let I=JSON.parse(Q);if(typeof I!=="object"||I===null||Array.isArray(I))throw new Error("otelHeadersHelper must return a JSON object with string key-value pairs");for(let[D,G]of Object.entries(I))if(typeof G!=="string")throw new Error(`otelHeadersHelper returned non-string value for key "${D}": ${typeof G}`);return I}catch(Q){throw v1(new Error(`Error getting OpenTelemetry headers from otelHeadersHelper (in settings): ${Q instanceof Error?Q.message:String(Q)}`)),Q}}function op9(A){let B=H7();if(B==="bedrock")return!1;else if(B==="firstParty")return A.includes("claude-3-7")||A.includes("claude-opus-4")||A.includes("claude-sonnet-4");else return A.includes("claude-opus-4")||A.includes("claude-sonnet-4")}var mY=L0((A)=>{let B=[],Q=A.includes("haiku");if(!Q)B.push(POA);if(MB())B.push(yb);if(!E6(process.env.DISABLE_INTERLEAVED_THINKING)&&op9(A))B.push(D51);if(H7()==="firstParty"&&!E6(process.env.CLAUDE_CODE_DISABLE_FINE_GRAINED_TOOL_STREAMING))B.push(SOA);if(process.env.ANTHROPIC_BETAS&&!Q)B.push(...process.env.ANTHROPIC_BETAS.split(",").map((D)=>D.trim()).filter(Boolean));return B});var Ay={firstParty:"claude-3-7-sonnet-20250219",bedrock:"us.anthropic.claude-3-7-sonnet-20250219-v1:0",vertex:"claude-3-7-sonnet@20250219"},By={firstParty:"claude-3-5-sonnet-20241022",bedrock:"anthropic.claude-3-5-sonnet-20241022-v2:0",vertex:"claude-3-5-sonnet-v2@20241022"},To={firstParty:"claude-3-5-haiku-20241022",bedrock:"us.anthropic.claude-3-5-haiku-20241022-v1:0",vertex:"claude-3-5-haiku@20241022"},mK={firstParty:"claude-sonnet-4-20250514",bedrock:"us.anthropic.claude-sonnet-4-20250514-v1:0",vertex:"claude-sonnet-4@20250514"},jq={firstParty:"claude-opus-4-20250514",bedrock:"us.anthropic.claude-opus-4-20250514-v1:0",vertex:"claude-opus-4@20250514"};function NF0(A){let B=A.toLowerCase();if(B.includes("claude-sonnet-4"))return"Sonnet 4";if(B.includes("claude-opus-4"))return"Opus 4";if(B.includes("claude-3-7-sonnet"))return"Claude 3.7 Sonnet";if(B.includes("claude-3-5-sonnet"))return"Claude 3.5 Sonnet";if(B.includes("claude-3-5-haiku"))return"Claude 3.5 Haiku";return}var JX1=Y1(Zk0(),1);var xd0=Y1(cu(),1),vd0=Y1(ez(),1);var YX1=Y1(fp1(),1);var WX1=Y1(Ia1(),1);import{Agent as FvQ}from"https";var jd0=Y1(Ia1(),1);var Q$=L0(()=>{let A={};if(process.env.CLAUDE_CODE_CLIENT_CERT)try{A.cert=b1().readFileSync(process.env.CLAUDE_CODE_CLIENT_CERT,{encoding:"utf8"}),SA("mTLS: Loaded client certificate from CLAUDE_CODE_CLIENT_CERT")}catch(B){I9(`mTLS: Failed to load client certificate: ${B}`)}if(process.env.CLAUDE_CODE_CLIENT_KEY)try{A.key=b1().readFileSync(process.env.CLAUDE_CODE_CLIENT_KEY,{encoding:"utf8"}),SA("mTLS: Loaded client key from CLAUDE_CODE_CLIENT_KEY")}catch(B){I9(`mTLS: Failed to load client key: ${B}`)}if(process.env.CLAUDE_CODE_CLIENT_KEY_PASSPHRASE)A.passphrase=process.env.CLAUDE_CODE_CLIENT_KEY_PASSPHRASE,SA("mTLS: Using client key passphrase");if(Object.keys(A).length===0)return;return A}),yd0=L0(()=>{let A=Q$();if(!A)return;let B={...A,keepAlive:!0};return SA("mTLS: Creating HTTPS agent with custom certificates"),new FvQ(B)});function kd0(){let A=Q$();if(!A)return;return{cert:A.cert,key:A.key,passphrase:A.passphrase}}function iy(){let A=Q$();if(!A)return{};let B={cert:A.cert,key:A.key,passphrase:A.passphrase},Q=new jd0.Agent({connect:B,pipelining:1});return SA("mTLS: Created undici agent with custom certificates"),{dispatcher:Q}}function fd0(){if(!Q$())return;if(process.env.NODE_EXTRA_CA_CERTS)SA("NODE_EXTRA_CA_CERTS detected - Node.js will automatically append to built-in CAs")}function ny(){return process.env.https_proxy||process.env.HTTPS_PROXY||process.env.http_proxy||process.env.HTTP_PROXY}var bd0=L0((A)=>{let B=Q$(),Q={uri:A,pipelining:1};if(B)Q.requestTls={cert:B.cert,key:B.key,passphrase:B.passphrase};return new WX1.default.ProxyAgent(Q)});function gd0(){let A=ny(),B=iy();if(A)return{dispatcher:bd0(A)};return B}function hd0(){let A=ny(),B=yd0(),Q=Q$();if(A){if(Z9.defaults.proxy=!1,Q)Z9.defaults.httpsAgent=new YX1.default.HttpsProxyAgent(A,{cert:Q.cert,key:Q.key,passphrase:Q.passphrase});else Z9.defaults.httpsAgent=new YX1.default.HttpsProxyAgent(A);WX1.default.setGlobalDispatcher(bd0(A))}else if(B){Z9.defaults.httpsAgent=B;let I=iy();if(I.dispatcher)WX1.default.setGlobalDispatcher(I.dispatcher)}}function ud0(){let A=ny();if(!A)return{};let B=new YX1.default.HttpsProxyAgent(A),Q=new vd0.NodeHttpHandler({httpAgent:B,httpsAgent:B});return{requestHandler:Q,credentials:xd0.defaultProvider({clientConfig:{requestHandler:Q}})}}var md0=L0(async function(){let A=pm();if(process.env.AWS_BEARER_TOKEN_BEDROCK)try{let G=`https://bedrock.${A}.amazonaws.com/inference-profiles`;return((await Z9.get(G,{headers:{Authorization:`Bearer ${process.env.AWS_BEARER_TOKEN_BEDROCK}`}})).data.inferenceProfileSummaries||[]).filter((J)=>J.inferenceProfileId?.includes("anthropic")).map((J)=>J.inferenceProfileId).filter(Boolean)}catch(G){throw v1(G),G}await tZ1();let B=await Mo(),Q={region:A,...ud0()};if(B)Q.credentials={accessKeyId:B.accessKeyId,secretAccessKey:B.secretAccessKey,sessionToken:B.sessionToken};let I=new JX1.BedrockClient(Q),D=new JX1.ListInferenceProfilesCommand;try{return((await I.send(D)).inferenceProfileSummaries||[]).filter((W)=>W.inferenceProfileId?.includes("anthropic")).map((W)=>W.inferenceProfileId).filter(Boolean)}catch(G){throw v1(G),G}});function lm(A,B){return A.find((Q)=>Q.includes(B))??null}function CX1(A){let B=[],Q=!1;async function I(){if(Q)return;if(B.length===0)return;Q=!0;while(B.length>0){let{args:D,resolve:G,reject:Z,context:F}=B.shift();try{let Y=await A.apply(F,D);G(Y)}catch(Y){Z(Y)}}if(Q=!1,B.length>0)I()}return function(...D){return new Promise((G,Z)=>{B.push({args:D,resolve:G,reject:Z,context:this}),I()})}}function XX1(A){return{haiku35:To[A],sonnet35:By[A],sonnet37:Ay[A],sonnet40:mK[A],opus40:jq[A]}}async function YvQ(){let A;try{A=await md0()}catch(Z){return v1(Z),XX1("bedrock")}if(!A?.length)return XX1("bedrock");let B=lm(A,"claude-3-5-haiku-20241022"),Q=lm(A,"claude-3-5-sonnet-20241022"),I=lm(A,"claude-3-7-sonnet-20250219"),D=lm(A,"claude-sonnet-4-20250514"),G=lm(A,"claude-opus-4-20250514");return{haiku35:B||To.bedrock,sonnet35:Q||By.bedrock,sonnet37:I||Ay.bedrock,sonnet40:D||mK.bedrock,opus40:G||jq.bedrock}}var WvQ=CX1(async()=>{if(n61()!==null)return;try{let A=await YvQ();dR1(A)}catch(A){v1(A)}});function JvQ(){if(n61()!==null)return;if(H7()!=="bedrock"){dR1(XX1(H7()));return}WvQ()}function _F(){let A=n61();if(A===null)return JvQ(),XX1(H7());return A}var CvQ=mK,dd0=CvQ.firstParty;function sy(){return process.env.ANTHROPIC_SMALL_FAST_MODEL||_F().haiku35}function im(A){return A===_F().opus40}function nm(){let A,B=UFA();if(B!==void 0)A=B;else{let Q=wQ()||{};A=process.env.ANTHROPIC_MODEL||Q.model||void 0}if(MB()&&!LZ()&&A?.includes("opus"))return;return A}function M7(){let A=nm();if(A!==void 0&&A!==null)return am(A);if(A===null&&H_())return gX();return je()}function cd0(){if(H7()==="bedrock")return _F().sonnet37;return _F().sonnet40}var f38=L0(()=>{return null});function je(A={}){let{forDisplay:B=!1}=A;if(LZ())return _F().opus40;return cd0()}function gX(){return cd0()}function FE(A){let B=A.match(/(claude-(\d+-\d+-)?\w+)/);if(B&&B[1])return B[1];return A}function VX1(){if(MB()&&!LZ())return KX1.description;let A=JA().fallbackAvailableWarningThreshold;if(A===void 0)return"Use Opus 4 or Sonnet 4 based on Max usage limits";return`Opus 4 for up to ${(A*100).toFixed(0)}% of usage limits, then use Sonnet 4`}function ry(A){if(A===_F().opus40)return"Opus 4";if(A===_F().sonnet40)return"Sonnet 4";if(A===_F().sonnet37)return"Sonnet 3.7";if(A===_F().sonnet35)return"Sonnet 3.5";if(A===_F().haiku35)return"Haiku 3.5";return A}function ay(){if(MB()&&!LZ())return{value:null,label:"Sonnet",description:KX1.description};if(LZ())return{value:null,label:"Default (recommended)",description:VX1()};return{value:null,label:"Default (recommended)",description:`Use the default model (currently ${ry(je({forDisplay:!0}))})  $3/$15 per Mtok`}}var ld0={value:"sonnet",label:"Sonnet",description:"Sonnet 4 for daily use  $3/$15 per Mtok"},Da1={value:"opus",label:"Opus",description:"Opus 4 for complex tasks  $15/$75 per Mtok"},XvQ={value:"opus",label:"Opus",description:"Opus 4 for complex tasks  Reaches usage limits faster"},KX1={value:"sonnet",label:"Sonnet",description:"Sonnet 4 for daily use"};function VvQ(){if(MB()&&!LZ())return[ay()];if(LZ())return[ay(),XvQ,KX1];if(H7()==="bedrock")return[ay(),ld0,Da1];return[ay(),Da1]}function pd0(){let A=VvQ(),B=null,Q=nm(),I=i61();if(Q!==void 0&&Q!==null)B=Q;else if(I!==null)B=I;if(B===null||A.some((D)=>D.value===B))return A;if(id0(B))A.push(B==="sonnet"?ld0:Da1);else A.push({value:B,label:B,description:"Custom model"});return A}function id0(A){return["sonnet","opus"].includes(A)}function am(A){let B=A.toLowerCase().trim();if(id0(B))return B==="sonnet"?_F().sonnet40:_F().opus40;return B}function oy(A){if(A===null){if(MB()&&!LZ())return`Sonnet (${KX1.description})`;else if(MB())return`Default (${VX1()})`;return`Default (${je({forDisplay:!0})})`}let B=am(A);return A===B?B:`${A} (${B})`}function nd0(A){return A}var ad0={},ty=null,sd0=L0(()=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return null;let A=tv(),B={networkConfig:{api:"https://statsig.anthropic.com/v1/"},environment:{tier:["test","dev"].includes("production")?"development":"production"},includeCurrentPageUrlWithEvents:!1,logLevel:EX1.LogLevel.None,storageProvider:new v_1,customUserCacheKeyFunc:(I,D)=>{return KvQ("sha1").update(I).update(D.userID||"").digest("hex").slice(0,10)}};ty=new EX1.StatsigClient(FNA,A,B),ty.on("error",()=>{Z9.head("https://api.anthropic.com/api/hello").catch(()=>{})});let Q=ty.initializeAsync().then(()=>{});return process.on("beforeExit",async()=>{await ty?.flush()}),process.on("exit",()=>{ty?.flush()}),{client:ty,initialized:Q}}),ey=L0(async()=>{let A=sd0();if(!A)return null;return await A.initialized,A.client});function rd0(){ty=null,sd0.cache?.clear?.(),ey.cache?.clear?.(),HvQ.cache?.clear?.(),gJ.cache?.clear?.()}async function EvQ(A,B){if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return;try{let Q=B.model?String(B.model):M7(),I=mY(Q),[D,G,Z]=await Promise.all([ey(),iA.getPackageManagers(),iA.getRuntimes()]);if(!D)return;let F={...B,model:Q,sessionId:qB(),userType:"external",...I.length>0?{betas:I.join(",")}:{},env:JSON.stringify({platform:iA.platform,nodeVersion:iA.nodeVersion,terminal:iA.terminal,packageManagers:G.join(","),runtimes:Z.join(","),isRunningWithBun:iA.isRunningWithBun(),isCi:E6(!1),isClaubbit:process.env.CLAUBBIT==="true",isGithubAction:process.env.GITHUB_ACTIONS==="true",isClaudeCodeAction:process.env.CLAUDE_CODE_ACTION==="1"||process.env.CLAUDE_CODE_ACTION==="true",isClaudeAiAuth:MB(),version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION,...process.env.GITHUB_ACTIONS==="true"&&{githubEventName:process.env.GITHUB_EVENT_NAME,githubActionsRunnerEnvironment:process.env.RUNNER_ENVIRONMENT,githubActionsRunnerOs:process.env.RUNNER_OS}}),entrypoint:process.env.CLAUDE_CODE_ENTRYPOINT,isInteractive:String(jFA()),clientType:kFA(),...void 0,...!1},Y={eventName:A,metadata:F};D.logEvent(Y),await D.flush()}catch(Q){}}function E1(A,B){EvQ(A,B)}var gJ=L0(async(A)=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return!1;let B=await ey();if(!B)return!1;let Q=B.checkGate(A);return ad0[A]=Q,Q});var od0=(A,B)=>{let[Q,I]=Ga1.default.useState(B);return Ga1.default.useEffect(()=>{hX(A,B).then(I)},[A,B]),Q};function td0(){return{...ad0}}var HvQ=L0(async(A,B)=>{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return B;let Q=await ey();if(!Q)return B;let I=Q.getExperiment(A);if(Object.keys(I.value).length===0)return B;return I.value});async function hX(A,B){if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX||process.env.DISABLE_TELEMETRY||process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return B;let Q=await ey();if(!Q)return B;let I=Q.getDynamicConfig(A);if(Object.keys(I.value).length===0)return B;return I.value}var ed0=L0(hX);function Ac0(){GT.init({dsn:ZNA,environment:"external",release:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION,defaultIntegrations:!1,tracesSampleRate:1,tracePropagationTargets:["localhost"]})}function HX1(A){try{let B=tv();GT.setExtras({nodeVersion:iA.nodeVersion,platform:iA.platform,isCI:iA.isCI,isTest:!1,packageVersion:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION,sessionId:qB(),statsigGates:td0(),terminal:iA.terminal,userType:"external"}),GT.setUser({id:B.userID,email:B.email}),GT.captureException(A)}catch{}}import{join as sm}from"path";import{basename as UvQ}from"path";var zvQ=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function hJ(A){if(typeof A!=="string")return null;return zvQ.test(A)?A:null}var zX1=cA();function ke(){return sm(d9(),"projects")}function UX1(){let A=ye(zX1);return sm(A,`${qB()}.jsonl`)}function Bc0(A){let B=ye(zX1),Q=sm(B,`${A}.jsonl`),I=b1();try{return I.statSync(Q),!0}catch{return!1}}function wvQ(){return"production"}function Qc0(){return"external"}function ye(A){return sm(ke(),A.replace(/[^a-zA-Z0-9]/g,"-"))}var Za1=null;function I$(){if(!Za1)Za1=new Ic0;return Za1}class Ic0{summaries;messages;checkpoints;didLoad=!1;sessionFile=null;constructor(){this.summaries=new Map,this.messages=new Map,this.checkpoints=new Map}async insertMessageChain(A,B=!1){let Q=null;for(let I of A){let D={parentUuid:Q,isSidechain:B,userType:Qc0(),cwd:cA(),sessionId:qB(),version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION,...I};this.messages.set(I.uuid,D),await this.appendEntry(D),Q=I.uuid}}async insertCheckpoint(A){let B=qB(),Q={type:"checkpoint",sessionId:B,commit:A.commit,timestamp:A.timestamp.toISOString(),label:A.label};if(!this.checkpoints.has(B))this.checkpoints.set(B,[]);this.checkpoints.get(B)?.push(Q),await this.appendEntry(Q)}async appendEntry(A){if(wvQ()==="test"||wQ()?.cleanupPeriodDays===0)return;let B=b1();if(this.sessionFile===null){let I=ye(zX1);try{B.statSync(I)}catch{B.mkdirSync(I)}this.sessionFile=UX1();try{B.statSync(this.sessionFile)}catch{B.writeFileSync(this.sessionFile,"",{encoding:"utf8",flush:!0})}}let Q=qB();if(A.type==="summary")B.appendFileSync(this.sessionFile,JSON.stringify(A)+`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let Q=this._client._options.timeout;if(!A.stream&&Q==null){let I=$H1[A.model]??void 0;Q=this._client.calculateNonstreamingTimeout(A.max_tokens,I)}return this._client.post("/v1/messages",{body:A,timeout:Q??600000,...B,stream:A.stream??!1})}stream(A,B){return F01.createMessage(this,A,B)}countTokens(A,B){return this._client.post("/v1/messages/count_tokens",{body:A,...B})}}var iH2={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};RE.Batches=Y01;class Sc extends aI{retrieve(A,B={},Q){let{betas:I}=B??{};return this._client.get(gZ`/v1/models/${A}`,{...Q,headers:I4([{...I?.toString()!=null?{"anthropic-beta":I?.toString()}:void 0},Q?.headers])})}list(A={},B){let{betas:Q,...I}=A??{};return this._client.getAPIList("/v1/models",ME,{query:I,...B,headers:I4([{...Q?.toString()!=null?{"anthropic-beta":Q?.toString()}:void 0},B?.headers])})}}var W01=(A)=>{if(typeof globalThis.process!=="undefined")return globalThis.process.env?.[A]?.trim()??void 0;if(typeof globalThis.Deno!=="undefined")return globalThis.Deno.env?.get?.(A)?.trim();return};var tAA,eAA,SH1,nH2;class W8{constructor({baseURL:A=W01("ANTHROPIC_BASE_URL"),apiKey:B=W01("ANTHROPIC_API_KEY")??null,authToken:Q=W01("ANTHROPIC_AUTH_TOKEN")??null,...I}={}){tAA.add(this),SH1.set(this,void 0);let D={apiKey:B,authToken:Q,...I,baseURL:A||"https://api.anthropic.com"};if(!D.dangerouslyAllowBrowser&&zH2())throw new dB(`It looks like you're running in a browser-like environment.
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:2. When you're done researching, present your plan by calling the ${kw.name} tool, which will prompt the user to confirm the plan. Do NOT make any file changes or run any tools that modify the system state in any way until the user has confirmed the plan.</system-reminder>`,isMeta:!0})];case"learn_mode":return[];case"mcp_resource":{let B=A.content;if(!B||!B.contents||B.contents.length===0)return[i0({content:`<mcp-resource server="${A.server}" uri="${A.uri}">(No content)</mcp-resource>`,isMeta:!0})];let Q=[];for(let I of B.contents)if(I&&typeof I==="object"){if("text"in I&&typeof I.text==="string")Q.push({type:"text",text:"Full contents of resource:"},{type:"text",text:I.text},{type:"text",text:"Do NOT read this resource again unless you think it may have changed, since you already have the full contents."});else if("blob"in I){let D="mimeType"in I?String(I.mimeType):"application/octet-stream";Q.push({type:"text",text:`[Binary content: ${D}]`})}}if(Q.length>0)return[i0({content:Q,isMeta:!0})];else _2(A.server,`No displayable content found in MCP resource ${A.uri}.`);return[i0({content:`<mcp-resource server="${A.server}" uri="${A.uri}">(No displayable content)</mcp-resource>`,isMeta:!0})]}case"autocheckpointing":return[]}}function Kq1(A,B){try{let Q=A.mapToolResultToToolResultBlockParam(B,"1");if(Array.isArray(Q.content)&&Q.content.some((I)=>I.type==="image"))return i0({content:Q.content,isMeta:!0});return i0({content:`Result of calling the ${A.name} tool: ${JSON.stringify(Q.content)}`,isMeta:!0})}catch{return i0({content:`Result of calling the ${A.name} tool: Error`,isMeta:!0})}}function Eq1(A,B){return i0({content:`Called the ${A} tool with the following input: ${JSON.stringify(B)}`,isMeta:!0})}function R5(A,B,Q,I){return{type:"system",content:A,isMeta:!1,timestamp:new Date().toISOString(),uuid:uP(),toolUseID:Q,level:B,...I&&{preventContinuation:I}}}function I8A(A,B){if(A.type!=="user")return!0;if(A.isMeta)return!1;if(A.isVisibleInTranscriptOnly&&!B)return!1;return!0}var pZ="API Error",IB1="Prompt is too long",D8A="Credit balance is too low",qq1="Invalid API key  Please run /login",$q1="Invalid API key  Fix external API key",G8A="Claude AI usage limit reached",Z8A="Repeated server overload with Opus model",MW="(no content)",Lq1="OAuth token revoked  Please run /login",F8A="Repeated 529 Overloaded errors",el="Opus is experiencing high load, please use /model to switch to Sonnet";function Mq1(A,B,Q){if(A instanceof Error&&A.message.includes(F8A))return tF({content:Z8A});if(A instanceof Error&&A.message.includes(el))return tF({content:el});if(A instanceof eQ&&A.status===429&&MB()){let I=A.headers?.get?.("anthropic-ratelimit-unified-reset"),D=Number(I)||0,G=`${G8A}|${D}`;return tF({content:G})}if(A instanceof Error&&A.message.includes("prompt is too long"))return tF({content:IB1});if(MB()&&A instanceof eQ&&A.status===400&&A.message.toLowerCase().includes("invalid model name")&&(im(B)||B==="opus"))return tF({content:"Claude Opus 4 is not available with the Claude Pro plan. If you have updated your subscription plan recently, run /logout and /login for the plan to take effect."});if(A instanceof Error&&A.message.includes("Your credit balance is too low"))return tF({content:D8A});if(A instanceof Error&&A.message.toLowerCase().includes("x-api-key")){let{source:I}=MF(Q);return tF({content:I==="ANTHROPIC_API_KEY"||I==="apiKeyHelper"?$q1:qq1})}if(A instanceof eQ&&A.status===403&&A.message.includes("OAuth token has been revoked"))return tF({content:Lq1});if(process.env.CLAUDE_CODE_USE_BEDROCK&&A instanceof Error&&A.message.toLowerCase().includes("model id"))return tF({content:`${pZ} (${B}): ${A.message}`});if(A instanceof Error)return tF({content:`${pZ}: ${A.message}`});return tF({content:pZ})}function Y8A(A){if(A!=="refusal")return;return E1("tengu_refusal_api_response",{}),tF({content:`${pZ}: Claude Code is unable to respond to this request, which appears to violate our Usage Policy (https://www.anthropic.com/legal/aup). Please double press esc to edit your last message or start a new session for Claude Code to assist with a different task.`})}async function Ap(A){let B=process.env.BROWSER,Q=process.platform,I=B?B:Q==="win32"?"start":Q==="darwin"?"open":"xdg-open";try{let{code:D}=await G2(I,[A]);return D===0}catch(D){return!1}}var V04=7250;function Bp(A){let B=A;return B=B.replace(/"(sk-ant[^\s"']{24,})"/g,'"[REDACTED_API_KEY]"'),B=B.replace(/(?<![A-Za-z0-9"'])(sk-ant-?[A-Za-z0-9_-]{10,})(?![A-Za-z0-9"'])/g,"[REDACTED_API_KEY]"),B=B.replace(/AWS key: "(AWS[A-Z0-9]{20,})"/g,'AWS key: "[REDACTED_AWS_KEY]"'),B=B.replace(/(AKIA[A-Z0-9]{16})/g,"[REDACTED_AWS_KEY]"),B=B.replace(/(?<![A-Za-z0-9])(AIza[A-Za-z0-9_-]{35})(?![A-Za-z0-9])/g,"[REDACTED_GCP_KEY]"),B=B.replace(/(?<![A-Za-z0-9])([a-z0-9-]+@[a-z0-9-]+\.iam\.gserviceaccount\.com)(?![A-Za-z0-9])/g,"[REDACTED_GCP_SERVICE_ACCOUNT]"),B=B.replace(/(["']?x-api-key["']?\s*[:=]\s*["']?)[^"',\s)}\]]+/gi,"$1[REDACTED_API_KEY]"),B=B.replace(/(["']?authorization["']?\s*[:=]\s*["']?(bearer\s+)?)[^"',\s)}\]]+/gi,"$1[REDACTED_TOKEN]"),B=B.replace(/(AWS[_-][A-Za-z0-9_]+\s*[=:]\s*)["']?[^"',\s)}\]]+["']?/gi,"$1[REDACTED_AWS_VALUE]"),B=B.replace(/(GOOGLE[_-][A-Za-z0-9_]+\s*[=:]\s*)["']?[^"',\s)}\]]+["']?/gi,"$1[REDACTED_GCP_VALUE]"),B=B.replace(/((API[-_]?KEY|TOKEN|SECRET|PASSWORD)\s*[=:]\s*)["']?[^"',\s)}\]]+["']?/gi,"$1[REDACTED]"),B}function Gi2(){return Jc0().map((A)=>{let B={...A};if(B&&typeof B.error==="string")B.error=Bp(B.error);return B})}var Zi2="https://github.com/anthropics/claude-code/issues";function Yi2({messages:A,onDone:B}){let[Q,I]=MV.useState("userInput"),[D,G]=MV.useState(0),[Z,F]=MV.useState(""),[Y,W]=MV.useState(null),[J,C]=MV.useState(null),[X,V]=MV.useState({isGit:!1,gitState:null}),[K,H]=MV.useState(null),z=g9().columns-4;MV.useEffect(()=>{async function M(){let T=await lz(),R=null;if(T)R=await rrA();V({isGit:T,gitState:R})}M()},[]);let q=z2(),L=MV.useCallback(async()=>{I("submitting"),C(null),W(null);let M=Gi2(),T={message_count:A.length,datetime:new Date().toISOString(),description:Z,platform:iA.platform,gitRepo:X.isGit,terminal:iA.terminal,version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION,transcript:LW(A),errors:M},[R,O]=await Promise.all([H04(T),E04(Z)]);if(H(O),R.success){if(R.feedbackId)W(R.feedbackId),E1("tengu_bug_report_submitted",{feedback_id:R.feedbackId});I("done")}else{if(R.isZdrOrg)C("Feedback collection is not available for organizations with custom data retention policies.");else C("Could not submit feedback. Please try again later.");I("done")}},[Z,X.isGit,A]);return C0((M,T)=>{if(Q==="done"){if(T.return&&K){let R=K04(Y??"",K,Z,Gi2());Ap(R)}if(J)B("Error submitting bug report");else B("Bug report submitted");return}if(J){B("Error submitting bug report");return}if(T.escape){B("Bug report cancelled");return}if(Q==="consent"&&(T.return||M===" "))L()}),l0.createElement(l0.Fragment,null,l0.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"permission",paddingX:1,paddingBottom:1,gap:1},l0.createElement(S,{bold:!0,color:"permission"},"Submit Bug Report"),Q==="userInput"&&l0.createElement(b,{flexDirection:"column",gap:1},l0.createElement(S,null,"Describe the issue below:"),l0.createElement(N3,{value:Z,onChange:F,columns:z,onSubmit:()=>I("consent"),onExitMessage:()=>B("Bug report cancelled"),cursorOffset:D,onChangeCursorOffset:G}),J&&l0.createElement(b,{flexDirection:"column",gap:1},l0.createElement(S,{color:"error"},J),l0.createElement(S,{dimColor:!0},"Press any key to close"))),Q==="consent"&&l0.createElement(b,{flexDirection:"column"},l0.createElement(S,null,"This report will include:"),l0.createElement(b,{marginLeft:2,flexDirection:"column"},l0.createElement(S,null,"- Your bug description: ",l0.createElement(S,{dimColor:!0},Z)),l0.createElement(S,null,"- Environment info:"," ",l0.createElement(S,{dimColor:!0},iA.platform,", ",iA.terminal,", v",{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION)),X.gitState&&l0.createElement(S,null,"- Git repo metadata:"," ",l0.createElement(S,{dimColor:!0},X.gitState.branchName,X.gitState.commitHash?`, ${X.gitState.commitHash.slice(0,7)}`:"",X.gitState.remoteUrl?` @ ${X.gitState.remoteUrl}`:"",!X.gitState.isHeadOnRemote&&", not synced",!X.gitState.isClean&&", has local changes")),l0.createElement(S,null,"- Current session transcript")),l0.createElement(b,{marginTop:1},l0.createElement(S,{wrap:"wrap",dimColor:!0},"We will use your feedback to debug related issues or to improve"," ",I2,"'s functionality (eg. to reduce the risk of bugs occurring in the future). Anthropic will not train generative models using feedback from ",I2,".")),l0.createElement(b,{marginTop:1},l0.createElement(S,null,"Press ",l0.createElement(S,{bold:!0},"Enter")," to confirm and submit."))),Q==="submitting"&&l0.createElement(b,{flexDirection:"row",gap:1},l0.createElement(S,null,"Submitting report")),Q==="done"&&l0.createElement(b,{flexDirection:"column"},J?l0.createElement(S,{color:"error"},J):l0.createElement(S,{color:"success"},"Thank you for your report!"),Y&&l0.createElement(S,{dimColor:!0},"Feedback ID: ",Y),l0.createElement(b,{marginTop:1},l0.createElement(S,null,"Press "),l0.createElement(S,{bold:!0},"Enter "),l0.createElement(S,null,"to also create a GitHub issue, or any other key to close.")))),l0.createElement(b,{marginLeft:1},l0.createElement(S,{dimColor:!0},q.pending?l0.createElement(l0.Fragment,null,"Press ",q.keyName," again to exit"):Q==="userInput"?l0.createElement(l0.Fragment,null,"Enter to continue  Esc to cancel"):Q==="consent"?l0.createElement(l0.Fragment,null,"Enter to submit  Esc to cancel"):null)))}function K04(A,B,Q,I){let D=Bp(B),G=Bp(Q),Z=encodeURIComponent(`**Bug Description**
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`).map((R,O)=>{let y=`${K}-${z}-${O}`;if(q&&L&&O===0){let u=c24(V,O,C,I,G,Z);if(u)return u;return WB.createElement(S,{key:y},WB.createElement(Wp,{i:O===0?z:void 0,width:C,hidden:G}),X(R,void 0))}switch(K){case"add":return WB.createElement(S,{key:y},WB.createElement(Wp,{i:O===0?z:void 0,width:C,hidden:G}),WB.createElement(S,{color:Z?"text":void 0,backgroundColor:I?"diffAddedDimmed":"diffAdded",dimColor:I},WB.createElement(S,{dimColor:I},"+ "),R));case"remove":return WB.createElement(S,{key:y},WB.createElement(Wp,{i:O===0?z:void 0,width:C,hidden:G}),WB.createElement(S,{color:Z?"text":void 0,backgroundColor:I?"diffRemovedDimmed":"diffRemoved",dimColor:I},WB.createElement(S,{dimColor:I},"- "),R));case"nochange":return WB.createElement(S,{key:y},WB.createElement(Wp,{i:O===0?z:void 0,width:C,hidden:G}),WB.createElement(S,{color:Z?"text":void 0,dimColor:I},"  ",R))}})})}function Wp({i:A,width:B,hidden:Q}){if(Q)return null;return WB.createElement(S,{color:"secondaryText"},A!==void 0?A.toString().padStart(B):" ".repeat(B)," ")}function p24(A,B){let Q=B,I=[],D=[...A];while(D.length>0){let G=D.shift(),{code:Z,type:F,originalCode:Y,wordDiff:W,matchedLine:J}=G,C={code:Z,type:F,i:Q,originalCode:Y,wordDiff:W,matchedLine:J};switch(F){case"nochange":Q++,I.push(C);break;case"add":Q++,I.push(C);break;case"remove":{I.push(C);let X=0;while(D[0]?.type==="remove"){Q++;let V=D.shift(),{code:K,type:H,originalCode:z,wordDiff:q,matchedLine:L}=V,M={code:K,type:H,i:Q,originalCode:z,wordDiff:q,matchedLine:L};I.push(M),X++}Q-=X;break}}}return I}function gq1({onThemeSelect:A,showIntroText:B=!1,helpText:Q="",showHelpTextBelow:I=!1,hideEscToCancel:D=!1,skipExitHandling:G=!1}){let[Z]=xB(),{setPreviewTheme:F,savePreview:Y}=Iy1(),W=z2(G?()=>{}:void 0),C=o9.createElement(b,{flexDirection:"column",gap:1,paddingLeft:1},B&&o9.createElement(S,null,"Let's get started."),o9.createElement(b,{flexDirection:"column"},o9.createElement(S,{bold:!0},"Choose the text style that looks best with your terminal:"),Q&&!I&&o9.createElement(S,{dimColor:!0},Q)),o9.createElement(c0,{options:[{label:"Dark mode",value:"dark"},{label:"Light mode",value:"light"},{label:"Dark mode (colorblind-friendly)",value:"dark-daltonized"},{label:"Light mode (colorblind-friendly)",value:"light-daltonized"},{label:"Dark mode (ANSI colors only)",value:"dark-ansi"},{label:"Light mode (ANSI colors only)",value:"light-ansi"}],onFocus:(X)=>{F(X)},onChange:(X)=>{Y(),A(X)},onCancel:G?()=>{Y()}:async()=>{Y(),await y4(0)},visibleOptionCount:6,defaultValue:Z}),o9.createElement(b,{flexDirection:"column",paddingTop:1},o9.createElement(S,{bold:!0},"Preview"),o9.createElement(b,{paddingLeft:1,marginRight:1,borderStyle:"round",flexDirection:"column"},o9.createElement(OW,{patch:{oldStart:1,newStart:1,oldLines:3,newLines:3,lines:["function greet() {",'-  console.log("Hello, World!");','+  console.log("Hello, Claude!");',"}"]},dim:!1}))));if(!B)return o9.createElement(o9.Fragment,null,o9.createElement(b,{flexDirection:"column",borderStyle:"round",paddingX:1,marginTop:1},C),I&&Q&&o9.createElement(b,{marginLeft:3,marginTop:1},o9.createElement(S,{dimColor:!0},Q)),!D&&o9.createElement(b,{marginLeft:3},o9.createElement(S,{dimColor:!0},W.pending?o9.createElement(o9.Fragment,null,"Press ",W.keyName," again to exit"):o9.createElement(o9.Fragment,null,"Esc to cancel"))));return C}var H8=Y1(R1(),1),Nn2=Y1(R1(),1);var S8A="__NO_PREFERENCE__";function hq1({initial:A,onSelect:B}){let Q=A===null?S8A:A,[I,D]=Nn2.useState(Q),G=pd0(),Z=z2();return H8.createElement(b,{flexDirection:"column"},H8.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"remember",paddingX:2,paddingY:1,width:"100%"},H8.createElement(b,{marginBottom:1,flexDirection:"column"},H8.createElement(S,{color:"remember",bold:!0},"Select Model"),H8.createElement(S,{dimColor:!0},"Switch between Claude models. Applies to this session and future Claude Code sessions. For custom model names, specify with --model.")),H8.createElement(b,{flexDirection:"column",paddingX:1},H8.createElement(c0,{defaultValue:I,focusValue:G.some((F)=>F.value===I)?I:G[0]?.value??void 0,options:G.map((F)=>({...F,value:F.value===null?S8A:F.value})),onFocus:(F)=>D(F),onChange:(F)=>B(F===S8A?null:F),onCancel:()=>{}}))),H8.createElement(b,{paddingX:1},H8.createElement(S,{dimColor:!0},Z.pending?H8.createElement(H8.Fragment,null,"Press ",Z.keyName," again to exit"):H8.createElement(H8.Fragment,null,"Enter to confirm  Esc to exit"))))}var iZ=Y1(R1(),1);function uq1({onDone:A}){iZ.default.useEffect(()=>{E1("claude_md_includes_dialog_shown",{})},[]);function B(I){let D=D9();if(I==="no")E1("claude_md_external_includes_dialog_declined",{}),S6({...D,hasClaudeMdExternalIncludesApproved:!1,hasClaudeMdExternalIncludesWarningShown:!0});else E1("claude_md_external_includes_dialog_accepted",{}),S6({...D,hasClaudeMdExternalIncludesApproved:!0,hasClaudeMdExternalIncludesWarningShown:!0});A()}let Q=z2();return C0((I,D)=>{if(D.escape){B("no");return}}),iZ.default.createElement(iZ.default.Fragment,null,iZ.default.createElement(b,{flexDirection:"column",gap:1,padding:1,borderStyle:"round",borderColor:"warning"},iZ.default.createElement(S,{bold:!0,color:"warning"},"Allow external CLAUDE.md file imports?"),iZ.default.createElement(S,null,"This project's CLAUDE.md imports files outside the current working directory. Never allow this for third-party repositories."),iZ.default.createElement(S,{dimColor:!0},"Important: Only use ",I2," with files you trust. Accessing untrusted files may pose security risks"," ",iZ.default.createElement(Q3,{url:"https://docs.anthropic.com/s/claude-code-security"})," "),iZ.default.createElement(c0,{options:[{label:"Yes, allow external imports",value:"yes"},{label:"No, disable external imports",value:"no"}],onChange:(I)=>B(I),onCancel:()=>B("no")})),iZ.default.createElement(b,{marginLeft:3},iZ.default.createElement(S,{dimColor:!0},Q.pending?iZ.default.createElement(iZ.default.Fragment,null,"Press ",Q.keyName," again to exit"):iZ.default.createElement(iZ.default.Fragment,null,"Enter to confirm  Esc to disable external includes"))))}function qn2({onClose:A,isConnectedToIde:B}){let[Q,I]=xB(),[D,G]=EB1.useState(JA()),Z=Y2.useRef(JA()),[F,Y]=EB1.useState(0),W=z2(),[{mainLoopModel:J,todoFeatureEnabled:C,verbose:X},V]=B4(),[K,H]=EB1.useState({}),[z,q]=EB1.useState(null),L=X8A();async function M(y){E1("tengu_config_model_changed",{from_model:J,to_model:y}),V((j)=>({...j,mainLoopModel:y})),H((j)=>{let l=oy(y);if("model"in j){let{model:d,...o}=j;return{...o,model:l}}return{...j,model:l}})}function T(y){V((u)=>({...u,verbose:y})),H((u)=>{if("verbose"in u){let{verbose:j,...l}=u;return l}return{...u,verbose:y}})}function R(y){V((u)=>({...u,todoFeatureEnabled:y})),H((u)=>{if("Todo List Enabled"in u){let{"Todo List Enabled":j,...l}=u;return l}return{...u,"Todo List Enabled":y}})}let O=[{id:"autoCompactEnabled",label:"Auto-compact",value:D.autoCompactEnabled,type:"boolean",onChange(y){let u={...JA(),autoCompactEnabled:y};b0(u),G(u),E1("tengu_auto_compact_setting_changed",{enabled:y})}},{id:"todoFeatureEnabled",label:"Use todo list",value:C,type:"boolean",onChange:R},{id:"verbose",label:"Verbose output",value:X,type:"boolean",onChange:T},{id:"autoUpdates",label:"Auto-updates",value:D.autoUpdates!==!1,type:"boolean",onChange(y){let u={...JA(),autoUpdates:y};b0(u),G(u)}},{id:"theme",label:"Theme",value:Q,type:"managedEnum",onChange:I},{id:"notifChannel",label:"Notifications",value:D.preferredNotifChannel,options:["auto","iterm2","terminal_bell","iterm2_with_bell","kitty","ghostty","notifications_disabled"],type:"enum",onChange(y){let u={...JA(),preferredNotifChannel:y};b0(u),G(u)}},{id:"editorMode",label:"Editor mode",value:D.editorMode==="emacs"?"normal":D.editorMode||"normal",options:["normal","vim"],type:"enum",onChange(y){let u={...JA(),editorMode:y};b0(u),G(u),E1("tengu_editor_mode_changed",{mode:y,source:"config_panel"})}},{id:"model",label:"Model",value:J===null?"Default (recommended)":J,type:"managedEnum",onChange:M},...B?[{id:"diffTool",label:"Diff tool",value:D.diffTool??"auto",options:["terminal","auto"],type:"enum",onChange(y){let u={...JA(),diffTool:y};b0(u),G(u),E1("tengu_diff_tool_changed",{tool:y,source:"config_panel"})}},{id:"autoConnectIde",label:"Auto-connect to IDE",value:D.autoConnectIde??!1,type:"boolean",onChange(y){let u={...JA(),autoConnectIde:y};b0(u),G(u),E1("tengu_auto_connect_ide_changed",{enabled:y,source:"config_panel"})}}]:[],...L?[{id:"showExternalIncludesDialog",label:"External CLAUDE.md includes",value:(()=>{if(D9().hasClaudeMdExternalIncludesApproved)return"true";else return"false"})(),type:"managedEnum",onChange(){}}]:[],...process.env.ANTHROPIC_API_KEY?[{id:"apiKey",label:`Use custom API key: ${YA.bold(RJ(process.env.ANTHROPIC_API_KEY))}`,value:Boolean(process.env.ANTHROPIC_API_KEY&&D.customApiKeyResponses?.approved?.includes(RJ(process.env.ANTHROPIC_API_KEY))),type:"boolean",onChange(y){let u={...JA()};if(!u.customApiKeyResponses)u.customApiKeyResponses={approved:[],rejected:[]};if(!u.customApiKeyResponses.approved)u.customApiKeyResponses.approved=[];if(!u.customApiKeyResponses.rejected)u.customApiKeyResponses.rejected=[];if(process.env.ANTHROPIC_API_KEY){let j=RJ(process.env.ANTHROPIC_API_KEY);if(y)u.customApiKeyResponses.approved=[...u.customApiKeyResponses.approved.filter((l)=>l!==j),j],u.customApiKeyResponses.rejected=u.customApiKeyResponses.rejected.filter((l)=>l!==j);else u.customApiKeyResponses.approved=u.customApiKeyResponses.approved.filter((l)=>l!==j),u.customApiKeyResponses.rejected=[...u.customApiKeyResponses.rejected.filter((l)=>l!==j),j]}b0(u),G(u)}}]:[],...[]];return C0((y,u)=>{if(u.escape){if(z!==null){q(null);return}let l=Object.entries(K).map(([s,x])=>{return E1("tengu_config_changed",{key:s,value:x}),`Set ${s} to ${YA.bold(x)}`}),d=Boolean(process.env.ANTHROPIC_API_KEY&&Z.current.customApiKeyResponses?.approved?.includes(RJ(process.env.ANTHROPIC_API_KEY))),o=Boolean(process.env.ANTHROPIC_API_KEY&&D.customApiKeyResponses?.approved?.includes(RJ(process.env.ANTHROPIC_API_KEY)));if(d!==o)l.push(`${o?"Enabled":"Disabled"} custom API key`),E1("tengu_config_changed",{key:"env.ANTHROPIC_API_KEY",value:o});if(D.theme!==Z.current.theme)l.push(`Set theme to ${YA.bold(D.theme)}`);if(D.preferredNotifChannel!==Z.current.preferredNotifChannel)l.push(`Set notifications to ${YA.bold(D.preferredNotifChannel)}`);if(D.editorMode!==Z.current.editorMode)l.push(`Set editor mode to ${YA.bold(D.editorMode||"emacs")}`);if(D.diffTool!==Z.current.diffTool)l.push(`Set diff tool to ${YA.bold(D.diffTool)}`);if(D.autoConnectIde!==Z.current.autoConnectIde)l.push(`${D.autoConnectIde?"Enabled":"Disabled"} auto-connect to IDE`);if(D.autoCompactEnabled!==Z.current.autoCompactEnabled)l.push(`${D.autoCompactEnabled?"Enabled":"Disabled"} auto-compact`);if(l.length>0)A(l.join(`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:    `))}var jB=Y1(R1(),1),PW=Y1(R1(),1);var BY=Y1(R1(),1),l8A=Y1(Da2(),1);var gB4=typeof window!=="undefined"?BY.useLayoutEffect:BY.useEffect;function RV(A,B){let Q=BY.useRef(A);gB4(()=>{Q.current=A},[A]),BY.useEffect(()=>{if(B===null)return;let I=setInterval(()=>{Q.current()},B);return()=>{clearInterval(I)}},[B])}function hB4(A){let B=BY.useRef(A);B.current=A,BY.useEffect(()=>()=>{B.current()},[])}function Ga2(A,B=500,Q){let I=BY.useRef();hB4(()=>{if(I.current)I.current.cancel()});let D=BY.useMemo(()=>{let G=l8A.default(A,B,Q),Z=(...F)=>{return G(...F)};return Z.cancel=()=>{G.cancel()},Z.isPending=()=>{return!!I.current},Z.flush=()=>{return G.flush()},Z},[A,B,Q]);return BY.useEffect(()=>{I.current=l8A.default(A,B,Q)},[A,B,Q]),D}var sP=Y1(R1(),1);function Za2(A,B,Q){let[I,D]=sP.useState(A),G=sP.useRef(),Z=sP.useRef(A);return sP.useEffect(()=>{Z.current=A},[A]),sP.useEffect(()=>{if(G.current)clearTimeout(G.current);return G.current=setTimeout(()=>{D(Z.current())},Q),()=>{if(G.current)clearTimeout(G.current)}},[...B,Q]),I}function TW(A,B){return A.flatMap((Q,I)=>I?[B(I),Q]:[Q])}var aq1=Y1(R1(),1);async function uB4(){try{if(process.env.CLAUDE_CODE_USE_BEDROCK||process.env.CLAUDE_CODE_USE_VERTEX)return!0;return await Z9.head("https://www.google.com",{timeout:5000,headers:{"Cache-Control":"no-cache"}}),!0}catch{return!1}}function p8A(A){let B=ny()?30000:1000,Q=A??B,[I,D]=aq1.useState(null);return aq1.useEffect(()=>{let G=!0;if(process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return;let Z=async()=>{if(!G)return;let Y=await uB4();if(G)D(Y)};Z();let F=setInterval(Z,Q);return()=>{G=!1,clearInterval(F)}},[Q]),{isConnected:I}}class Ep{activeOperations=new Set;lastUserActivityTime=0;lastCLIRecordedTime=Date.now();isCLIActive=!1;USER_ACTIVITY_TIMEOUT_MS=5000;static instance=null;static getInstance(){if(!Ep.instance)Ep.instance=new Ep;return Ep.instance}recordUserActivity(){if(!this.isCLIActive&&this.lastUserActivityTime!==0){let B=(Date.now()-this.lastUserActivityTime)/1000;if(B>0){let Q=lR1();if(Q){let I=this.USER_ACTIVITY_TIMEOUT_MS/1000;if(B<I)Q.add(B,{type:"user"})}}}this.lastUserActivityTime=Date.now()}startCLIActivity(A){if(this.activeOperations.has(A))this.endCLIActivity(A);let B=this.activeOperations.size===0;if(this.activeOperations.add(A),B)this.isCLIActive=!0,this.lastCLIRecordedTime=Date.now()}endCLIActivity(A){if(this.activeOperations.delete(A),this.activeOperations.size===0){let B=Date.now(),Q=(B-this.lastCLIRecordedTime)/1000;if(Q>0){let I=lR1();if(I)I.add(Q,{type:"cli"})}this.lastCLIRecordedTime=B,this.isCLIActive=!1}}async trackOperation(A,B){this.startCLIActivity(A);try{return await B()}finally{this.endCLIActivity(A)}}getActivityStates(){return{isUserActive:(Date.now()-this.lastUserActivityTime)/1000<this.USER_ACTIVITY_TIMEOUT_MS/1000,isCLIActive:this.isCLIActive,activeOperationCount:this.activeOperations.size}}}var RB1=Ep.getInstance();function mB4(){if(process.env.TERM==="xterm-ghostty")return["","","","","","*"];return process.platform==="darwin"?["","","","","",""]:["","","*","","",""]}var Fa2=mB4(),sq1=[...Fa2,...[...Fa2].reverse()],dB4=["Accomplishing","Actioning","Actualizing","Baking","Booping","Brewing","Calculating","Cerebrating","Channelling","Churning","Clauding","Coalescing","Cogitating","Computing","Combobulating","Concocting","Conjuring","Considering","Contemplating","Cooking","Crafting","Creating","Crunching","Deciphering","Deliberating","Determining","Discombobulating","Divining","Doing","Effecting","Elucidating","Enchanting","Envisioning","Finagling","Flibbertigibbeting","Forging","Forming","Frolicking","Generating","Germinating","Hatching","Herding","Honking","Hustling","Ideating","Imagining","Incubating","Inferring","Jiving","Manifesting","Marinating","Meandering","Moseying","Mulling","Mustering","Musing","Noodling","Percolating","Perusing","Philosophising","Pontificating","Pondering","Processing","Puttering","Puzzling","Reticulating","Ruminating","Scheming","Schlepping","Shimmying","Shucking","Simmering","Smooshing","Spelunking","Spinning","Stewing","Sussing","Synthesizing","Thinking","Tinkering","Transmuting","Unfurling","Unravelling","Vibing","Wandering","Whirring","Wibbling","Wizarding","Working","Wrangling"];function rq1({mode:A,spinnerWords:B=[],currentResponseLength:Q,overrideMessage:I}){let[D,G]=PW.useState(0),[Z,F]=PW.useState(0),[Y,W]=PW.useState(0),{isConnected:J}=p8A(),C=[...dB4,...B],X=Za2(()=>X_(C),[C.length],1000),V=I||X,K=PW.useRef(Date.now()),H=PW.useRef(Q);PW.useEffect(()=>{let L="spinner-"+A;return RB1.startCLIActivity(L),()=>{RB1.endCLIActivity(L)}},[A]),PW.useEffect(()=>{H.current=Q},[Q]),RV(()=>{if(!J){G(4);return}G((L)=>L+1)},120),RV(()=>{W((L)=>{let M=H.current-L;if(M<=0)return L;let T;if(M<70)T=1;else if(M<200)T=Math.max(2,Math.ceil(M*0.08));else T=18;return Math.min(L+T,H.current)})},10),RV(()=>{F(Math.floor((Date.now()-K.current)/1000))},10);let z=[jB.createElement(S,{color:"secondaryText",key:"elapsedTime"},Z,"s"),jB.createElement(b,{flexDirection:"row",key:"tokens"},jB.createElement(cB4,{mode:A,key:"spinnerMode"}),jB.createElement(S,{color:"secondaryText"},CI(Math.round(Y/4))," tokens")),jB.createElement(b,{key:"esc"},jB.createElement(S,{color:"secondaryText",bold:!0},"esc"," "),jB.createElement(S,{color:"secondaryText"},"to interrupt"))];if(J===!1)z.push(jB.createElement(b,{key:"offline"},jB.createElement(S,{color:"error",bold:!0},"offline")));let q=J===!1?"secondaryText":"claude";return jB.createElement(b,{flexDirection:"row",flexWrap:"wrap",marginTop:1,width:"100%"},jB.createElement(b,{flexWrap:"wrap",height:1,width:2,key:"spinner"},jB.createElement(S,{color:q},sq1[D%sq1.length])),jB.createElement(S,{color:q,key:"message"},V,""," "),jB.createElement(S,{color:"secondaryText"},"("),TW(z,(L)=>jB.createElement(S,{color:"secondaryText",key:`separator-${L}`}," ",""," ")),jB.createElement(S,{color:"secondaryText"},")"))}function cB4({mode:A}){switch(A){case"tool-input":return jB.createElement(lB4,null);case"tool-use":return jB.createElement(b,{flexWrap:"wrap",flexGrow:0,height:1,width:2},jB.createElement(S,{color:"secondaryText"},""));case"responding":return jB.createElement(b,{width:2},jB.createElement(S,{color:"secondaryText"},G0.arrowDown));case"thinking":return jB.createElement(b,{width:2},jB.createElement(S,{color:"secondaryText"},G0.arrowDown));case"requesting":return jB.createElement(b,{width:2},jB.createElement(S,{color:"secondaryText"},G0.arrowUp))}}function lB4(){let[A,B]=PW.useState(!0);return RV(()=>{B((Q)=>!Q)},500),jB.createElement(b,{flexWrap:"wrap",flexGrow:0,height:1,width:2},jB.createElement(S,{color:"secondaryText"},A?"":" "))}function oI(){let[A,B]=PW.useState(0),{isConnected:Q}=p8A();return RV(()=>{B((D)=>(D+1)%sq1.length)},120),jB.createElement(b,{flexWrap:"wrap",height:1,width:2},jB.createElement(S,{color:Q===!1?"secondaryText":"text"},sq1[A]))}var pB4={words:[]};function Ya2(){let A=od0("tengu_spinner_words",pB4);return PW.useMemo(()=>{if(A.words.length===0)return;return vR1(A.words,10)},[A.words])}var h9=Y1(R1(),1);var nZ=Y1(R1(),1);function oq1({customApiKeyTruncated:A,onDone:B}){function Q(D){let G=JA();switch(D){case"yes":{b0({...G,customApiKeyResponses:{...G.customApiKeyResponses,approved:[...G.customApiKeyResponses?.approved??[],A]}}),B();break}case"no":{b0({...G,customApiKeyResponses:{...G.customApiKeyResponses,rejected:[...G.customApiKeyResponses?.rejected??[],A]}}),B();break}}}let I=z2();return nZ.default.createElement(nZ.default.Fragment,null,nZ.default.createElement(b,{flexDirection:"column",gap:1,padding:1,borderStyle:"round",borderColor:"warning"},nZ.default.createElement(S,{bold:!0,color:"warning"},"Detected a custom API key in your environment"),nZ.default.createElement(S,null,nZ.default.createElement(S,{bold:!0},"ANTHROPIC_API_KEY"),nZ.default.createElement(S,null,": sk-ant-...",A)),nZ.default.createElement(S,null,"Do you want to use this API key?"),nZ.default.createElement(c0,{defaultValue:"no",focusValue:"no",options:[{label:"Yes",value:"yes"},{label:`No (${YA.bold("recommended")})`,value:"no"}],onChange:(D)=>Q(D),onCancel:()=>Q("no")})),nZ.default.createElement(b,{marginLeft:3},nZ.default.createElement(S,{dimColor:!0},I.pending?nZ.default.createElement(nZ.default.Fragment,null,"Press ",I.keyName," again to exit"):nZ.default.createElement(nZ.default.Fragment,null,"Enter to confirm ",G0.dot," Esc to cancel"))))}var vD=Y1(R1(),1);var tq1=Y1(R1(),1);function Wa2(A){let[B,Q]=tq1.useState(!1);return tq1.useEffect(()=>{let I=setTimeout(()=>{Q(!0)},A);return()=>clearTimeout(I)},[A]),B}async function iB4(){try{let A=["https://api.anthropic.com/api/hello","https://console.anthropic.com/v1/oauth/hello"],B=async(D)=>{try{let G=await Z9.get(D,{headers:{"User-Agent":xT()}});if(G.status!==200)return{success:!1,error:`Failed to connect to ${new URL(D).hostname}: Status ${G.status}`};return{success:!0}}catch(G){return{success:!1,error:`Failed to connect to ${new URL(D).hostname}: ${G instanceof Error?G.code||G.message:String(G)}`}}},I=(await Promise.all(A.map(B))).find((D)=>!D.success);if(I)E1("tengu_preflight_check_failed",{isConnectivityError:!1,hasErrorMessage:!!I.error});return I||{success:!0}}catch(A){return v1(A),E1("tengu_preflight_check_failed",{isConnectivityError:!0}),{success:!1,error:`Connectivity check error: ${A instanceof Error?A.code||A.message:String(A)}`}}}function Ja2({onSuccess:A}){let[B,Q]=vD.useState(null),[I,D]=vD.useState(!0),G=Wa2(1000)&&I;return vD.useEffect(()=>{async function Z(){let F=await iB4();Q(F),D(!1)}Z()},[]),vD.useEffect(()=>{if(B?.success)A();else if(B&&!B.success){let Z=setTimeout(()=>process.exit(1),100);return()=>clearTimeout(Z)}},[B,A]),vD.default.createElement(b,{flexDirection:"column",gap:1,paddingLeft:1},I&&G?vD.default.createElement(b,{paddingLeft:1},vD.default.createElement(oI,null),vD.default.createElement(S,null,"Checking connectivity...")):!B?.success&&!I&&vD.default.createElement(b,{flexDirection:"column",gap:1},vD.default.createElement(S,{color:"error"},"Unable to connect to Anthropic services"),vD.default.createElement(S,{color:"error"},B?.error),vD.default.createElement(b,{flexDirection:"column",gap:1},vD.default.createElement(S,null,"Please check your internet connection and network settings."),vD.default.createElement(S,null,"Note: ",I2," might not be available in your country. Check supported countries at"," ",vD.default.createElement(S,{color:"suggestion"},"https://anthropic.com/supported-countries")))))}function Xa2({onDone:A}){let[B,Q]=h9.useState(0),I=zX(),[D,G]=xB();h9.useEffect(()=>{E1("tengu_began_setup",{oauthEnabled:I})},[I]);function Z(){if(B<V.length-1){let K=B+1;Q(K),E1("tengu_onboarding_step",{oauthEnabled:I,stepId:V[K]?.id})}else A()}function F(K){G(K),Z()}let Y=z2();C0(async(K,H)=>{let z=V[B];if(H.return&&z&&["security"].includes(z.id))if(B===V.length-1){A();return}else{if(z.id==="security")await a5();Z()}else if(H.escape&&z?.id==="terminal-setup")Z()});let W=h9.default.createElement(gq1,{initialTheme:D,onThemeSelect:F,showIntroText:!0,helpText:"To change this later, run /theme",hideEscToCancel:!0,skipExitHandling:!0}),J=h9.default.createElement(b,{flexDirection:"column",gap:1,paddingLeft:1},h9.default.createElement(S,{bold:!0},"Security notes:"),h9.default.createElement(b,{flexDirection:"column",width:70},h9.default.createElement(YT,null,h9.default.createElement(YT.Item,null,h9.default.createElement(S,null,"Claude can make mistakes"),h9.default.createElement(S,{color:"secondaryText",wrap:"wrap"},"You should always review Claude's responses, especially when",h9.default.createElement(d4,null),"running code.",h9.default.createElement(d4,null))),h9.default.createElement(YT.Item,null,h9.default.createElement(S,null,"Due to prompt injection risks, only use it with code you trust"),h9.default.createElement(S,{color:"secondaryText",wrap:"wrap"},"For more details see:",h9.default.createElement(d4,null),h9.default.createElement(Q3,{url:"https://docs.anthropic.com/s/claude-code-security"}))))),h9.default.createElement(Ww,null)),C=h9.default.createElement(Ja2,{onSuccess:Z}),X=h9.useMemo(()=>{if(!process.env.ANTHROPIC_API_KEY)return"";let K=RJ(process.env.ANTHROPIC_API_KEY);if(PX1(K)==="new")return K},[]),V=[];if(I)V.push({id:"preflight",component:C});if(V.push({id:"theme",component:W}),I)V.push({id:"oauth",component:h9.default.createElement(Hp,{onDone:Z})});if(X)V.push({id:"api-key",component:h9.default.createElement(oq1,{customApiKeyTruncated:X,onDone:Z})});if(V.push({id:"security",component:J}),_A1())V.push({id:"terminal-setup",component:h9.default.createElement(b,{flexDirection:"column",gap:1,paddingLeft:1},h9.default.createElement(S,{bold:!0},"Use ",I2,"'s terminal setup?"),h9.default.createElement(b,{flexDirection:"column",width:70,gap:1},h9.default.createElement(S,null,"For the optimal coding experience, enable the recommended settings",h9.default.createElement(d4,null),"for your terminal:"," ",iA.terminal==="Apple_Terminal"?"Option+Enter for newlines and visual bell":"Shift+Enter for newlines"),h9.default.createElement(c0,{options:[{label:"Yes, use recommended settings",value:"install"},{label:"No, maybe later with /terminal-setup",value:"no"}],onChange:(K)=>{if(K==="install")MAA(D).then(()=>{Z()});else Z()},onCancel:()=>Z()}),h9.default.createElement(S,{dimColor:!0},Y.pending?h9.default.createElement(h9.default.Fragment,null,"Press ",Y.keyName," again to exit"):h9.default.createElement(h9.default.Fragment,null,"Enter to confirm  Esc to skip"))))});return h9.default.createElement(b,{flexDirection:"column",gap:1},V[B]?.id!=="oauth"&&h9.default.createElement(i8A,null),h9.default.createElement(b,{flexDirection:"column",padding:0,gap:0},V[B]?.component,Y.pending&&h9.default.createElement(b,{padding:1},h9.default.createElement(S,{dimColor:!0},"Press ",Y.keyName," again to exit"))))}var Ca2=28;function i8A(){let{columns:A}=g9(),B=A<Ca2;return h9.default.createElement(b,{...B?{}:{borderColor:"claude",borderStyle:"round"},paddingX:1,width:Ca2},h9.default.createElement(S,null,h9.default.createElement(S,{color:"claude"},"")," Welcome to"," ",h9.default.createElement(S,{bold:!0},I2)))}var xr2=Y1(kr2(),1);function H3A({message:A,title:B}){let Q=B?`${B}:
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`,value:"console"}],onCancel:()=>{},onChange:(y)=>{if(F({state:"ready_to_start"}),y==="claudeai")E1("tengu_oauth_claudeai_selected",{}),K(!0);else E1("tengu_oauth_console_selected",{}),K(!1)}})));case"waiting_for_login":return g2.default.createElement(b,{flexDirection:"column",gap:1},G&&g2.default.createElement(b,null,g2.default.createElement(S,{dimColor:!0},G)),!H&&g2.default.createElement(b,null,g2.default.createElement(oI,null),g2.default.createElement(S,null,"Opening browser to sign in")),H&&g2.default.createElement(b,null,g2.default.createElement(S,null,hr2),g2.default.createElement(N3,{value:Y,onChange:W,onSubmit:(y)=>M(y,Z.url),cursorOffset:J,onChangeCursorOffset:C,columns:L})));case"creating_api_key":return g2.default.createElement(b,{flexDirection:"column",gap:1},g2.default.createElement(b,null,g2.default.createElement(oI,null),g2.default.createElement(S,null,"Creating API key for Claude Code")));case"about_to_retry":return g2.default.createElement(b,{flexDirection:"column",gap:1},g2.default.createElement(S,{color:"permission"},"Retrying"));case"success":return g2.default.createElement(b,{flexDirection:"column",gap:2},Q==="setup-token"&&Z.token?null:g2.default.createElement(g2.default.Fragment,null,JA().oauthAccount?.emailAddress?g2.default.createElement(S,{dimColor:!0},"Logged in as"," ",g2.default.createElement(S,null,JA().oauthAccount?.emailAddress)):null,g2.default.createElement(S,{color:"success"},"Login successful. Press ",g2.default.createElement(S,{bold:!0},"Enter")," to continue")));case"error":return g2.default.createElement(b,{flexDirection:"column",gap:1},g2.default.createElement(S,{color:"error"},"OAuth error: ",Z.message),Z.toRetry&&g2.default.createElement(b,{marginTop:1},g2.default.createElement(S,{color:"permission"},"Press ",g2.default.createElement(S,{bold:!0},"Enter")," to retry.")));default:return null}}return g2.useEffect(()=>{let y={};if(y.header=g2.default.createElement(b,{key:"header",flexDirection:"column",gap:1},g2.default.createElement(i8A,null),g2.default.createElement(b,{paddingBottom:1,paddingLeft:1},g2.default.createElement(Aa2,null))),Z.state==="waiting_for_login"&&H)y.urlToCopy=g2.default.createElement(b,{flexDirection:"column",key:"urlToCopy",gap:1,paddingBottom:1},g2.default.createElement(b,{paddingX:1},g2.default.createElement(S,{dimColor:!0},"Browser didn't open? Use the url below to sign in:")),g2.default.createElement(b,{width:1000},g2.default.createElement(S,{dimColor:!0},Z.url)));if(Q==="setup-token"&&Z.state==="success"&&Z.token)y.tokenOutput=g2.default.createElement(b,{key:"tokenOutput",flexDirection:"column",gap:1,paddingTop:1},g2.default.createElement(S,{color:"success"}," Long-lived authentication token created successfully!"),g2.default.createElement(b,{flexDirection:"column",gap:1},g2.default.createElement(S,null,"Your OAuth token (valid for 1 year):"),g2.default.createElement(b,{width:1000},g2.default.createElement(S,{color:"warning"},Z.token)),g2.default.createElement(S,{dimColor:!0},"Store this token securely. You won't be able to see it again."),g2.default.createElement(S,{dimColor:!0},"Use this token by setting: export CLAUDE_CODE_OAUTH_TOKEN=<token>")));q.renderStatic(y)},[q,Z,H,Q]),g2.default.createElement(b,{flexDirection:"column",gap:1},g2.default.createElement(b,{paddingLeft:1,flexDirection:"column",gap:1},O()))}var O9=Y1(R1(),1);var KQ4=53;function Tp({model:A}){let B=E6(process.env.IS_DEMO)?29:Math.max(KQ4,cA().length+12),Q=$G(!1),{columns:I}=g9(),D=I<B,G=Boolean(process.env.ANTHROPIC_API_KEY&&VF0(process.env.ANTHROPIC_API_KEY)),Z=E6(process.env.DISABLE_PROMPT_CACHING),F=nd0(A),Y=null,W=Boolean(G||Z||process.env.API_TIMEOUT_MS||process.env.MAX_THINKING_TOKENS||process.env.ANTHROPIC_BASE_URL);return O9.createElement(b,{flexDirection:"column"},O9.createElement(b,{...D?{}:{borderColor:"claude",borderStyle:"round"},flexDirection:"column",gap:1,paddingLeft:1,width:B},O9.createElement(S,null,O9.createElement(S,{color:"claude"},"")," Welcome to"," ",O9.createElement(S,{bold:!0},I2),"!"),process.env.IS_DEMO?null:O9.createElement(O9.Fragment,null,O9.createElement(b,{paddingLeft:2,flexDirection:"column",gap:1},O9.createElement(S,{color:"secondaryText",italic:!0},"/help for help, /status for your current setup"),O9.createElement(S,{color:"secondaryText"},"cwd: ",cA()),!1,!1),W&&O9.createElement(b,{borderColor:"secondaryBorder",borderStyle:"single",borderBottom:!1,borderLeft:!1,borderRight:!1,borderTop:!0,flexDirection:"column",marginLeft:2,marginRight:1,paddingTop:1},O9.createElement(b,{marginBottom:1},O9.createElement(S,{color:"secondaryText"},"Overrides (via env):")),G&&Q?O9.createElement(S,{color:"secondaryText"}," API Key:"," ",O9.createElement(S,{bold:!0},Q.length<25?`${Q.slice(0,3)}`:`sk-ant-${Q.slice(-B+25)}`)):null,Z?O9.createElement(S,{color:"secondaryText"}," Prompt caching:"," ",O9.createElement(S,{color:"error",bold:!0},"off")):null,process.env.API_TIMEOUT_MS?O9.createElement(S,{color:"secondaryText"}," API timeout:"," ",O9.createElement(S,{bold:!0},process.env.API_TIMEOUT_MS,"ms")):null,process.env.MAX_THINKING_TOKENS?O9.createElement(S,{color:"secondaryText"}," Max thinking tokens:"," ",O9.createElement(S,{bold:!0},process.env.MAX_THINKING_TOKENS)):null,process.env.ANTHROPIC_BASE_URL?O9.createElement(S,{color:"secondaryText"}," API Base URL:"," ",O9.createElement(S,{bold:!0},process.env.ANTHROPIC_BASE_URL)):null))))}var ur2=Y1(R1(),1);function Pp(){let[{mainLoopModel:A,maxRateLimitFallbackActive:B}]=B4();return ur2.useMemo(()=>{if(A===null){if(B)return gX();return je()}return am(A)},[A,B])}var mr2=()=>({type:"local-jsx",name:"login",description:$G(!1)?"Switch Anthropic accounts":"Sign in with your Anthropic account",isEnabled:()=>!0,isHidden:!1,async call(A,B){return await a5(),gD.createElement(q3A,{onDone:async(Q,I)=>{hB1(gD.createElement(Tp,{model:I})),B.onChangeAPIKey(),A(Q?"Login successful":"Login interrupted")}})},userFacingName(){return"login"}});function q3A(A){let B=Pp(),Q=z2(()=>A.onDone(!1,B));return gD.createElement(b,{flexDirection:"column"},gD.createElement(Hp,{onDone:()=>A.onDone(!0,B),startingMessage:A.startingMessage}),gD.createElement(b,{marginLeft:3},gD.createElement(S,{dimColor:!0},Q.pending?gD.createElement(gD.Fragment,null,"Press ",Q.keyName," again to exit"):"")))}var $3=Y1(R1(),1);import{execSync as M$1}from"child_process";var dr2=Y1(R1(),1);function cr2(){return dr2.default.createElement(S,null,"Checking GitHub CLI installation")}var mG=Y1(R1(),1);function lr2({currentRepo:A,useCurrentRepo:B,repoUrl:Q,onRepoUrlChange:I,onSubmit:D,onToggleUseCurrentRepo:G}){let[Z,F]=mG.useState(0),W=g9().columns;return C0((J,C)=>{if(C.upArrow)G(!0);else if(C.downArrow)G(!1);else if(C.return)D()}),mG.default.createElement(mG.default.Fragment,null,mG.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},mG.default.createElement(b,{flexDirection:"column",marginBottom:1},mG.default.createElement(S,{bold:!0},"Install GitHub App"),mG.default.createElement(S,{dimColor:!0},"Select GitHub repository")),A&&mG.default.createElement(b,{marginBottom:1},mG.default.createElement(S,{bold:B,color:B?"permission":void 0},B?"> ":"  ","Use current repository: ",A)),mG.default.createElement(b,{marginBottom:1},mG.default.createElement(S,{bold:!B||!A,color:!B||!A?"permission":void 0},!B||!A?"> ":"  ","Enter a different repository")),(!B||!A)&&mG.default.createElement(b,{marginBottom:1},mG.default.createElement(N3,{value:Q,onChange:I,onSubmit:D,focus:!0,placeholder:"owner/repo or https://github.com/owner/repo",columns:W,cursorOffset:Z,onChangeCursorOffset:F,showCursor:!0}))),mG.default.createElement(b,{marginLeft:3},mG.default.createElement(S,{dimColor:!0},A?"/ to select  ":"","Enter to continue")))}var wI=Y1(R1(),1);function pr2({repoUrl:A,onSubmit:B}){return C0((Q,I)=>{if(I.return)B()}),wI.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},wI.default.createElement(b,{flexDirection:"column",marginBottom:1},wI.default.createElement(S,{bold:!0},"Install the Claude GitHub App")),wI.default.createElement(b,{marginBottom:1},wI.default.createElement(S,null,"Opening browser to install the Claude GitHub App")),wI.default.createElement(b,{marginBottom:1},wI.default.createElement(S,null,"If your browser doesn't open automatically, visit:")),wI.default.createElement(b,{marginBottom:1},wI.default.createElement(S,{underline:!0},"https://github.com/apps/claude")),wI.default.createElement(b,{marginBottom:1},wI.default.createElement(S,null,"Please install the app for repository: ",wI.default.createElement(S,{bold:!0},A))),wI.default.createElement(b,{marginBottom:1},wI.default.createElement(S,{dimColor:!0},"Important: Make sure to grant access to this specific repository")),wI.default.createElement(b,null,wI.default.createElement(S,{bold:!0,color:"permission"},"Press Enter once you've installed the app",G0.ellipsis)),wI.default.createElement(b,{marginTop:1},wI.default.createElement(S,{dimColor:!0},"Having trouble? See manual setup instructions at:"," ",wI.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/#manual-setup-direct-api"))))}var D5=Y1(R1(),1);function ir2({useExistingSecret:A,secretName:B,onToggleUseExistingSecret:Q,onSecretNameChange:I,onSubmit:D}){let[G,Z]=D5.useState(0),F=g9(),[Y]=xB();return C0((W,J)=>{if(J.upArrow)Q(!0);else if(J.downArrow)Q(!1);else if(J.return)D()}),D5.default.createElement(D5.default.Fragment,null,D5.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},D5.default.createElement(b,{flexDirection:"column",marginBottom:1},D5.default.createElement(S,{bold:!0},"Install GitHub App"),D5.default.createElement(S,{dimColor:!0},"Setup API key secret")),D5.default.createElement(b,{marginBottom:1},D5.default.createElement(S,{color:"warning"},"ANTHROPIC_API_KEY already exists in repository secrets!")),D5.default.createElement(b,{marginBottom:1},D5.default.createElement(S,null,"Would you like to:")),D5.default.createElement(b,{marginBottom:1},D5.default.createElement(S,null,A?zB("success",Y)("> "):"  ","Use the existing API key")),D5.default.createElement(b,{marginBottom:1},D5.default.createElement(S,null,!A?zB("success",Y)("> "):"  ","Create a new secret with a different name")),!A&&D5.default.createElement(D5.default.Fragment,null,D5.default.createElement(b,{marginBottom:1},D5.default.createElement(S,null,"Enter new secret name (alphanumeric with underscores):")),D5.default.createElement(N3,{value:B,onChange:I,onSubmit:D,focus:!0,placeholder:"e.g., CLAUDE_API_KEY",columns:F.columns,cursorOffset:G,onChangeCursorOffset:Z,showCursor:!0}))),D5.default.createElement(b,{marginLeft:3},D5.default.createElement(S,{dimColor:!0},"/ to select  Enter to continue")))}var hD=Y1(R1(),1);function nr2({existingApiKey:A,apiKeyOrOAuthToken:B,onApiKeyChange:Q,onSubmit:I,onToggleUseExistingKey:D,onCreateOAuthToken:G,selectedOption:Z=A?"existing":G?"oauth":"new",onSelectOption:F}){let[Y,W]=hD.useState(0),J=g9(),[C]=xB();return C0((X,V)=>{if(V.upArrow){if(Z==="new"&&G)F?.("oauth");else if(Z==="oauth"&&A)F?.("existing"),D(!0)}else if(V.downArrow){if(Z==="existing")F?.(G?"oauth":"new"),D(!1);else if(Z==="oauth")F?.("new")}if(V.return)if(Z==="oauth"&&G)G();else I()}),hD.default.createElement(hD.default.Fragment,null,hD.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},hD.default.createElement(b,{flexDirection:"column",marginBottom:1},hD.default.createElement(S,{bold:!0},"Install GitHub App"),hD.default.createElement(S,{dimColor:!0},"Choose API key")),A&&hD.default.createElement(b,{marginBottom:1},hD.default.createElement(S,null,Z==="existing"?zB("success",C)("> "):"  ","Use your existing Claude Code API key")),G&&hD.default.createElement(b,{marginBottom:1},hD.default.createElement(S,null,Z==="oauth"?zB("success",C)("> "):"  ","Create a long-lived token with your Claude subscription")),hD.default.createElement(b,{marginBottom:1},hD.default.createElement(S,null,Z==="new"?zB("success",C)("> "):"  ","Enter a new API key")),Z==="new"&&hD.default.createElement(N3,{value:B,onChange:Q,onSubmit:I,onPaste:Q,focus:!0,placeholder:"sk-ant (Create a new key at https://console.anthropic.com/settings/keys)",mask:"*",columns:J.columns,cursorOffset:Y,onChangeCursorOffset:W,showCursor:!0})),hD.default.createElement(b,{marginLeft:3},hD.default.createElement(S,{dimColor:!0},"/ to select  Enter to continue")))}var ZL=Y1(R1(),1);function ar2({currentWorkflowInstallStep:A,secretExists:B,useExistingSecret:Q,secretName:I,skipWorkflow:D=!1,selectedWorkflows:G}){let Z=D?["Getting repository information",B&&Q?"Using existing API key secret":`Setting up ${I} secret`]:["Getting repository information","Creating branch",G.length>1?"Creating workflow files":"Creating workflow file",B&&Q?"Using existing API key secret":`Setting up ${I} secret`,"Opening pull request page"];return ZL.default.createElement(ZL.default.Fragment,null,ZL.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},ZL.default.createElement(b,{flexDirection:"column",marginBottom:1},ZL.default.createElement(S,{bold:!0},"Install GitHub App"),ZL.default.createElement(S,{dimColor:!0},"Create GitHub Actions workflow")),Z.map((F,Y)=>{let W="pending";if(Y<A)W="completed";else if(Y===A)W="in-progress";return ZL.default.createElement(b,{key:Y},ZL.default.createElement(S,{color:W==="completed"?"success":W==="in-progress"?"warning":void 0},W==="completed"?" ":"",F,W==="in-progress"?"":""))})))}var Y3=Y1(R1(),1);function sr2({secretExists:A,useExistingSecret:B,secretName:Q,skipWorkflow:I=!1}){return Y3.default.createElement(Y3.default.Fragment,null,Y3.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},Y3.default.createElement(b,{flexDirection:"column",marginBottom:1},Y3.default.createElement(S,{bold:!0},"Install GitHub App"),Y3.default.createElement(S,{dimColor:!0},"Success")),!I&&Y3.default.createElement(S,{color:"success"}," GitHub Actions workflow created!"),A&&B&&Y3.default.createElement(b,{marginTop:1},Y3.default.createElement(S,{color:"success"}," Using existing ANTHROPIC_API_KEY secret")),(!A||!B)&&Y3.default.createElement(b,{marginTop:1},Y3.default.createElement(S,{color:"success"}," API key saved as ",Q," secret")),Y3.default.createElement(b,{marginTop:1},Y3.default.createElement(S,null,"Next steps:")),I?Y3.default.createElement(Y3.default.Fragment,null,Y3.default.createElement(S,null,"1. Install the Claude GitHub App if you haven't already"),Y3.default.createElement(S,null,"2. Your workflow file was kept unchanged"),Y3.default.createElement(S,null,"3. API key is configured and ready to use")):Y3.default.createElement(Y3.default.Fragment,null,Y3.default.createElement(S,null,"1. A pre-filled PR page has been created"),Y3.default.createElement(S,null,"2. Install the Claude GitHub App if you haven't already"),Y3.default.createElement(S,null,"3. Merge the PR to enable Claude PR assistance"))),Y3.default.createElement(b,{marginLeft:3},Y3.default.createElement(S,{dimColor:!0},"Press any key to exit")))}var NI=Y1(R1(),1);function rr2({error:A,errorReason:B,errorInstructions:Q}){return NI.default.createElement(NI.default.Fragment,null,NI.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},NI.default.createElement(b,{flexDirection:"column",marginBottom:1},NI.default.createElement(S,{bold:!0},"Install GitHub App"),NI.default.createElement(S,{dimColor:!0},"Error")),NI.default.createElement(S,{color:"error"},"Error: ",A),B&&NI.default.createElement(b,{marginTop:1},NI.default.createElement(S,{dimColor:!0},"Reason: ",B)),Q&&Q.length>0&&NI.default.createElement(b,{flexDirection:"column",marginTop:1},NI.default.createElement(S,{dimColor:!0},"How to fix:"),Q.map((I,D)=>NI.default.createElement(b,{key:D,marginLeft:2},NI.default.createElement(S,{dimColor:!0}," "),NI.default.createElement(S,null,I)))),NI.default.createElement(b,{marginTop:1},NI.default.createElement(S,{dimColor:!0},"For manual setup instructions, see:"," ",NI.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/#manual-setup-direct-api")))),NI.default.createElement(b,{marginLeft:3},NI.default.createElement(S,{dimColor:!0},"Press any key to exit")))}var yW=Y1(R1(),1);function or2({repoName:A,onSelectAction:B}){return yW.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},yW.default.createElement(b,{flexDirection:"column",marginBottom:1},yW.default.createElement(S,{bold:!0},"Existing Workflow Found"),yW.default.createElement(S,{dimColor:!0},"Repository: ",A)),yW.default.createElement(b,{flexDirection:"column",marginBottom:1},yW.default.createElement(S,null,"A Claude workflow file already exists at"," ",yW.default.createElement(S,{color:"claude"},".github/workflows/claude.yml")),yW.default.createElement(S,{dimColor:!0},"What would you like to do?")),yW.default.createElement(b,{flexDirection:"column"},yW.default.createElement(c0,{options:[{label:"Update workflow file with latest version",value:"update"},{label:"Skip workflow update (configure secrets only)",value:"skip"},{label:"Exit without making changes",value:"exit"}],onChange:(G)=>{B(G)},onCancel:()=>{B("exit")}})),yW.default.createElement(b,{marginTop:1},yW.default.createElement(S,{dimColor:!0},"View the latest workflow template at:"," ",yW.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/blob/main/examples/claude.yml"))))}var dG=Y1(R1(),1);function tr2({warnings:A,onContinue:B}){return C0((Q,I)=>{if(I.return)B()}),dG.default.createElement(dG.default.Fragment,null,dG.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},dG.default.createElement(b,{flexDirection:"column",marginBottom:1},dG.default.createElement(S,{bold:!0},G0.warning," Setup Warnings"),dG.default.createElement(S,{dimColor:!0},"We found some potential issues, but you can continue anyway")),A.map((Q,I)=>dG.default.createElement(b,{key:I,flexDirection:"column",marginBottom:1},dG.default.createElement(S,{color:"warning",bold:!0},Q.title),dG.default.createElement(S,null,Q.message),Q.instructions.length>0&&dG.default.createElement(b,{flexDirection:"column",marginLeft:2,marginTop:1},Q.instructions.map((D,G)=>dG.default.createElement(S,{key:G,dimColor:!0}," ",D))))),dG.default.createElement(b,{marginTop:1},dG.default.createElement(S,{bold:!0,color:"permission"},"Press Enter to continue anyway, or Ctrl+C to exit and fix issues")),dG.default.createElement(b,{marginTop:1},dG.default.createElement(S,{dimColor:!0},"You can also try the manual setup steps if needed:"," ",dG.default.createElement(S,{color:"claude"},"https://github.com/anthropics/claude-code-action/#manual-setup-direct-api")))))}var o5=Y1(R1(),1);function er2({onSubmit:A,defaultSelections:B}){let[Q,I]=o5.useState(new Set(B)),[D,G]=o5.useState(0),[Z,F]=o5.useState(!1),Y=[{value:"claude",label:"@Claude Code",description:"Tag @claude in issues and PR comments"},{value:"claude-review",label:"Claude Code Review",description:"Automated code review on new PRs"}];return C0((W,J)=>{if(J.upArrow)G((C)=>C>0?C-1:Y.length-1),F(!1);else if(J.downArrow)G((C)=>C<Y.length-1?C+1:0),F(!1);else if(W===" "){let C=Y[D]?.value;if(C)I((X)=>{let V=new Set(X);if(V.has(C))V.delete(C);else V.add(C);return V})}else if(J.return)if(Q.size===0)F(!0);else A(Array.from(Q))}),o5.default.createElement(o5.default.Fragment,null,o5.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1,width:"100%"},o5.default.createElement(b,{flexDirection:"column",marginBottom:1},o5.default.createElement(S,{bold:!0},"Select GitHub workflows to install"),o5.default.createElement(S,{dimColor:!0},"We'll create a workflow file in your repository for each one you select.")),o5.default.createElement(b,{flexDirection:"column",paddingX:1},Y.map((W,J)=>{let C=Q.has(W.value),X=J===D;return o5.default.createElement(b,{key:W.value,flexDirection:"row",marginBottom:J<Y.length-1?1:0},o5.default.createElement(b,{marginRight:1,minWidth:2},o5.default.createElement(S,{bold:X},C?"":" ")),o5.default.createElement(b,{flexDirection:"column"},o5.default.createElement(S,{bold:X},W.label),o5.default.createElement(S,{dimColor:!0},W.description)))}))),o5.default.createElement(b,{marginLeft:2},o5.default.createElement(S,{dimColor:!0}," Navigate  Space to toggle  Enter to confirm")),Z&&o5.default.createElement(b,{marginLeft:1},o5.default.createElement(S,{color:"error"},"You must select at least one workflow to continue")))}var Ao2="Add Claude Code GitHub Workflow",Bo2=`name: Claude Code
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:          anthropic_api_key: \${{ secrets.ANTHROPIC_API_KEY }}
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:          anthropic_api_key: \${{ secrets.ANTHROPIC_API_KEY }}
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`;async function EQ4(A,B,Q,I,D,G,Z){let F=await G2("gh",["api",`repos/${A}/contents/${Q}`,"--jq",".sha"]),Y=null;if(F.code===0)Y=F.stdout.trim();let W=I;if(D==="CLAUDE_CODE_OAUTH_TOKEN")W=I.replace(/anthropic_api_key: \$\{\{ secrets\.ANTHROPIC_API_KEY \}\}/g,"claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}");else if(D!=="ANTHROPIC_API_KEY")W=I.replace(/anthropic_api_key: \$\{\{ secrets\.ANTHROPIC_API_KEY \}\}/g,`anthropic_api_key: \${{ secrets.${D} }}`);let J=Buffer.from(W).toString("base64"),C=["api","--method","PUT",`repos/${A}/contents/${Q}`,"-f",Y?`message=Update ${G}`:`message=${G}`,"-f",`content=${J}`,"-f",`branch=${B}`];if(Y)C.push("-f",`sha=${Y}`);let X=await G2("gh",C);if(X.code!==0){if(X.stderr.includes("422")&&X.stderr.includes("sha"))throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_workflow_file",exit_code:X.code,...Z}),new Error(`Failed to create workflow file ${Q}: A Claude workflow file already exists in this repository. Please remove it first or update it manually.`);E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_workflow_file",exit_code:X.code,...Z});let V=`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`+" For manual setup  Visit: https://github.com/anthropics/claude-code-action";throw new Error(`Failed to create workflow file ${Q}: ${X.stderr}${V}`)}}async function Do2(A,B,Q,I,D=!1,G,Z,F){try{E1("tengu_setup_github_actions_started",{skip_workflow:D,has_api_key:!!B,using_default_secret_name:Q==="ANTHROPIC_API_KEY",selected_claude_workflow:G.includes("claude"),selected_claude_review_workflow:G.includes("claude-review"),...F});let Y=await G2("gh",["api",`repos/${A}`,"--jq",".id"]);if(Y.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"repo_not_found",exit_code:Y.code,...F}),new Error(`Failed to access repository ${A}`);let W=await G2("gh",["api",`repos/${A}`,"--jq",".default_branch"]);if(W.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_get_default_branch",exit_code:W.code,...F}),new Error(`Failed to get default branch: ${W.stderr}`);let J=W.stdout.trim(),C=await G2("gh",["api",`repos/${A}/git/ref/heads/${J}`,"--jq",".object.sha"]);if(C.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_get_branch_sha",exit_code:C.code,...F}),new Error(`Failed to get branch SHA: ${C.stderr}`);let X=C.stdout.trim(),V=null;if(!D){I(),V=`add-claude-github-actions-${Date.now()}`;let K=await G2("gh",["api","--method","POST",`repos/${A}/git/refs`,"-f",`ref=refs/heads/${V}`,"-f",`sha=${X}`]);if(K.code!==0)throw E1("tengu_setup_github_actions_failed",{reason:"failed_to_create_branch",exit_code:K.code,...F}),new Error(`Failed to create branch: ${K.stderr}`);I();let H=[];if(G.includes("claude"))H.push({path:".github/workflows/claude.yml",content:Bo2,message:"Claude PR Assistant workflow"});if(G.includes("claude-review"))H.push({path:".github/workflows/claude-code-review.yml",content:Io2,message:"Claude Code Review workflow"});for(let z of H)await EQ4(A,V,z.path,z.content,Q,z.message,F)}if(I(),B){let K=await G2("gh",["secret","set",Q,"--body",B,"--repo",A]);if(K.code!==0){E1("tengu_setup_github_actions_failed",{reason:"failed_to_set_api_key_secret",exit_code:K.code,...F});let H=`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`+" For manual setup  Visit: https://github.com/anthropics/claude-code-action";throw new Error(`Failed to set API key secret: ${K.stderr||"Unknown error"}${H}`)}}if(!D&&V){I();let K=`https://github.com/${A}/compare/${J}...${V}?quick_pull=1&title=${encodeURIComponent(Ao2)}&body=${encodeURIComponent(Qo2)}`;if(process.platform==="darwin")await G2("open",[K]);else if(process.platform==="win32")await G2("cmd.exe",["/c","start","",K]);else await G2("xdg-open",[K])}E1("tengu_setup_github_actions_completed",{skip_workflow:D,has_api_key:!!B,auth_type:Z,using_default_secret_name:Q==="ANTHROPIC_API_KEY",selected_claude_workflow:G.includes("claude"),selected_claude_review_workflow:G.includes("claude-review"),...F}),b0({...JA(),githubActionSetupCount:(JA().githubActionSetupCount??0)+1})}catch(Y){if(!Y||!(Y instanceof Error)||!Y.message.includes("Failed to"))E1("tengu_setup_github_actions_failed",{reason:"unexpected_error",...F});if(Y instanceof Error)v1(Y);throw Y}}var U8=Y1(R1(),1);function Go2({onSuccess:A,onCancel:B}){let[Q,I]=U8.useState({state:"starting"}),[D]=U8.useState(()=>new MB1);C0(()=>{if(Q.state==="error")B()});let G=U8.useCallback(async()=>{try{let Z=await D.startOAuthFlow(async(Y)=>{I({state:"waiting_for_login",url:Y})},{loginWithClaudeAi:!0,inferenceOnly:!0,expiresIn:31536000}),F=Oo(Z);if(F.warning)E1("tengu_oauth_storage_warning",{warning:F.warning});I({state:"success",token:Z.accessToken}),setTimeout(()=>{A(Z.accessToken)},1000)}catch(Z){let F=Z.message;I({state:"error",message:F}),v1(Z instanceof Error?Z:new Error(String(Z))),E1("tengu_oauth_error",{error:F})}},[D,A]);return U8.useEffect(()=>{if(Q.state==="starting")G()},[Q.state,G]),U8.default.createElement(b,{flexDirection:"column",borderStyle:"round",borderColor:"secondaryBorder",paddingX:1},U8.default.createElement(b,{flexDirection:"column",marginBottom:1},U8.default.createElement(S,{bold:!0},"Create Authentication Token"),U8.default.createElement(S,{dimColor:!0},"Creating a long-lived token for GitHub Actions")),Q.state==="starting"&&U8.default.createElement(b,null,U8.default.createElement(oI,null),U8.default.createElement(S,null,"Starting authentication")),Q.state==="waiting_for_login"&&U8.default.createElement(b,{flexDirection:"column",gap:1},U8.default.createElement(b,null,U8.default.createElement(oI,null),U8.default.createElement(S,null,"Opening browser to sign in with your Claude account")),Q.url&&U8.default.createElement(b,{flexDirection:"column",gap:1,marginTop:1},U8.default.createElement(S,{dimColor:!0},"Browser didn't open? Use this URL:"),U8.default.createElement(S,{dimColor:!0},Q.url))),Q.state==="success"&&U8.default.createElement(b,{flexDirection:"column",gap:1},U8.default.createElement(S,{color:"success"}," Authentication token created successfully!"),U8.default.createElement(S,{dimColor:!0},"Using token for GitHub Actions setup")),Q.state==="error"&&U8.default.createElement(b,{flexDirection:"column",gap:1},U8.default.createElement(S,{color:"error"},"OAuth error: ",Q.message),U8.default.createElement(S,{dimColor:!0},"Press any key to return to API key selection")))}var HQ4={step:"check-gh",selectedRepoName:"",currentRepo:"",useCurrentRepo:!0,apiKeyOrOAuthToken:"",useExistingKey:!0,currentWorkflowInstallStep:0,warnings:[],secretExists:!1,secretName:"ANTHROPIC_API_KEY",useExistingSecret:!0,workflowExists:!1,selectedWorkflows:["claude","claude-review"],selectedApiKeyOption:"new",authType:"api_key"};function zQ4(A){let[B]=$3.useState(()=>$G(!1)),[Q,I]=$3.useState({...HQ4,useExistingKey:!!B,selectedApiKeyOption:B?"existing":zX()?"oauth":"new"});z2(),$3.default.useEffect(()=>{E1("tengu_install_github_app_started",{})},[]);let D=$3.useCallback(async()=>{let O=[];try{M$1("gh --version",{stdio:"ignore"})}catch{O.push({title:"GitHub CLI not found",message:"GitHub CLI (gh) does not appear to be installed or accessible.",instructions:["Install GitHub CLI from https://cli.github.com/","macOS: brew install gh","Windows: winget install --id GitHub.cli","Linux: See installation instructions at https://github.com/cli/cli#installation"]})}try{M$1("gh auth status",{stdio:"ignore"})}catch{O.push({title:"GitHub CLI not authenticated",message:"GitHub CLI does not appear to be authenticated.",instructions:["Run: gh auth login","Follow the prompts to authenticate with GitHub","Or set up authentication using environment variables or other methods"]})}let y="";try{M$1("git rev-parse --is-inside-work-tree",{stdio:"ignore"});let j=M$1("git remote get-url origin",{encoding:"utf8"}).trim().match(/github\.com[:/]([^/]+\/[^/]+)(\.git)?$/);if(j)y=j[1]?.replace(/\.git$/,"")||""}catch{}I((u)=>({...u,warnings:O,currentRepo:y,selectedRepoName:y,step:O.length>0?"warnings":"choose-repo"}))},[]);$3.default.useEffect(()=>{if(Q.step==="check-gh")D()},[Q.step,D]);let G=$3.useCallback(async(O,y)=>{I((u)=>({...u,step:"creating",currentWorkflowInstallStep:0}));try{await Do2(Q.selectedRepoName,O,y,()=>{I((u)=>({...u,currentWorkflowInstallStep:u.currentWorkflowInstallStep+1}))},Q.workflowAction==="skip",Q.selectedWorkflows,Q.authType,{useCurrentRepo:Q.useCurrentRepo,workflowExists:Q.workflowExists,secretExists:Q.secretExists}),I((u)=>({...u,step:"success"}))}catch(u){let j=u instanceof Error?u.message:"Failed to set up GitHub Actions";if(j.includes("workflow file already exists"))E1("tengu_install_github_app_error",{reason:"workflow_file_exists"}),I((l)=>({...l,step:"error",error:"A Claude workflow file already exists in this repository.",errorReason:"Workflow file conflict",errorInstructions:["The file .github/workflows/claude.yml already exists","You can either:","  1. Delete the existing file and run this command again","  2. Update the existing file manually using the template from:","     https://github.com/anthropics/claude-code-action/#manual-setup-direct-api"]}));else E1("tengu_install_github_app_error",{reason:"setup_github_actions_failed"}),I((l)=>({...l,step:"error",error:j,errorReason:"GitHub Actions setup failed",errorInstructions:[]}))}},[Q.selectedRepoName,Q.workflowAction,Q.selectedWorkflows,Q.useCurrentRepo,Q.workflowExists,Q.secretExists,Q.authType]);async function Z(){if(process.platform==="darwin")await G2("open",["https://github.com/apps/claude"]);else if(process.platform==="win32")await G2("cmd.exe",["/c","start","","https://github.com/apps/claude"]);else await G2("xdg-open",["https://github.com/apps/claude"])}async function F(O){try{let y=await G2("gh",["api",`repos/${O}`,"--jq",".permissions.admin"]);if(y.code===0)return{hasAccess:y.stdout.trim()==="true"};if(y.stderr.includes("404")||y.stderr.includes("Not Found"))return{hasAccess:!1,error:"repository_not_found"};return{hasAccess:!1}}catch{return{hasAccess:!1}}}async function Y(O){return(await G2("gh",["api",`repos/${O}/contents/.github/workflows/claude.yml`,"--jq",".sha"])).code===0}async function W(){let O=await G2("gh",["secret","list","--app","actions","--repo",Q.selectedRepoName]);if(O.code===0)if(O.stdout.split(`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`).some((j)=>{return/^ANTHROPIC_API_KEY\s+/.test(j)}))I((j)=>({...j,secretExists:!0,step:"check-existing-secret"}));else if(B)I((j)=>({...j,apiKeyOrOAuthToken:B,useExistingKey:!0})),await G(B,Q.secretName);else I((j)=>({...j,step:"api-key"}));else if(B)I((y)=>({...y,apiKeyOrOAuthToken:B,useExistingKey:!0})),await G(B,Q.secretName);else I((y)=>({...y,step:"api-key"}))}let J=async()=>{if(Q.step==="warnings")I((O)=>({...O,step:"install-app"})),setTimeout(()=>{Z()},0);else if(Q.step==="choose-repo"){let O=Q.useCurrentRepo?Q.currentRepo:Q.selectedRepoName;if(!O.trim())return;let y=[];if(O.includes("github.com")){let l=O.match(/github\.com[:/]([^/]+\/[^/]+)(\.git)?$/);if(!l)y.push({title:"Invalid GitHub URL format",message:"The repository URL format appears to be invalid.",instructions:["Use format: owner/repo or https://github.com/owner/repo","Example: anthropics/claude-cli"]});else O=l[1]?.replace(/\.git$/,"")||""}if(!O.includes("/"))y.push({title:"Repository format warning",message:'Repository should be in format "owner/repo"',instructions:["Use format: owner/repo","Example: anthropics/claude-cli"]});let u=await F(O);if(u.error==="repository_not_found")y.push({title:"Repository not found",message:`Repository ${O} was not found or you don't have access.`,instructions:[`Check that the repository name is correct: ${O}`,"Ensure you have access to this repository",'For private repositories, make sure your GitHub token has the "repo" scope',"You can add the repo scope with: gh auth refresh -h github.com -s repo,workflow"]});else if(!u.hasAccess)y.push({title:"Admin permissions required",message:`You might need admin permissions on ${O} to set up GitHub Actions.`,instructions:["Repository admins can install GitHub Apps and set secrets","Ask a repository admin to run this command if setup fails","Alternatively, you can use the manual setup instructions"]});let j=await Y(O);if(y.length>0){let l=[...Q.warnings,...y];I((d)=>({...d,selectedRepoName:O,workflowExists:j,warnings:l,step:"warnings"}))}else I((l)=>({...l,selectedRepoName:O,workflowExists:j,step:"install-app"})),setTimeout(()=>{Z()},0)}else if(Q.step==="install-app")if(Q.workflowExists)I((O)=>({...O,step:"check-existing-workflow"}));else I((O)=>({...O,step:"select-workflows"}));else if(Q.step==="check-existing-workflow")return;else if(Q.step==="select-workflows")return;else if(Q.step==="check-existing-secret")if(Q.useExistingSecret)await G(null,Q.secretName);else await G(Q.apiKeyOrOAuthToken,Q.secretName);else if(Q.step==="api-key"){if(Q.selectedApiKeyOption==="oauth")return;let O=Q.selectedApiKeyOption==="existing"?B:Q.apiKeyOrOAuthToken;if(!O){E1("tengu_install_github_app_error",{reason:"api_key_missing"}),I((u)=>({...u,step:"error",error:"API key is required"}));return}I((u)=>({...u,apiKeyOrOAuthToken:O,useExistingKey:Q.selectedApiKeyOption==="existing"}));let y=await G2("gh",["secret","list","--app","actions","--repo",Q.selectedRepoName]);if(y.code===0)if(y.stdout.split(`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`).some((l)=>{return/^ANTHROPIC_API_KEY\s+/.test(l)}))I((l)=>({...l,secretExists:!0,step:"check-existing-secret"}));else await G(O,Q.secretName);else await G(O,Q.secretName)}},C=(O)=>{I((y)=>({...y,selectedRepoName:O}))},X=(O)=>{I((y)=>({...y,apiKeyOrOAuthToken:O}))},V=(O)=>{I((y)=>({...y,selectedApiKeyOption:O}))},K=$3.useCallback(()=>{I((O)=>({...O,step:"oauth-flow"}))},[]),H=$3.useCallback((O)=>{I((y)=>({...y,apiKeyOrOAuthToken:O,useExistingKey:!1,secretName:"CLAUDE_CODE_OAUTH_TOKEN",authType:"oauth_token"})),G(O,"CLAUDE_CODE_OAUTH_TOKEN")},[G]),z=$3.useCallback(()=>{I((O)=>({...O,step:"api-key"}))},[]),q=(O)=>{if(O&&!/^[a-zA-Z0-9_]+$/.test(O))return;I((y)=>({...y,secretName:O}))},L=(O)=>{I((y)=>({...y,useCurrentRepo:O,selectedRepoName:O?y.currentRepo:""}))},M=(O)=>{I((y)=>({...y,useExistingKey:O}))},T=(O)=>{I((y)=>({...y,useExistingSecret:O,secretName:O?"ANTHROPIC_API_KEY":""}))},R=async(O)=>{if(O==="exit"){A.onDone("Installation cancelled by user");return}if(I((y)=>({...y,workflowAction:O})),O==="skip"||O==="update")if(B)await W();else I((y)=>({...y,step:"api-key"}))};switch(C0(()=>{if(Q.step==="success"||Q.step==="error"){if(Q.step==="success")E1("tengu_install_github_app_completed",{});A.onDone(Q.step==="success"?"GitHub Actions setup complete!":Q.error?`Couldn't install GitHub App: ${Q.error}
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:ARGUMENTS: ${z}`;let M=q.getToolPermissionContext();return L=await b2B(L,{...q,getToolPermissionContext(){return{...M,alwaysAllowRules:{...M.alwaysAllowRules,command:F}}}},`/${H}`),[{type:"text",text:L}]}}}catch(Z){return v1(Z instanceof Error?Z:new Error(String(Z))),null}}).filter((I)=>I!==null)}catch(Q){return v1(Q instanceof Error?Q:new Error(String(Q))),[]}}),r7A="user",o7A="project";function fI4(A,B){if(A.startsWith(B))return r7A;return o7A}import{join as YBB}from"path";var e7A=Y1(R1(),1);var mL1=Y1(R1(),1);var t7A=Y1(R1(),1);var t9=Y1(R1(),1),f91=Y1(R1(),1);function u2B({onDone:A}){let[B,Q]=f91.useState("initial"),[I,D]=f91.useState("neutral"),[G,Z]=f91.useState(""),[F,Y]=f91.useState(0),W=z2(),[{mainLoopModel:J}]=B4();return}function m2B({showFeedback:A,showWorktree:B,onDone:Q}){let[I,D]=mL1.useState(()=>B?"worktree":A?"feedback":"done");async function G(){if(A)D("feedback");else Z()}async function Z(){Q(),await y4(0)}switch(I){case"worktree":return null;case"feedback":return mL1.default.createElement(u2B,{onDone:Z});case"done":return null}}var xI4={type:"local-jsx",name:"exit",aliases:["quit"],description:"Exit the REPL",isEnabled:()=>!0,isHidden:!1,async call(A,{messages:B}){let I=await vI4(B);if(!I)return A(),await y4(0),null;return e7A.createElement(m2B,{showFeedback:I,showWorktree:!1,onDone:A})},userFacingName(){return"exit"}},dL1=xI4;async function vI4(A){if(A.length<10)return!1;return await AIA()}async function AIA(){let{show:A}=await ed0("tengu-exit-feedback",{show:!1});return A}var VB=Y1(R1(),1),zL=Y1(R1(),1);var BD=Y1(R1(),1);function d2B({message:A,screen:B}){let Q=B==="transcript",I=Ii2(A)||"";return BD.createElement(b,{flexDirection:"column"},BD.createElement(b,{flexDirection:"row"},BD.createElement(b,{minWidth:2},BD.createElement(S,{color:"text"},yw)),BD.createElement(b,{flexDirection:"column"},BD.createElement(S,{bold:!0},"Compact summary",!Q&&BD.createElement(S,{dimColor:!0}," (ctrl+r to expand)")))),Q&&BD.createElement(U0,null,BD.createElement(S,null,I)))}var HL=Y1(R1(),1);var ZB=Y1(R1(),1);import{relative as bI4}from"path";var gI4={id:"large-memory-files",type:"warning",isActive:()=>{return GB1().length>0},render:()=>{let A=GB1();return ZB.createElement(ZB.Fragment,null,A.map((B)=>{let Q=B.path.startsWith(cA())?bI4(cA(),B.path):B.path;return ZB.createElement(b,{key:B.path,flexDirection:"row"},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"Large ",ZB.createElement(S,{bold:!0},Q)," will impact performance (",CI(B.content.length)," chars >"," ",CI(DB1),")",ZB.createElement(S,{color:"secondaryText",dimColor:!0}," "," /memory to edit")))}))}},hI4={id:"ultra-claude-md",type:"warning",isActive:()=>{let A=e$();return A!==null&&A.content.length>Ip},render:()=>{let A=e$();if(!A)return null;let B=A.content.length;return ZB.createElement(b,{flexDirection:"row",gap:1},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"ULTRACLAUDE.md exceeds ",Ip," chars (",B," chars)",ZB.createElement(S,{color:"secondaryText",dimColor:!0}," "," /memory to edit")))}},uI4={id:"settings-validation",type:"warning",isActive:()=>{let{errors:A}=Lq();return A.length>0},render:()=>ZB.createElement(b,{flexDirection:"row",marginTop:1},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"Found invalid settings files. They will be ignored. Run /doctor for details."))},mI4={id:"claude-ai-external-token",type:"warning",isActive:()=>{let A=tj();return MB()&&(A.source==="ANTHROPIC_AUTH_TOKEN"||A.source==="apiKeyHelper")},render:()=>{let A=tj();return ZB.createElement(b,{flexDirection:"row",marginTop:1},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"Auth conflict: Using ",A.source," instead of Claude account subscription token. Either unset ",A.source,", or run `claude /logout`."))}},dI4={id:"api-key-conflict",type:"warning",isActive:()=>{let{source:A}=MF(!1);return!!Ro()&&(A==="ANTHROPIC_API_KEY"||A==="apiKeyHelper")},render:()=>{let{source:A}=MF(!1);return ZB.createElement(b,{flexDirection:"row",marginTop:1},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"Auth conflict: Using ",A," instead of Anthropic Console key. Either unset ",A,", or run `claude /logout`."))}},cI4={id:"both-auth-methods",type:"warning",isActive:()=>{let{source:A}=MF(!1),B=tj();return A!=="none"&&B.source!=="none"&&!(A==="apiKeyHelper"&&B.source==="apiKeyHelper")},render:()=>{let{source:A}=MF(!1),B=tj();return ZB.createElement(b,{flexDirection:"column",marginTop:1},ZB.createElement(b,{flexDirection:"row"},ZB.createElement(S,{color:"warning"},G0.warning),ZB.createElement(S,{color:"warning"},"Auth conflict: Both a token (",B.source,") and an API key (",A,") are set. This may lead to unexpected behavior.")),ZB.createElement(b,{flexDirection:"column",marginLeft:3},ZB.createElement(S,{color:"warning"}," Trying to use"," ",B.source==="claude.ai"?"claude.ai":B.source,"?"," ",A==="ANTHROPIC_API_KEY"?'Unset the ANTHROPIC_API_KEY environment variable, or claude /logout then say "No" to the API key approval before login.':A==="apiKeyHelper"?"Unset the apiKeyHelper setting.":"claude /logout"),ZB.createElement(S,{color:"warning"}," Trying to use ",A,"?"," ",B.source==="claude.ai"?"claude /logout to sign out of claude.ai.":`Unset the ${B.source} environment variable.`)))}},lI4={id:"release-notes",type:"info",isActive:(A)=>{let{hasReleaseNotes:B}=dB1(A.config.lastReleaseNotesSeen);return B},render:(A)=>{let{releaseNotes:B}=dB1(A.config.lastReleaseNotesSeen);return ZB.createElement(b,{flexDirection:"column",marginTop:1},ZB.createElement(S,{color:"secondaryText"},"What's new:"),ZB.createElement(b,{flexDirection:"column",marginLeft:1},B.map((Q,I)=>ZB.createElement(S,{key:I,color:"secondaryText"}," ",Q))))}},c2B=[gI4,hI4,uI4,mI4,dI4,cI4,lI4];function l2B(A){return c2B.filter((B)=>B.isActive(A))}function p2B(A){return c2B.filter((B)=>B.type==="warning").some((B)=>B.isActive(A))}function i2B(){let A={config:JA()};return p2B(A)}function n2B(){let A=JA(),B={config:A},Q=l2B(B);if(HL.useEffect(()=>{if(Q.some((D)=>D.id==="release-notes"))b0({...A,lastReleaseNotesSeen:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION})},[A,Q]),Q.length===0)return null;return HL.createElement(b,{flexDirection:"column",paddingLeft:1},Q.map((I)=>HL.createElement(HL.Fragment,{key:I.id},I.render(B))))}var of=Y1(R1(),1);function a2B(){return JA().tipsHistory||{}}function pI4(A){let B=JA();b0({...B,tipsHistory:A})}function s2B(A){let B=a2B(),Q=JA().numStartups;B[A]=Q,pI4(B)}function iI4(A){return a2B()[A]||0}function BIA(A){let B=iI4(A);if(B===0)return 1/0;return JA().numStartups-B}async function aI4(A){return(await Promise.all(A.map(async(Q)=>{let I=await Q.isRelevant();return{tip:Q,isRelevant:I}}))).filter((Q)=>Q.isRelevant).map((Q)=>Q.tip)}function sI4(A){return A.filter((B)=>{return BIA(B.id)>=B.cooldownSessions})}function rI4(){let A=JA(),{hasReleaseNotes:B}=dB1(A.lastReleaseNotesSeen);return!B}function oI4(A){if(A.length===0)return;if(A.length===1)return A[0];let B=A.map((Q)=>({tip:Q,sessions:BIA(Q.id)}));return B.sort((Q,I)=>I.sessions-Q.sessions),B[0]?.tip}async function r2B(A,B=!1){if(!rI4()||B)return;let Q=await aI4(A),I=sI4(Q);if(I.length===0)return;return oI4(I)}function o2B(A){s2B(A.id),E1("tengu_tip_shown",{tipIdLength:A.id,cooldownSessions:A.cooldownSessions})}function t2B({tip:A}){of.useEffect(()=>{if(!A)return;o2B(A)},[A]);let B=()=>{if(!A)return null;if(typeof A.content==="function")return A.content();return of.default.createElement(S,{color:"secondaryText"}," Tip: ",A.content)};return of.default.createElement(of.default.Fragment,null,A&&of.default.createElement(b,{key:`tip-${A?.id}`,flexDirection:"row",marginTop:1,alignItems:"center",marginLeft:1},B()))}var tf=Y1(R1(),1);function tI4({width:A="auto",dividerChar:B,dividerColor:Q="secondaryText",boxProps:I}){return tf.default.createElement(b,{width:A,borderStyle:{topLeft:"",top:"",topRight:"",right:"",bottomRight:"",bottom:B||"",bottomLeft:"",left:""},borderColor:Q,flexGrow:1,borderBottom:!0,borderTop:!1,borderLeft:!1,borderRight:!1,...I})}function eI4({title:A,width:B="auto",padding:Q=0,titlePadding:I=1,titleColor:D="text",dividerChar:G="",dividerColor:Z="secondaryText",boxProps:F}){let Y=tf.default.createElement(tI4,{dividerChar:G,dividerColor:Z,boxProps:F});if(!A)return tf.default.createElement(b,{paddingLeft:Q,paddingRight:Q},Y);return tf.default.createElement(b,{width:B,paddingLeft:Q,paddingRight:Q,gap:I},Y,tf.default.createElement(b,null,tf.default.createElement(S,{color:D},A)),Y)}var cL1=eI4;var yV=Y1(R1(),1);async function AD4(){if(MB())return!1;let A=await YoA(!1);if(!A)return!1;return Boolean(A.account.has_claude_max)||Boolean(A.account.has_claude_pro)}function e2B(){let[A]=yV.useState(()=>{let B=JA(),Q=B.subscriptionNoticeCount??0,I=B.hasAvailableSubscription;if(Q>=3)return!1;return I??!1});return yV.useEffect(()=>{AD4().then((B)=>{let Q=JA(),I=Q.subscriptionNoticeCount??0;if(B)I+=1;if(Q.subscriptionNoticeCount!==I||Q.hasAvailableSubscription!==B)b0({...Q,subscriptionNoticeCount:I,hasAvailableSubscription:B})})},[A]),A}function ABB(){return yV.useEffect(()=>{E1("tengu_switch_to_subscription_notice_shown",{})},[]),yV.createElement(b,{paddingLeft:1,marginTop:1,marginBottom:1},yV.createElement(S,{color:"suggestion"},"You can now use your Claude subscription with ",I2,yV.createElement(S,{color:"text",dimColor:!0}," "," /login to activate")))}var QIA=Y1(R1(),1);function BBB({message:A,isTranscriptMode:B}){if(!(B&&A.timestamp&&A.type==="assistant"&&A.message.content.some((D)=>D.type==="text")))return null;let I=new Date(A.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return QIA.default.createElement(b,{marginTop:1},QIA.default.createElement(S,{dimColor:!0},I))}var x91=10;function v91({messages:A,normalizedMessageHistory:B,tools:Q,verbose:I,toolJSX:D,toolUseConfirmQueue:G,inProgressToolUseIDs:Z,isMessageSelectorVisible:F,tipOfTheDay:Y,conversationId:W,screen:J,screenToggleId:C,streamingToolUses:X,showAllInTranscript:V=!1}){let K=Pp(),{columns:H}=g9(),z=e2B(),q=xi2(),[L,M]=VB.useState([]),T=zL.useMemo(()=>{try{return i2B()}catch{return!1}},[]);VB.useEffect(()=>{bp().then((d)=>M(d))},[]);let R=zL.useMemo(()=>Z3(A).filter(Of),[A]),O=zL.useMemo(()=>new Set(Object.keys(tl(R))),[R]),y=zL.useMemo(()=>Uq1(R),[R]),u=zL.useMemo(()=>X.filter((d)=>{if(Z.has(d.contentBlock.id))return!1;if(R.some((o)=>o.type==="assistant"&&o.message.content[0].type==="tool_use"&&o.message.content[0].id===d.contentBlock.id))return!1;return!0}),[X,Z,R]),j=zL.useMemo(()=>u.flatMap((d)=>Z3([$W({content:[d.contentBlock]})])),[u]),l=zL.useCallback((d)=>{let o=J==="transcript",s=o&&!V,x=s?R.slice(-x91):R,A1=s&&R.length>x91;return[{type:"static",jsx:VB.createElement(b,{flexDirection:"column",gap:1,key:`logo-${W}-${C}`},VB.createElement(Tp,{model:K}),sE1()?VB.createElement(qAA,null):VB.createElement(n2B,null))},...!E6(process.env.IS_DEMO)&&Y&&!T?[{type:"static",jsx:VB.createElement(b,{key:`tip-of-the-day-${W}-${C}`},VB.createElement(t2B,{tip:Y}))}]:[],...z?[{type:"static",jsx:VB.createElement(b,{key:`max-subscription-${W}-${C}`},VB.createElement(ABB,null))}]:[],...q&&!z?[{type:"static",jsx:VB.createElement(b,{key:`subscription-upsell-${W}-${C}`},VB.createElement(vi2,null))}]:[],...L.length>0?[{type:"static",jsx:VB.createElement(b,{key:`install-messages-${W}-${C}`,flexDirection:"column",paddingLeft:1},L.map((F1,L1)=>VB.createElement(b,{key:L1,flexDirection:"row",marginTop:1},VB.createElement(S,{color:"warning"},G0.bullet),VB.createElement(S,{color:"warning"}," ",F1))))}]:[],...A1?[{type:"static",jsx:VB.createElement(cL1,{key:`truncation-indicator-${W}-${C}`,dividerChar:"",title:`Ctrl+E to show ${YA.bold(R.length-x91)} previous messages`,titleColor:"secondaryText",dividerColor:"secondaryBorder",width:H})}]:[],...o&&V&&R.length>x91?[{type:"static",jsx:VB.createElement(cL1,{key:`hide-indicator-${W}-${C}`,dividerChar:"",title:`Ctrl+E to hide ${YA.bold(R.length-x91)} previous messages`,titleColor:"secondaryText",dividerColor:"secondaryBorder",width:H})}]:[],...B.length>0?[{type:"static",jsx:VB.createElement(b,{flexDirection:"column",gap:1,key:`history-${W}-${C}`},B8A(B.filter((F1)=>F1.type!=="progress").filter((F1)=>I8A(F1,o)),[]).map((F1)=>VB.createElement(b,{key:`history-${F1.uuid}-${C}`,width:H-5},VB.createElement(DY,{message:F1,messages:B,addMargin:!0,tools:Q,verbose:d,erroredToolUseIDs:new Set,inProgressToolUseIDs:new Set,progressMessagesForMessage:[],shouldAnimate:!1,shouldShowDot:!0,resolvedToolUseIDs:new Set}))),VB.createElement(cL1,{dividerChar:"=",title:"Previous Conversation Compacted"}))}]:[],...B8A(x.filter((F1)=>F1.type!=="progress").filter((F1)=>I8A(F1,o)),j).map((F1)=>{let L1=QB1(F1),k1=Di2(F1,R),e1=F1.type==="user"&&F1.isCompactSummary?VB.createElement(d2B,{message:F1,screen:J}):VB.createElement(DY,{message:F1,messages:R,addMargin:!0,tools:Q,verbose:d,erroredToolUseIDs:y,inProgressToolUseIDs:Z,progressMessagesForMessage:k1,shouldAnimate:(!D||!!D.shouldContinueAnimation)&&!G.length&&!F&&(!L1||Z.has(L1)),shouldShowDot:!0,resolvedToolUseIDs:O});return{type:BD4(F1,A,new Set(X.map((VA)=>VA.contentBlock.id)),O,J)?"static":"transient",jsx:VB.createElement(b,{key:`${F1.uuid}-${k1.length}-${C}`,width:H-5,flexDirection:"column"},VB.createElement(BBB,{message:F1,isTranscriptMode:o}),e1)}}).filter((F1)=>F1!==void 0),...vr2()?[{type:"static",jsx:VB.createElement(gr2,null)}]:[]]},[J,V,R,W,C,K,Y,z,q,L,H,B,j,Q,y,Z,D,G.length,F,O,A,X,T]);return VB.createElement(VB.Fragment,null,VB.createElement(j71,{key:`static-messages-${W}-${C}`,items:l(I).filter((d)=>d.type==="static")},(d)=>d.jsx),l(I).filter((d)=>d.type==="transient").map((d)=>d.jsx))}function BD4(A,B,Q,I,D){if(D==="transcript")return!0;switch(A.type){case"attachment":return!0;case"system":case"user":case"assistant":{let G=QB1(A);if(!G)return!0;if(Q.has(G))return!1;let Z=Bi2(A,B);return sH2(Z,I)}case"progress":return!1}}var b91=Y1(R1(),1);var m8=Y1(R1(),1);import{join as ID4}from"path";import{execSync as QD4}from"child_process";function QBB(A){let B=zQ(),I={macos:["pbcopy"],linux:["xclip -selection clipboard","wl-copy"],wsl:["clip.exe"],windows:["clip"],unknown:["xclip -selection clipboard","wl-copy"]}[B];for(let D of I)try{return QD4(D,{input:A,encoding:"utf-8"}),!0}catch(G){v1(new Error(`Failed to execute clipboard command "${D}": ${G}`));continue}return v1(new Error(`Failed to copy to clipboard on ${B}`)),!1}function IBB(){let A=zQ();return{macos:"Failed to copy to clipboard. Make sure the `pbcopy` command is available on your system and try again.",windows:"Failed to copy to clipboard. Make sure the `clip` command is available on your system and try again.",wsl:"Failed to copy to clipboard. Make sure the `clip.exe` command is available in your WSL environment and try again.",linux:"Failed to copy to clipboard. Make sure `xclip` or `wl-copy` is installed on your system and try again.",unknown:"Failed to copy to clipboard. Make sure `xclip` or `wl-copy` is installed on your system and try again."}[A]}function DBB({content:A,defaultFilename:B,onDone:Q}){let[,I]=m8.useState(null),[D,G]=m8.useState(B),[Z,F]=m8.useState(B.length),[Y,W]=m8.useState(!1),J=z2();return C0((K,H)=>{if(H.escape)if(Y)W(!1),I(null);else Q({success:!1,message:"Export cancelled"})}),m8.default.createElement(b,{width:"100%",flexDirection:"column"},m8.default.createElement(b,{borderStyle:"round",borderColor:"permission",flexDirection:"column",padding:1,width:"100%"},m8.default.createElement(b,null,m8.default.createElement(S,{color:"permission",bold:!0},"Export Conversation")),!Y?m8.default.createElement(m8.default.Fragment,null,m8.default.createElement(b,{marginTop:1},m8.default.createElement(S,{dimColor:!0},"Select export method:")),m8.default.createElement(b,{flexDirection:"column",marginTop:1},m8.default.createElement(c0,{options:[{label:"Copy to clipboard",value:"clipboard",description:"Copy the conversation to your system clipboard"},{label:"Save to file",value:"file",description:"Save the conversation to a file in the current directory"}],onChange:(K)=>{if(K==="clipboard")if(QBB(A))Q({success:!0,message:"Conversation copied to clipboard"});else Q({success:!1,message:IBB()});else if(K==="file")I("file"),W(!0)},onCancel:()=>Q({success:!1,message:"Export cancelled"})}))):m8.default.createElement(b,{flexDirection:"column",marginTop:1},m8.default.createElement(S,null,"Enter filename:"),m8.default.createElement(b,{flexDirection:"row",gap:1,marginTop:1},m8.default.createElement(S,null,">"),m8.default.createElement(N3,{value:D,onChange:G,onSubmit:()=>{let K=D.endsWith(".txt")?D:D.replace(/\.[^.]+$/,"")+".txt",H=ID4(cA(),K);try{b1().writeFileSync(H,A,{encoding:"utf-8",flush:!0}),Q({success:!0,message:`Conversation exported to: ${K}`})}catch(z){Q({success:!1,message:`Failed to export conversation: ${z instanceof Error?z.message:"Unknown error"}`})}},focus:!0,showCursor:!0,columns:process.stdout.columns||80,cursorOffset:Z,onChangeCursorOffset:F})))),m8.default.createElement(b,{marginLeft:2},Y?m8.default.createElement(S,{dimColor:!0},"Enter to save  Esc to go back"):m8.default.createElement(m8.default.Fragment,null,J.pending?m8.default.createElement(S,{dimColor:!0},"Press ",J.keyName," again to exit"):m8.default.createElement(S,{dimColor:!0},"Esc to cancel"))))}function DD4(A){let B=A.getFullYear(),Q=String(A.getMonth()+1).padStart(2,"0"),I=String(A.getDate()).padStart(2,"0"),D=String(A.getHours()).padStart(2,"0"),G=String(A.getMinutes()).padStart(2,"0"),Z=String(A.getSeconds()).padStart(2,"0");return`${B}-${Q}-${I}-${D}${G}${Z}`}function GD4(A){let B=A.find((D)=>D.type==="user");if(!B||B.type!=="user")return"";let Q=B.message?.content,I="";if(typeof Q==="string")I=Q.trim();else if(Array.isArray(Q)){let D=Q.find((G)=>G.type==="text");if(D&&"text"in D)I=D.text.trim()}if(I=I.split(`
/usr/lib/node_modules/@anthropic-ai/claude-code/cli.js:`).filter(Boolean),Q=b1();for(let I of B)if(I.includes("node_modules")||I.includes("npm"))try{Q.unlinkSync(I),SA(`Removed stale npm claude command at ${I}`)}catch{}}function K6B({messages:A}){if(A.length===0)return null;return KQ.default.createElement(b,{flexDirection:"column",gap:0,marginBottom:1},KQ.default.createElement(b,null,KQ.default.createElement(S,{color:"warning"},G0.warning," Setup notes:")),A.map((B,Q)=>KQ.default.createElement(b,{key:Q,marginLeft:2},KQ.default.createElement(S,{color:"secondaryText"}," ",B))))}function hF4({onDone:A,force:B,target:Q}){let[I,D]=KQ.useState({type:"checking"});return KQ.useEffect(()=>{async function G(){try{SA(`Install: Starting installation process (force=${B}, target=${Q})`),D({type:"cleaning-npm"});let{removed:Z,errors:F}=await bF4();if(Z>0)SA(`Cleaned up ${Z} npm installation(s)`);if(F.length>0)SA(`Cleanup warnings: ${F.join(", ")}`);let Y=po2();if(Y.length>0)SA(`Shell alias cleanup: ${Y.join("; ")}`);D({type:"installing",version:Q||"stable"}),SA(`Install: Calling installLatest(force=true, target=${Q}, forceReinstall=${B})`);let J=await gp(!0,Q,B);if(SA(`Install: installLatest returned version=${J.latestVersion}, wasUpdated=${J.wasUpdated}`),!J.latestVersion)I9("Install: Failed to retrieve version information during install");if(!J.wasUpdated)SA("Install: Already up to date");D({type:"setting-up"});let C=await bp(!0);if(SA(`Install: Setup launcher completed with ${C.length} messages`),C.length>0)C.forEach((X)=>SA(`Install: Setup message: ${X}`));if(E1("claude_install_command",{has_version:J.latestVersion?1:0,forced:B?1:0}),C.length>0)D({type:"set-up",messages:C}),setTimeout(()=>{D({type:"success",version:J.latestVersion||"current",setupMessages:C})},2000);else SA("Install: Shell PATH already configured"),D({type:"success",version:J.latestVersion||"current"})}catch(Z){I9(`Install command failed: ${Z}`),D({type:"error",message:Z instanceof Error?Z.message:String(Z)})}}G()},[B,Q]),KQ.useEffect(()=>{if(I.type==="success")setTimeout(()=>{A()},2000);else if(I.type==="error")setTimeout(()=>{A()},3000)},[I,A]),KQ.default.createElement(b,{flexDirection:"column",marginTop:1},I.type==="checking"&&KQ.default.createElement(S,{color:"claude"},"Checking installation status..."),I.type==="cleaning-npm"&&KQ.default.createElement(S,{color:"warning"},"Cleaning up old npm installations..."),I.type==="installing"&&KQ.default.createElement(S,{color:"claude"},"Installing Claude Code native build ",I.version,"..."),I.type==="setting-up"&&KQ.default.createElement(S,{color:"claude"},"Setting up launcher and shell integration..."),I.type==="set-up"&&KQ.default.createElement(K6B,{messages:I.messages}),I.type==="success"&&KQ.default.createElement(b,{flexDirection:"column",gap:1},I.setupMessages&&KQ.default.createElement(K6B,{messages:I.setupMessages}),KQ.default.createElement(b,null,KQ.default.createElement(S,{color:"success"},G0.tick," "),KQ.default.createElement(S,{color:"success",bold:!0},"Claude Code successfully installed!")),KQ.default.createElement(b,{marginLeft:2,flexDirection:"column",gap:1},I.version!=="current"&&KQ.default.createElement(b,null,KQ.default.createElement(S,{color:"secondaryText"},"Version: "),KQ.default.createElement(S,{color:"claude"},I.version)),KQ.default.createElement(b,null,KQ.default.createElement(S,{color:"secondaryText"},"Location: "),KQ.default.createElement(S,{color:"text"},vF4()))),KQ.default.createElement(b,{marginLeft:2,flexDirection:"column",gap:1},KQ.default.createElement(b,{marginTop:1},KQ.default.createElement(S,{color:"secondaryText"},"Next: Run "),KQ.default.createElement(S,{color:"claude",bold:!0},"claude --help"),KQ.default.createElement(S,{color:"secondaryText"}," to get started")))),I.type==="error"&&KQ.default.createElement(b,{flexDirection:"column",gap:1},KQ.default.createElement(b,null,KQ.default.createElement(S,{color:"error"},G0.cross," "),KQ.default.createElement(S,{color:"error"},"Installation failed")),KQ.default.createElement(S,{color:"error"},I.message),KQ.default.createElement(b,{marginTop:1},KQ.default.createElement(S,{color:"secondaryText"},"Try running with --force to override checks"))))}var z6B={type:"local-jsx",name:"install",description:"Install Claude Code native build",argumentHint:"[options]",async call(A,B,Q){let I=Q.includes("--force"),G=Q.filter((F)=>!F.startsWith("--"))[0],{unmount:Z}=z4(KQ.default.createElement(hF4,{onDone:()=>{Z(),A()},force:I,target:G}))}};process.env.COREPACK_ENABLE_AUTO_PIN="0";function uF4(){let A=process.execArgv.some((Q)=>/--inspect(-brk)?|--debug(-brk)?/.test(Q)),B=process.env.NODE_OPTIONS&&/--inspect(-brk)?|--debug(-brk)?/.test(process.env.NODE_OPTIONS);try{return!!global.require("inspector").url()||A||B}catch{return A||B}}if(uF4())process.exit(1);function pF4(){let A=JA();b0({...A,hasCompletedOnboarding:!0,lastOnboardingVersion:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://docs.anthropic.com/s/claude-code",VERSION:"1.0.53"}.VERSION})}async function iF4(A){if(E6(!1)||process.env.IS_DEMO)return!1;let B=JA(),Q=!1;if(!B.theme||!B.hasCompletedOnboarding)Q=!0,await a5(),await new Promise((I)=>{let{unmount:D}=z4(O3.default.createElement(w5,{onChangeAppState:Dx},O3.default.createElement(Xa2,{onDone:async()=>{pF4(),await a5(),D(),I()}})),{exitOnCtrlC:!1})});if(process.env.ANTHROPIC_API_KEY){let I=RJ(process.env.ANTHROPIC_API_KEY);if(PX1(I)==="new")await new Promise((G)=>{let{unmount:Z}=z4(O3.default.createElement(w5,{onChangeAppState:Dx},O3.default.createElement(oq1,{customApiKeyTruncated:I,onDone:()=>{Z(),G()}})),{exitOnCtrlC:!1})})}if(A!=="bypassPermissions"&&process.env.CLAUBBIT!=="true"){if(!sc0())await new Promise((D)=>{let{unmount:G}=z4(O3.default.createElement(w5,null,O3.default.createElement(gQB,{onDone:()=>{G(),D()}})),{exitOnCtrlC:!1})});let{errors:I}=Lq();if(I.length===0)await tQB();if(await Ei2())await new Promise((D)=>{let{unmount:G}=z4(O3.default.createElement(w5,null,O3.default.createElement(uq1,{onDone:()=>{G(),D()}})),{exitOnCtrlC:!1})})}if(A==="bypassPermissions"&&!JA().bypassPermissionsModeAccepted)await new Promise((I)=>{let{unmount:D}=z4(O3.default.createElement(w5,null,O3.default.createElement(eQB,{onAccept:()=>{D(),I()}})))});return Q}function nF4(){let A=JA();b0({...A,numStartups:(A.numStartups??0)+1}),aF4(),$FA()?.add(1)}async function aF4(){let[A,B]=await Promise.all([lz(),Mr()]);E1("tengu_startup_telemetry",{is_git:A,worktree_count:B})}function sF4(){Q6B(),I6B(),D6B(),G6B(),ErA()}async function US(A,B,Q,I,D){let G=process.version.match(/^v(\d+)\./)?.[1];if(!G||parseInt(G)<18)console.error(YA.bold.red("Error: Claude Code requires Node.js version 18 or higher.")),process.exit(1);if(D)FFA(D);if(T8A(),E6(!1))console.warn("Running in CI environment - interactive features are limited");let Z=dE2();if(Z.status==="restored")console.log(YA.yellow("Detected an interrupted iTerm2 setup. Your original settings have been restored. You may need to restart iTerm2 for the changes to take effect."));else if(Z.status==="failed")console.error(YA.red(`Failed to restore iTerm2 settings. Please manually restore your original settings with: defaults import com.googlecode.iterm2 ${Z.backupPath}.`));try{let J=await oE1();if(J.status==="restored")console.log(YA.yellow("Detected an interrupted Terminal.app setup. Your original settings have been restored. You may need to restart Terminal.app for the changes to take effect."));else if(J.status==="failed")console.error(YA.red(`Failed to restore Terminal.app settings. Please manually restore your original settings with: defaults import com.apple.Terminal ${J.backupPath}.`))}catch(J){v1(J instanceof Error?J:new Error(String(J)))}let F=Q??!1;uX(A),_F(),nQB(),sQB(),lo2(),Ac0(),lL1(),eL1(F),AY(),iE(),ey(),ej(),Oa1(),HE1([],qB()),fi2(),AIA(),ko2().catch(v1),DH2();let Y=new AbortController;if(setTimeout(()=>Y.abort(),3000),kI1(cA(),Y.signal,[]),B==="bypassPermissions"){if(process.platform!=="win32"&&typeof process.getuid==="function"&&process.getuid()===0&&!process.env.IS_SANDBOX)console.error("--dangerously-skip-permissions cannot be used with root/sudo privileges for security reasons"),process.exit(1)}let W=D9();if(W.lastCost!==void 0&&W.lastDuration!==void 0)E1("tengu_exit",{last_session_cost:W.lastCost,last_session_api_duration:W.lastAPIDuration,last_session_duration:W.lastDuration,last_session_lines_added:W.lastLinesAdded,last_session_lines_removed:W.lastLinesRemoved,last_session_total_input_tokens:W.lastTotalInputTokens,last_session_total_output_tokens:W.lastTotalOutputTokens,last_session_total_cache_creation_input_tokens:W.lastTotalCacheCreationInputTokens,last_session_total_cache_read_input_tokens:W.lastTotalCacheReadInputTokens,last_session_id:W.lastSessionId}),S6({...W,lastCost:void 0,lastAPIDuration:void 0,lastDuration:void 0,lastLinesAdded:void 0,lastLinesRemoved:void 0,lastTotalInputTokens:void 0,lastTotalOutputTokens:void 0,lastTotalCacheCreationInputTokens:void 0,lastTotalCacheReadInputTokens:void 0,lastSessionId:void 0});if(W.pendingExitFeedback){let J=W.pendingExitFeedback;E1("tengu_exit_feedback",{feedback_choice:J.feedbackChoice,feedback_details:J.feedbackDetails,last_session_id:J.sessionId,model:J.model}),S6({...W,pendingExitFeedback:void 0})}if(!1)try{}catch{}}async function rF4(){if(process.argv[2]==="--ripgrep"){let Z=process.argv.slice(3);process.exit(NX2(Z))}if(!process.env.CLAUDE_CODE_ENTRYPOINT)process.env.CLAUDE_CODE_ENTRYPOINT="cli";process.on("exit",()=>{AY4()}),process.on("SIGINT",()=>{process.exit(0)});let A=process.argv.slice(2),Q=A.includes("-p")||A.includes("--print")||!process.stdout.isTTY;_FA(Q),yFA(!Q);let D=(()=>{if(process.env.GITHUB_ACTIONS==="true")return"github-action";if(process.env.CLAUDE_CODE_ENTRYPOINT==="sdk-ts")return"sdk-typescript";if(process.env.CLAUDE_CODE_ENTRYPOINT==="sdk-cli")return"sdk-cli";return"cli"})();fFA(D);let G=wX2();if(G instanceof Promise)await G;vc0().catch((Z)=>{v1(new Error(`Shell snapshot cleanup failed: ${Z}`))}),process.title="claude",await eF4()}function oF4(A){let B={exitOnCtrlC:A,onFlicker(){E1("tengu_flicker",{})}};if(!process.stdin.isTTY&&!E6(!1)&&!process.argv.includes("mcp")){if(process.platform!=="win32")try{let Q=dF4("/dev/tty","r");B={...B,stdin:new mF4(Q)}}catch(Q){v1(Q)}}return B}async function tF4(A,B){if(!process.stdin.isTTY&&!process.argv.includes("mcp")){if(B==="stream-json")return process.stdin;let Q="";for await(let I of process.stdin)Q+=I;return[A,Q].filter(Boolean).join(`
